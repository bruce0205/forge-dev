(this["webpackJsonpbonvies-pos"]=this["webpackJsonpbonvies-pos"]||[]).push([[11],{253:function(t,e,a){"use strict";var n=a(5),r=a(0),o=a(54),i=a(2),c={shop:5,company:10,enterprise:15};e.a=function(t){return function(e){return Object(o.b)((function(t){return{auth:t.auth.authenticated,level:t.auth.level}}))((function(a){var o=a.auth,s=a.level,d=a.history;return Object(r.useEffect)((function(){o?t&&(!s||c[t]>c[s])&&d.push("/"):d.push("/signin")}),[o,s,d]),Object(i.jsx)(e,Object(n.a)({},a))}))}}},268:function(t,e,a){"use strict";var n=a(8),r=a(1),o=a(0),i=a(13),c=a(241),s=a(236),d=a(24),l=a(27),u=a(21),p=a(206),m=a(237);function g(t){return Object(p.a)("MuiTypography",t)}Object(m.a)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var b=a(2),f=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],x=Object(d.a)("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(t,e){var a=t.ownerState;return[e.root,a.variant&&e[a.variant],"inherit"!==a.align&&e["align".concat(Object(u.a)(a.align))],a.noWrap&&e.noWrap,a.gutterBottom&&e.gutterBottom,a.paragraph&&e.paragraph]}})((function(t){var e=t.theme,a=t.ownerState;return Object(r.a)({margin:0},a.variant&&e.typography[a.variant],"inherit"!==a.align&&{textAlign:a.align},a.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},a.gutterBottom&&{marginBottom:"0.35em"},a.paragraph&&{marginBottom:16})})),h={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},j={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},v=o.forwardRef((function(t,e){var a=Object(l.a)({props:t,name:"MuiTypography"}),o=function(t){return j[t]||t}(a.color),d=Object(c.a)(Object(r.a)({},a,{color:o})),p=d.align,m=void 0===p?"inherit":p,v=d.className,O=d.component,y=d.gutterBottom,k=void 0!==y&&y,S=d.noWrap,w=void 0!==S&&S,L=d.paragraph,I=void 0!==L&&L,C=d.variant,N=void 0===C?"body1":C,D=d.variantMapping,W=void 0===D?h:D,P=Object(n.a)(d,f),T=Object(r.a)({},d,{align:m,color:o,className:v,component:O,gutterBottom:k,noWrap:w,paragraph:I,variant:N,variantMapping:W}),R=O||(I?"p":W[N]||h[N])||"span",M=function(t){var e=t.align,a=t.gutterBottom,n=t.noWrap,r=t.paragraph,o=t.variant,i=t.classes,c={root:["root",o,"inherit"!==t.align&&"align".concat(Object(u.a)(e)),a&&"gutterBottom",n&&"noWrap",r&&"paragraph"]};return Object(s.a)(c,g,i)}(T);return Object(b.jsx)(x,Object(r.a)({as:R,ref:e,ownerState:T,className:Object(i.a)(M.root,v)},P))}));e.a=v},277:function(t,e,a){"use strict";var n=a(12),r=a(3),o=a(8),i=a(1),c=a(0),s=a(13),d=a(18),l=a(241),u=a(236),p=a(24),m=a(27);var g=c.createContext(),b=a(206),f=a(237);function x(t){return Object(b.a)("MuiGrid",t)}var h=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],j=Object(f.a)("MuiGrid",["root","container","item","zeroMinWidth"].concat(Object(n.a)([0,1,2,3,4,5,6,7,8,9,10].map((function(t){return"spacing-xs-".concat(t)}))),Object(n.a)(["column-reverse","column","row-reverse","row"].map((function(t){return"direction-xs-".concat(t)}))),Object(n.a)(["nowrap","wrap-reverse","wrap"].map((function(t){return"wrap-xs-".concat(t)}))),Object(n.a)(h.map((function(t){return"grid-xs-".concat(t)}))),Object(n.a)(h.map((function(t){return"grid-sm-".concat(t)}))),Object(n.a)(h.map((function(t){return"grid-md-".concat(t)}))),Object(n.a)(h.map((function(t){return"grid-lg-".concat(t)}))),Object(n.a)(h.map((function(t){return"grid-xl-".concat(t)}))))),v=a(2),O=["className","columns","columnSpacing","component","container","direction","item","lg","md","rowSpacing","sm","spacing","wrap","xl","xs","zeroMinWidth"];function y(t){var e=parseFloat(t);return"".concat(e).concat(String(t).replace(String(e),"")||"px")}function k(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t||t<=0)return[];if("string"===typeof t&&!Number.isNaN(Number(t))||"number"===typeof t)return[a["spacing-xs-".concat(String(t))]||"spacing-xs-".concat(String(t))];var n=t.xs,r=t.sm,o=t.md,i=t.lg,c=t.xl;return[Number(n)>0&&(a["spacing-xs-".concat(String(n))]||"spacing-xs-".concat(String(n))),Number(r)>0&&(a["spacing-sm-".concat(String(r))]||"spacing-sm-".concat(String(r))),Number(o)>0&&(a["spacing-md-".concat(String(o))]||"spacing-md-".concat(String(o))),Number(i)>0&&(a["spacing-lg-".concat(String(i))]||"spacing-lg-".concat(String(i))),Number(c)>0&&(a["spacing-xl-".concat(String(c))]||"spacing-xl-".concat(String(c)))]}var S=Object(p.a)("div",{name:"MuiGrid",slot:"Root",overridesResolver:function(t,e){var a=t.ownerState,r=a.container,o=a.direction,i=a.item,c=a.lg,s=a.md,d=a.sm,l=a.spacing,u=a.wrap,p=a.xl,m=a.xs,g=a.zeroMinWidth;return[e.root,r&&e.container,i&&e.item,g&&e.zeroMinWidth].concat(Object(n.a)(k(l,r,e)),["row"!==o&&e["direction-xs-".concat(String(o))],"wrap"!==u&&e["wrap-xs-".concat(String(u))],!1!==m&&e["grid-xs-".concat(String(m))],!1!==d&&e["grid-sm-".concat(String(d))],!1!==s&&e["grid-md-".concat(String(s))],!1!==c&&e["grid-lg-".concat(String(c))],!1!==p&&e["grid-xl-".concat(String(p))]])}})((function(t){var e=t.ownerState;return Object(i.a)({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},"wrap"!==e.wrap&&{flexWrap:e.wrap})}),(function(t){var e=t.theme,a=t.ownerState,n=Object(d.d)({values:a.direction,breakpoints:e.breakpoints.values});return Object(d.b)({theme:e},n,(function(t){var e={flexDirection:t};return 0===t.indexOf("column")&&(e["& > .".concat(j.item)]={maxWidth:"none"}),e}))}),(function(t){var e=t.theme,a=t.ownerState,n=a.container,o=a.rowSpacing,i={};if(n&&0!==o){var c=Object(d.d)({values:o,breakpoints:e.breakpoints.values});i=Object(d.b)({theme:e},c,(function(t){var a=e.spacing(t);return"0px"!==a?Object(r.a)({marginTop:"-".concat(y(a))},"& > .".concat(j.item),{paddingTop:y(a)}):{}}))}return i}),(function(t){var e=t.theme,a=t.ownerState,n=a.container,o=a.columnSpacing,i={};if(n&&0!==o){var c=Object(d.d)({values:o,breakpoints:e.breakpoints.values});i=Object(d.b)({theme:e},c,(function(t){var a=e.spacing(t);return"0px"!==a?Object(r.a)({width:"calc(100% + ".concat(y(a),")"),marginLeft:"-".concat(y(a))},"& > .".concat(j.item),{paddingLeft:y(a)}):{}}))}return i}),(function(t){var e,a=t.theme,n=t.ownerState;return a.breakpoints.keys.reduce((function(t,r){var o={};if(n[r]&&(e=n[r]),!e)return t;if(!0===e)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===e)o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{var c=Object(d.d)({values:n.columns,breakpoints:a.breakpoints.values}),s="object"===typeof c?c[r]:c;if(void 0===s||null===s)return t;var l="".concat(Math.round(e/s*1e8)/1e6,"%"),u={};if(n.container&&n.item&&0!==n.columnSpacing){var p=a.spacing(n.columnSpacing);if("0px"!==p){var m="calc(".concat(l," + ").concat(y(p),")");u={flexBasis:m,maxWidth:m}}}o=Object(i.a)({flexBasis:l,flexGrow:0,maxWidth:l},u)}return 0===a.breakpoints.values[r]?Object.assign(t,o):t[a.breakpoints.up(r)]=o,t}),{})})),w=c.forwardRef((function(t,e){var a=Object(m.a)({props:t,name:"MuiGrid"}),r=Object(l.a)(a),d=r.className,p=r.columns,b=r.columnSpacing,f=r.component,h=void 0===f?"div":f,j=r.container,y=void 0!==j&&j,w=r.direction,L=void 0===w?"row":w,I=r.item,C=void 0!==I&&I,N=r.lg,D=void 0!==N&&N,W=r.md,P=void 0!==W&&W,T=r.rowSpacing,R=r.sm,M=void 0!==R&&R,B=r.spacing,z=void 0===B?0:B,E=r.wrap,A=void 0===E?"wrap":E,H=r.xl,G=void 0!==H&&H,F=r.xs,J=void 0!==F&&F,Y=r.zeroMinWidth,q=void 0!==Y&&Y,X=Object(o.a)(r,O),K=T||z,Q=b||z,U=c.useContext(g),V=y?p||12:U,Z=Object(i.a)({},r,{columns:V,container:y,direction:L,item:C,lg:D,md:P,sm:M,rowSpacing:K,columnSpacing:Q,wrap:A,xl:G,xs:J,zeroMinWidth:q}),$=function(t){var e=t.classes,a=t.container,r=t.direction,o=t.item,i=t.lg,c=t.md,s=t.sm,d=t.spacing,l=t.wrap,p=t.xl,m=t.xs,g={root:["root",a&&"container",o&&"item",t.zeroMinWidth&&"zeroMinWidth"].concat(Object(n.a)(k(d,a)),["row"!==r&&"direction-xs-".concat(String(r)),"wrap"!==l&&"wrap-xs-".concat(String(l)),!1!==m&&"grid-xs-".concat(String(m)),!1!==s&&"grid-sm-".concat(String(s)),!1!==c&&"grid-md-".concat(String(c)),!1!==i&&"grid-lg-".concat(String(i)),!1!==p&&"grid-xl-".concat(String(p))])};return Object(u.a)(g,x,e)}(Z);return Object(v.jsx)(g.Provider,{value:V,children:Object(v.jsx)(S,Object(i.a)({ownerState:Z,className:Object(s.a)($.root,d),as:h,ref:e},X))})}));e.a=w},352:function(t,e,a){"use strict";a.r(e);var n=a(16),r=a(0),o=a(244),i=a(277),c=a(3),s=a(5),d=a(54),l=a(268),u=a(134),p=a(104),m=a(56),g=a(95),b=a(2),f=Object(d.b)((function(t){return{posLayouts:t.posLayouts.content,posLayoutsStatus:t.posLayouts.loading,posLayoutDrafts:t.posLayoutDrafts,priceMapping:t.priceMapping.content}}),{editPosLayoutDrafts:p.g,editPosLayoutDraftItem:p.f,clearPosLayoutDraftItem:p.b,editPreviousPalette:u.b,updatePriceMapping:g.c,fetchPriceMapping:g.b,fetchPosLayouts:m.b})((function(t){var e=t.isDeleting,a=t.posLayouts,n=t.posLayoutsStatus,d=t.posLayoutDrafts,u=t.priceMapping,p=t.updatePriceMapping,m=t.fetchPosLayouts,g=t.fetchPriceMapping,f=t.currentLayoutIndex,x=t.recordedLayoutIndex,h=t.currentLayoutItemIndex,j=t.setCurrentLayoutIndex,v=t.setRecordedLayoutIndex,O=t.setCurrentLayoutItemIndex,y=t.editPosLayoutDrafts,k=t.editPosLayoutDraftItem,S=t.clearPosLayoutDraftItem,w=t.editPreviousPalette;Object(r.useEffect)((function(){m()}),[m]),Object(r.useEffect)((function(){"idle"===n&&y(a)}),[y,j,a,n]);var L=Object(r.useMemo)((function(){return d[f]||{}}),[f,d]);Object(r.useEffect)((function(){e||L.stockList&&x!==f&&(g(L.stockList),v(f))}),[L,e,x,v,f,g]);var I=function(t){return t.preventDefault(),t.stopPropagation(),!1};return Object(b.jsxs)(o.a,{component:"section",id:"grid-input",sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1,backgroundColor:"#e0e0e0","& .grid-field":{backgroundColor:"#cccccc",width:"83%",height:"90%",padding:0}},children:[Object(b.jsx)("div",{className:"grid-field container-fluid",children:Object(b.jsx)(i.a,{container:!0,sx:{height:"100%",borderBottom:"1px solid #999999",borderRight:"1px solid #999999",margin:0,"& .grid-item":{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",borderTop:"1px solid #999999",borderLeft:"1px solid #999999",paddingTop:"0.5em",height:"20%","&.selected":{boxShadow:"0px 0px 6px -3px #363636",border:"1px solid #33333377",borderTopWidth:"2px",borderLeftWidth:"2px",zIndex:2},"& h4":{fontSize:"1rem",fontWeight:"bold",textAlign:"center",marginBottom:0,color:"#666666",letterSpacing:"0.025em",lineHeight:1.5,textShadow:function(t){return"0px 1px 2px ".concat(t.palette.background.paper)},overflow:"overlay"}},"& .item-clear":{color:"#d6d6d666",position:"absolute",right:"1%",top:"1%",width:"1.5em",lineHeight:"1.5em",fontSize:"0.8em",verticalAlign:"middle",textAlign:"center",cursor:"pointer","&:hover":{color:"#50505066"}},"& .item-color":{position:"absolute",paddingRight:"5%",right:0,bottom:0,fontSize:"0.9rem","& input":{border:"none",borderRadius:"0.3em",padding:0,width:"2.5em",height:"1.3em",userSelect:"all"}}},children:Object.keys(L).length>0&&L.stockList.map((function(t,e){var a=e===h?"selected":"";return Object(b.jsxs)(i.a,{item:!0,xs:4,style:{backgroundColor:t.backgroundColor},className:"grid-item ".concat(a),onDragEnter:I,onDragOver:I,onDrop:function(a){return function(t,e,a,n){I(t);var r=t.dataTransfer.getData("text/id")||n.stockId,o=t.dataTransfer.getData("text/price"),i=Number(o)||("0"===o?0:n.price),d=Object(s.a)(Object(s.a)({},n),{},{stockId:r,price:i,stockName:t.dataTransfer.getData("text/name")||n.stockName,backgroundColor:t.dataTransfer.getData("text/backgroundColor")||n.backgroundColor});r&&p(Object(c.a)({},r,i)),k({id:e,index:a,item:d})}(a,L.id,e,t)},onClick:function(){return function(t){O(t)}(e)},"data-item-index":e,children:[Object(b.jsx)("div",{"data-item-index":e,className:"item-clear",onClick:function(){return function(t,e){S({id:t,index:e})}(L.id,e)},children:"\u2715"}),Object(b.jsx)(l.a,{variant:"h4","data-item-index":e,children:t.stockName}),Object(b.jsx)(l.a,{variant:"subtitle1","data-item-index":e,children:u[t.stockId]||"-"}),Object(b.jsxs)("div",{className:"item-color","data-item-index":e,children:[Object(b.jsx)("label",{"data-item-index":e,children:"\u5e95\u8272:\xa0"}),Object(b.jsx)("input",{type:"color","data-item-index":e,value:t.backgroundColor,onChange:function(a){return function(t,e,a,n){var r=Object(s.a)(Object(s.a)({},n),{},{backgroundColor:t.target.value});k({id:e,index:a,item:r})}(a,L.id,e,t)},onBlur:function(t){return function(t){w(t.target.value)}(t)}})]})]},e)}))})}),Object(b.jsx)("div",{className:"toggle-field"})]})})),x=a(7),h=a(10),j=a(45),v=a(101),O=a(125),y=a(11),k=Object(d.b)((function(t){return{auth:t.auth,comms:t.comms,commClasses:t.commClasses,posLayouts:t.posLayouts.content,posLayoutDrafts:t.posLayoutDrafts,palette:t.palette}}),{postPosLayouts:m.c,fetchComms:v.b,fetchCommClasses:O.b,editPosLayoutDrafts:p.g,editPosLayoutDraft:p.e,editPosLayoutDraftItem:p.f,updatePriceMapping:g.c})((function(t){var e=t.auth,a=t.comms,i=t.commClasses,d=t.posLayouts,u=t.currentLayoutIndex,p=t.setCurrentLayoutIndex,m=t.currentLayoutItemIndex,g=t.posLayoutDrafts,f=t.palette,v=t.postPosLayouts,O=t.editPosLayoutDrafts,k=t.editPosLayoutDraft,S=t.editPosLayoutDraftItem,w=t.updatePriceMapping,L=t.fetchComms,I=t.fetchCommClasses,C=Object(r.useState)(""),N=Object(n.a)(C,2),D=N[0],W=N[1],P=Object(r.useState)(""),T=Object(n.a)(P,2),R=T[0],M=T[1],B=Object(r.useState)(""),z=Object(n.a)(B,2),E=z[0],A=z[1],H=Object(r.useState)(""),G=Object(n.a)(H,2),F=G[0],J=G[1],Y=Object(r.useState)([]),q=Object(n.a)(Y,2),X=q[0],K=q[1],Q=Object(r.useState)([]),U=Object(n.a)(Q,2),V=U[0],Z=U[1],$=Object(r.useState)(""),_=Object(n.a)($,2),tt=_[0],et=_[1],at=Object(r.useState)(""),nt=Object(n.a)(at,2),rt=nt[0],ot=nt[1],it=function(){var t=Object(h.a)(Object(x.a)().mark((function t(a){var n,r;return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.get("",{headers:{Authorization:"Bearer "+e.authenticated},params:Object(s.a)({limit:"zero",catRank:1},a)});case 3:return n=t.sent,r=n.data,t.abrupt("return",r.list);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){I({catRank:1})}),[I]),Object(r.useEffect)((function(){L({limit:15})}),[L]);var ct=Object(r.useMemo)((function(){return g[u]}),[g,u]),st=Object(r.useMemo)((function(){return g[u]?g[u].stockList[m]:{}}),[g,u,m]);Object(r.useEffect)((function(){ct&&(et(ct.categoryName),ot(st.stockName||""))}),[ct,st]);var dt=function(){var t=Object(h.a)(Object(x.a)().mark((function t(e){var a,n,r;return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.target.value,n=a?{categoryId:a,name:D,limit:15}:{name:D,limit:15},M(a),A(""),J(""),L(n),t.next=8,it({catRank:2,parent:a});case 8:r=t.sent,Z([]),K(r);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),lt=function(){var t=Object(h.a)(Object(x.a)().mark((function t(e){var a,n,r;return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.target.value,n=a?{categoryId:a,name:D,limit:15}:{categoryId:R,name:D,limit:15},A(a),J(""),L(n),t.next=7,it({catRank:3,parent:a});case 7:r=t.sent,Z(r);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ut=function(t){t.dataTransfer.setData("text/id",t.target.dataset.commId||""),t.dataTransfer.setData("text/name",t.target.dataset.commName||""),t.dataTransfer.setData("text/price",t.target.dataset.commPrice||""),t.dataTransfer.setData("text/backgroundColor",t.target.dataset.commColor||"")},pt=function(t){var e=t.currentTarget,a=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY),n=a&&a.dataset.itemIndex;if(n){var r=ct.stockList[n],o=e.dataset.commId||r.stockId,i=e.dataset.commPrice,d=Number(i)||("0"===i?0:r.price),l=Object(s.a)(Object(s.a)({},r),{},{stockId:o,price:d,stockName:e.dataset.commName||r.stockName,backgroundColor:e.dataset.commColor||r.backgroundColor});o&&w(Object(c.a)({},o,d)),S({id:ct.id,index:n,item:l})}},mt=function(t){return t.map((function(t){return Object(b.jsx)("option",{value:t.categoryId,children:(e=t.categoryDescription,e.replaceAll(/[[\]]/g,""))},t.categoryId);var e}))},gt=a&&a.map((function(t){return Object(b.jsxs)("div",{title:t.description,"data-comm-id":t.stockId,"data-comm-name":t.description,"data-comm-price":t.price?t.price.price:0,draggable:"true",onDragStart:ut,onTouchEnd:pt,children:[Object(b.jsx)("div",{className:"comm-name-sec",children:Object(b.jsx)(l.a,{noWrap:!0,variant:"body1",title:t.description,children:t.description})}),Object(b.jsx)("div",{className:"comm-price-sec",children:Object(b.jsx)(l.a,{noWrap:!0,variant:"body2",title:t.price?t.price.price:0,children:t.price?t.price.price:0})})]},t.stockId)})),bt=Object.keys(f).map((function(t,e){return Object(b.jsx)("span",{"data-comm-color":f[t],draggable:"true",onDragStart:ut,onTouchEnd:pt,style:{backgroundColor:f[t]}},e)})).reverse();return Object(b.jsxs)(o.a,{component:"section",id:"comm-list",sx:{position:"relative",display:"flex",flexDirection:"column",flex:"0 0 100%",paddingLeft:"1em",paddingRight:"1em",minHeight:"600px",minWidth:0,"& h5":{pt:"1.5rem",pb:"0.5rem",fontWeight:"bold"},"& .comm-classes":{paddingBottom:"0.75em"},"& .comm-classes select":{width:"100%",color:"#666666",borderColor:"#cccccc"}},children:[Object(b.jsx)(l.a,{variant:"h5",children:"\u5546\u54c1\u641c\u5c0b"}),Object(b.jsxs)(o.a,{component:"form",className:"comm-search",sx:{padding:"0 0 0.75em",'& input[type="text"]':{width:"80%",border:"1px solid #c4c4c4",borderRight:"none",lineHeight:1.75,borderTopLeftRadius:"0.3em",borderBottomLeftRadius:"0.3em"},'& input[type="submit"]':{width:"20%",lineHeight:1.75,border:"1px solid #c4c4c4",borderLeft:"none",letterSpacing:"0.2em",color:"background.default",bgcolor:"primary.light",borderTopRightRadius:"0.3em",borderBottomRightRadius:"0.3em"}},children:[Object(b.jsx)("input",{type:"text",placeholder:"\u8acb\u8f38\u5165\u5546\u54c1\u540d\u7a31",value:D,onChange:function(t){return W(t.target.value)}}),Object(b.jsx)("input",{type:"submit",value:"\u641c\u5c0b",onClick:function(t){t.preventDefault(),L(D?{name:D,categoryId:F||E||R,limit:15}:{categoryId:F||E||R,limit:15})}})]}),Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:dt,children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u5927\u985e\u5225"}),mt(i)]})}),X.length>0&&Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:lt,children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u6b21\u985e\u5225"}),mt(X)]})}),V.length>0&&Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:function(t){var e=t.target.value,a=e?{categoryId:e,name:D,limit:15}:{categoryId:E||R,name:D,limit:15};J(e),L(a)},children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u5c0f\u985e\u5225"}),mt(V)]})}),Object(b.jsx)(o.a,{className:"comm-list",sx:{overflowY:"auto",maxHeight:"400px",marginBottom:"2em","& > div":{display:"flex",alignItems:"center",userSelect:"none",cursor:"grab",backgroundColor:"#ececec",borderBottom:"1px dashed #666666",padding:"0.375rem 1rem"},"& .comm-name-sec":{flex:"1 1 auto",minWidth:0,paddingRight:"1rem"},"& .comm-name-sec p":{letterSpacing:"0.03rem"},"& .comm-price-sec p":{fontWeight:"bold"}},children:gt}),Object(b.jsxs)(o.a,{className:"control-wrapper",sx:{flexGrow:1,"& .plat-name-wrapper":{userSelect:"none",paddingTop:"0.75em"},"& .plat-name":{border:"1px solid #dddddd",borderRadius:"0.2em",lineHeight:"1em",width:"7.5em"},"& .name-submit":{lineHeight:1.25,border:"1px solid #aaaaaa"}},children:[Object(b.jsxs)("div",{className:"plat-name-wrapper",children:[Object(b.jsx)("label",{children:"\u9762\u677f\u540d\u7a31:\xa0"}),Object(b.jsx)("input",{className:"plat-name",value:tt,onChange:function(t){et(t.target.value)},type:"text"}),Object(b.jsx)("input",{className:"name-submit",onClick:function(){var t=Object(s.a)(Object(s.a)({},ct),{},{categoryName:tt});k({id:ct.id,layout:t})},type:"button",value:"\u4fee\u6539"})]}),Object(b.jsxs)("div",{className:"plat-name-wrapper",children:[Object(b.jsx)("label",{children:"\u5546\u54c1\u540d\u7a31:\xa0"}),Object(b.jsx)("input",{className:"plat-name",value:rt,onChange:function(t){ot(t.target.value)},type:"text"}),Object(b.jsx)("input",{className:"name-submit",onClick:function(){if(st.stockId&&rt){var t=Object(s.a)(Object(s.a)({},st),{},{stockName:rt});S({id:ct.id,index:m,item:t})}},type:"button",disabled:!rt,value:"\u4fee\u6539"})]}),Object(b.jsx)(o.a,{className:"comm-color",sx:{textAlign:"left",userSelect:"none",paddingTop:"2em","& span":{display:"inline-block",width:"2.25em",height:"1.5em"}},children:bt})]}),Object(b.jsx)(o.a,{id:"layout-save",sx:{textAlign:"center"},children:Object(b.jsxs)(o.a,{className:"btn-wrapper",sx:{padding:"1.5em 1.5em","& input":{backgroundColor:"#777777",borderRadius:"0.3em",padding:"0.125em 1.25em",color:"background.default",fontWeight:"bold",margin:"0.5em 0.25em",border:"none","&:last-child":{bgcolor:"primary.main"}}},children:[Object(b.jsx)("input",{type:"button",value:"\u5168\u90e8\u9084\u539f",onClick:function(){O(d),p(0)}}),Object(b.jsx)("input",{type:"button",value:"\u5168\u90e8\u5132\u5b58",onClick:function(){v(g,(function(){j.b.fire({icon:"success",title:"\u5132\u5b58\u4fee\u6539\u6210\u529f",target:document.querySelector(".right-col")})}),(function(t,e){j.b.fire({icon:"error",title:t||"\u767c\u751f\u932f\u8aa4...",target:document.querySelector(".right-col")})}))}})]})})]})})),S={platTagStyle:{position:"relative",backgroundColor:"#bbbbbb",display:"inline-block",userSelect:"none",cursor:"pointer",padding:"0 1em",marginRight:"0.125em",borderTopLeftRadius:"0.4em",borderTopRightRadius:"0.4em",overflow:"visible",transition:"margin 0.3s ease-out","&.dragover":{marginRight:"1.5em"},"&.dragover::after":{position:"absolute",content:'""',right:0,width:"1.6em",height:"1.5em",transform:"translate(100 %, 0)"},"&.active":{color:"#666666",backgroundColor:"background.default"},"& .new-tag-name":{maxWidth:0,padding:0,margin:0,border:"0 solid #cccccc",display:"inline-block",transition:"all 0.3s linear",lineHeight:1},"& .new-tag-submit":{maxWidth:0,padding:0,margin:0,border:"0 solid #cccccc",display:"inline-block",transition:"all 0.3s linear",lineHeight:1.25,verticalAlign:"top"},"& .add-icon":{display:"inline-block",color:"#dddddd",backgroundColor:"#9d9d9d",verticalAlign:"text-bottom",fontWeight:"bold",textAlign:"center",userSelect:"none",fontSize:"0.8rem",borderRadius:"3em",lineHeight:1.5,width:"1.5em",transform:"rotate(45deg)",transition:"all 0.2s linear"},"& .delete-icon":{display:"none"},"&.open .new-tag-name":{maxWidth:"5em",padding:"0 0.25em",backgroundColor:"#f0f0f0"},"&.open .new-tag-submit":{maxWidth:"3em",padding:"0 0.25em",marginRight:"0.3em",border:"2px solid #b3b3b3",backgroundColor:"#e2e2e2",color:"#333333"},"&.open .add-icon":{transform:"rotate(0deg)"}},deleteWrapperStyle:{display:"inline-block",width:"5em","& .plat-tag":{backgroundColor:"#cb5c5c",color:"background.darkPaper",zIndex:101}},deletingStyle:{zIndex:101,backgroundColor:"#fff1ed","& .plat-tag":{color:"#444444",backgroundColor:"#ff8e6f"},"& .plat-tag.active":{color:"background.paper",backgroundColor:"#fb6840"},"& .plat-tag .delete-icon":{display:"inline-block",color:"background.default",backgroundColor:"#fdc3a4",verticalAlign:"text-bottom",fontWeight:"bold",textAlign:"center",userSelect:"none",fontSize:"0.8rem",borderRadius:"3em",lineHeight:1.5,width:"1.5em",transition:"all 0.2s linear",marginLeft:"0.3em",transform:"rotate(0deg)"},"& .plat-tag.add-tag":{display:"none"},"& .delete-wrapper .plat-tag":{color:"background.darkPaper",backgroundColor:"#524d4d"}}},w=Object(d.b)((function(t){return{posLayoutDrafts:t.posLayoutDrafts}}),{fetchPriceMapping:g.b,editPosLayoutDrafts:p.g,addPosLayoutDraft:p.a,deletePosLayoutDraft:p.d})((function(t){var e=t.isDeleting,a=t.setIsDeleting,i=t.posLayoutDrafts,c=t.currentLayoutIndex,s=t.setCurrentLayoutIndex,d=t.setRecordedLayoutIndex,l=t.setCurrentLayoutItemIndex,u=t.fetchPriceMapping,p=t.editPosLayoutDrafts,m=t.addPosLayoutDraft,g=t.deletePosLayoutDraft,f=Object(r.useState)(!1),x=Object(n.a)(f,2),h=x[0],j=x[1],v=Object(r.useState)(""),O=Object(n.a)(v,2),y=O[0],k=O[1],w=Object(r.useRef)();Object(r.useEffect)((function(){var t=function(t){w.current&&w.current.contains(t.target)||j(!1)};return document.body.addEventListener("click",t,{capture:!0}),function(){document.body.removeEventListener("click",t,{capture:!0})}}),[]);var L=function(t){u(i[t].stockList),d(t)},I=function(t){for(var e=!0,a="",n=t.map((function(t){return t.id}));e;)a=C(),e=n.includes(a);return a},C=function(){return"layout"+"yxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},N=function(t){t.dataTransfer.setData("text/index",t.target.dataset.tagIndex||""),t.dataTransfer.setData("text/layoutID",t.target.dataset.layoutId||"")},D=function(t){t.currentTarget.classList.add("dragover"),P(t)},W=function(t){t.currentTarget.classList.remove("dragover"),P(t)},P=function(t){return t.preventDefault(),t.stopPropagation(),!1},T=function(t){var a=t.currentTarget;if(a.classList.remove("dragover"),!e&&t.dataTransfer.getData("text/index")&&a.dataset.tagIndex){var n=Number(t.dataTransfer.getData("text/index")),r=Number(a.dataset.tagIndex),o=n<=r?r:r+1,c=i.slice(n,n+1),d=i.filter((function(t,e){return e!==n}));d.splice(o,0,c[0]),p(d),s(o)}},R=function(t){var a=t.currentTarget,n=document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY);if(!e&&a.dataset.tagIndex&&n.dataset.tagIndex){var r=Number(a.dataset.tagIndex),o=Number(n.dataset.tagIndex),c=r<=o?o:o+1,d=i.slice(r,r+1),l=i.filter((function(t,e){return e!==r}));l.splice(c,0,d[0]),p(l),s(c)}},M=i.map((function(t,a){var n=a===c?"active":"";return Object(b.jsxs)("div",{draggable:!e,className:"plat-tag ".concat(n),"data-tag-index":a,"data-layout-id":t.id,onDragStart:N,onDragEnter:D,onDragOver:P,onDragLeave:W,onDrop:T,onTouchEnd:R,onClick:function(t){return function(t,a){t.target.classList.contains("delete-icon")||(s(a),e&&L(a),l(0))}(t,a)},children:[t.categoryName,Object(b.jsx)("span",{className:"delete-icon",onClick:function(){return function(t,e){if(!(i.length<=1)){var a=c>=i.length-1;(c>e||a)&&s(c-1),c===e&&(a?L(e-1):u(i[e+1].stockList)),g(t)}}(t.id,a)},children:"\u2715"})]},t.id)}));return Object(b.jsxs)(o.a,{component:"section",id:"plat-tag-list",className:"".concat(e?"deleting":""),sx:{"& .plat-tag":S.platTagStyle,"& .delete-wrapper":S.deleteWrapperStyle,"&.deleting":S.deletingStyle},children:[Object(b.jsxs)(o.a,{className:"tag-wrapper",sx:{display:"inline-block",width:"calc(100% - 5em)",paddingTop:"0.5em"},children:[M,Object(b.jsxs)("div",{className:"plat-tag add-tag ".concat(h?"open":""),ref:w,children:[Object(b.jsx)("input",{onChange:function(t){k(t.target.value)},value:y,className:"new-tag-name",placeholder:"\u7248\u9762\u540d\u7a31",type:"text"}),Object(b.jsx)("input",{onClick:function(){if(y){var t={id:I(i),categoryName:y};s(i.length),m(t),j(!1),k("")}},className:"new-tag-submit",type:"button",value:"\u65b0\u589e"}),Object(b.jsx)("span",{className:"add-icon",onClick:function(){j(!h)},children:"\u2715"})]})]}),Object(b.jsx)("div",{className:"delete-wrapper",children:Object(b.jsx)("div",{className:"plat-tag",onClick:function(){a(!e)},children:e?"\u7d50\u675f":"\u522a\u9664"})})]})})),L=a(253),I={bgcolor:"background.paper",userSelect:"none","& > .row":{px:0},"& .left-col":{position:"relative",display:"flex",height:"calc(100vh - 2.5rem)",padding:0},"& .right-col":{position:"relative",display:"flex",flexDirection:"column",height:"100vh",padding:0},"& .mask-field":{display:"none"},"& .deleting .mask-field":{position:"absolute",display:"block",top:0,left:0,width:"100%",height:"calc(100vh - 2.5rem)",zIndex:100,bgcolor:"#ffeae0a8"},"@media (min-width: 600px)":{"& .right-col":{height:"calc(100vh - 2.5rem)"}}};e.default=Object(L.a)()((function(){var t=Object(r.useState)(!1),e=Object(n.a)(t,2),a=e[0],c=e[1],s=Object(r.useState)(0),d=Object(n.a)(s,2),l=d[0],u=d[1],p=Object(r.useState)(null),m=Object(n.a)(p,2),g=m[0],x=m[1],h=Object(r.useState)(0),j=Object(n.a)(h,2),v=j[0],O=j[1];return Object(b.jsx)(o.a,{id:"touch-platform-backstage",sx:I,children:Object(b.jsxs)(i.a,{container:!0,sx:{maxWidth:1600,margin:"0 auto",boxShadow:"0px 0px 12px -6px #cccccc",bgcolor:"background.light"},children:[Object(b.jsxs)(i.a,{item:!0,xs:12,sm:3,className:"left-col ".concat(a?"deleting":""),children:[Object(b.jsx)(k,{isDeleting:a,currentLayoutIndex:l,currentLayoutItemIndex:v,setCurrentLayoutIndex:u,setCurrentLayoutItemIndex:O}),Object(b.jsx)("div",{className:"mask-field"})]}),Object(b.jsxs)(i.a,{item:!0,xs:12,sm:9,className:"right-col ".concat(a?"deleting":""),children:[Object(b.jsx)(w,{isDeleting:a,currentLayoutIndex:l,recordedLayoutIndex:g,setIsDeleting:c,setCurrentLayoutIndex:u,setRecordedLayoutIndex:x,setCurrentLayoutItemIndex:O}),Object(b.jsx)(f,{isDeleting:a,currentLayoutIndex:l,recordedLayoutIndex:g,currentLayoutItemIndex:v,setCurrentLayoutIndex:u,setRecordedLayoutIndex:x,setCurrentLayoutItemIndex:O}),Object(b.jsx)("div",{className:"mask-field"})]})]})})}))}}]);
//# sourceMappingURL=11.42dbcf67.chunk.js.map