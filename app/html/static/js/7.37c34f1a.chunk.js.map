{"version":3,"sources":["components/Auth/withAuth.js","helpers/dateParser.js","components/ui/DialogMember.js","components/ui/PrintedOrder.js","components/ui/SalePointCard.js","components/ui/DialogSalePoint.js","../node_modules/@mui/icons-material/SwapVerticalCircle.js","../node_modules/@mui/icons-material/ArrowLeft.js","../node_modules/@mui/icons-material/ArrowRight.js","../node_modules/@mui/icons-material/PlayForWork.js","../node_modules/@mui/icons-material/PointOfSale.js","components/PosPlatform/InfoHeader.js","components/Toggle.js","../node_modules/@mui/icons-material/esm/Cancel.js","../node_modules/@mui/icons-material/esm/Restore.js","../node_modules/@mui/material/DialogActions/dialogActionsClasses.js","../node_modules/@mui/material/DialogActions/DialogActions.js","components/PosPlatform/Dialog/DialogTempOrder.js","../node_modules/@mui/icons-material/esm/PlayArrow.js","../node_modules/@mui/icons-material/esm/ReplyAll.js","components/PosPlatform/Dialog/DialogInfoImport.js","components/PosPlatform/ControlBar.js","helpers/discountCalc.js","components/PosPlatform/CommStripList.js","helpers/checkout.js","components/PosPlatform/SearchComm.js","components/PosPlatform/NumberPanel.js","hooks/useBarcode.js","../node_modules/@mui/icons-material/esm/CheckCircle.js","../node_modules/@mui/icons-material/esm/Check.js","components/PosPlatform/Dialog/DialogCheckoutContent.js","components/PosPlatform/Dialog/DialogCheckout.js","components/ui/OrderList.js","components/PosPlatform/Dialog/DialogReturn.js","components/PosPlatform/Dialog/DialogRepay.js","components/PosPlatform/SettlementBar.js","components/PosPlatform/CommGrid.js","components/PosPlatform/PosPlatform.js"],"names":["authLevelMapping","shop","company","enterprise","withAuth","authLevel","ChildComponent","connect","state","auth","authenticated","level","props","history","useEffect","push","getDateString","dateString","changeType","originMs","Date","getTime","parseMsToDateString","ms","divider","originDate","monthNumber","getMonth","monthString","toString","padStart","dateNumber","getDate","getFullYear","formFieldStyle","display","padding","flex","color","paddingRight","flexWrap","py","pr","alignItems","position","fontSize","bottom","transform","fontWeight","flexGrow","lineHeight","letterSpacing","width","justifyContent","bgcolor","theme","palette","primary","main","borderRadius","borderBottomLeftRadius","borderBottomRightRadius","border","light","borderTopLeftRadius","borderTopRightRadius","members","fetchMembers","open","handleClose","onSelectClick","useState","memberFormInfo","setMemberFormInfo","validateErrors","setValidateError","list","handleInputChange","e","target","name","value","newValue","handleCreate","preventDefault","validateCreate","data","memberName","phone","memberRequest","post","headers","response","console","log","fireDialogToast","error","errors","Object","keys","length","id","onClose","fullWidth","maxWidth","PaperProps","sx","margin","variant","onClick","right","top","height","component","className","type","onChange","autoComplete","petName","disableElevation","borderRight","background","darkPaper","maxHeight","overflow","map","item","noWrap","memberCode","title","homePhone","minWidth","showOrderTime","timestamp","toLocaleString","renderPayment","payments","payment","SalePointPayment","paymentName","OrderItemDetail","index","stockMaster","description","stockDescription","user","price","quantity","subTotal","orderTableStyle","backgroundColor","textAlign","wordBreak","paper","paddingLeft","PrintedOrder","order","creditCardInfo","salesPayments","find","Boolean","creditCard","minHeight","container","px","default","xs","date","memberInfo","salesman","realName","cashRegister","salePoint","salePointName","invoicePage","no","salesDetails","p","borderTop","flexDirection","cardNo","replaceAll","slice","approvalCode","actualTotal","SalePointCard","selectedSalePoints","handleSelectSalePoint","Card","Grid","wrap","spacing","Checkbox","readOnly","checked","some","el","zeroMinWidth","Typography","onSalePointSelectClick","salePoints","setSalePoints","setSelectedSalePoints","fetchSalePoints","salePointRequest","get","newSelectedSalePoints","filter","Dialog","Box","IconButton","DialogContent","mt","md","pb","overflowY","gap","colNum","renderSalePointCards","Divider","orientation","flexItem","mx","direction","pl","mb","pt","Paper","elevation","square","renderSelectedSalePoints","Button","size","endIcon","_interopRequireDefault","require","defineProperty","exports","_createSvgIcon","_jsxRuntime","_default","jsx","d","currentMember","visits","initialVisits","renewVisits","setDateString","timeString","setTimeString","setFormatDate","clockInterval","setInterval","clearInterval","newDate","toLocaleDateString","dayString","getDay","toLocaleTimeString","replace","memberActive","boxShadow","textShadow","visitsNum","Toggle","this","determineParam","children","React","Component","createSvgIcon","_jsx","getDialogActionsUtilityClass","slot","generateUtilityClass","generateUtilityClasses","_excluded","DialogActionsRoot","styled","overridesResolver","styles","ownerState","root","disableSpacing","_extends","marginLeft","DialogActions","inProps","ref","useThemeProps","other","_objectWithoutPropertiesLoose","classes","slots","composeClasses","useUtilityClasses","clsx","dayStrings","tempHeaderStyle","paddingTop","paddingBottom","borderLeft","tempListStyle","cursor","userSelect","detailHeaderStyle","detailListStyle","tempOrders","replacePosStrips","getTempOrderWithLocal","deleteTempOrderWithLocal","replaceCurrentTempOrderId","replaceCurrentMember","currentTempOrderId","setCurrentTempOrderId","details","formatDateString","inputDate","yearString","month","originTimeString","currentTempOrder","tempOrder","Cancel","active","totalAmount","totalQuantity","member","renderTempItem","content","detail","stockName","discount","total","startIcon","Restore","memberTableStyle","detailTableStyle","externalOrders","activeExternalOrder","selectedExternalOrders","replaceExternalOrders","replaceActiveExternalOrder","fetchExternalOrders","fetchActiveExternalOrder","addSelectedExternalOrder","removeSelectedExternalOrder","clearSelectedExternalOrders","selectAllExternalOrders","replaceCurrentExternalOrderId","useTheme","orderDate","setOrderDate","setMemberName","isSelectedAll","setIsSelectedAll","activeMemberId","setActiveMemberId","isSales","memberId","orders","selectedOrderGroup","useMemo","reduce","prev","current","tempSalesDetails","onMemberClick","changeDate","currentTarget","dataset","onOrderClick","convertExternalOrder","tempSalesDetailsId","salePrice","originalTotal","onCheckboxClick","renderDetails","Fade","tabIndex","borderBottom","onSubmit","ml","alpha","searchType","Number","isNaN","onKeyUp","code","onMemberKeyUp","renderMembers","mr","PlayArrow","startDate","endDate","Toast","fire","document","querySelector","join","ReplyAll","TransitionGroup","pet","onOrderKeyUp","stopPropagation","in","Fragment","posStrips","posStripsSum","currentSalesmanId","currentExternalOrderId","addTempOrderWithLocal","replaceCurrentSalesmanId","setSelectedIds","memberOpen","setMemberOpen","tempLoadOpen","setTempLoadOpen","importOpen","setImportOpen","users","setUsers","fetchUsers","userRequest","params","limit","validateExternalOrder","salesmanOptions","userId","outline","appearance","backgroundPosition","backgroundSize","backgroundRepeat","marginTop","marginBottom","textOverflow","backgroundImage","verticalAlign","transition","marginRight","disabled","DialogMember","newTempOrder","uuidv4","now","icon","verifyDiscountString","discountString","percentTest","RegExp","test","amountTest","convertDiscount","comm","mode","discountAmount","newDiscountString","discountNum","calcCommTotal","discountMode","discountMultiple","MULTIPLE_MODE","Math","ceil","LabelsIcon","SvgIcon","viewBox","fill","MoneyIcon","UndiscountIcon","stripHeader","stripList","outlineColor","deletePosStrip","replacePosStripsSum","setUniformContent","setKeyboardMode","activeCommId","setActiveCommId","selectedIds","primitiveTotal","forEach","strip","strips","onInputClick","keyboardMode","itemId","isNumber","processedComms","allStripsId","inputProps","listRef","includes","selectedId","onCommCheckboxClick","undiscountable","stockId","onQuantityChange","onDiscountChange","text","secondary","getNewStrip","priceMapping","printReceipt","salesInfo","invoiceHeads","saleDetail","window","printerBridge","headTime","invoiceHead1","invoiceHead2","invoiceHead3","invoiceHead4","invoiceHead5","invoiceHead6","salePointInvoiceName","qty","alignContent","searchList","zIndex","comms","addPosStrip","fetchComms","replaceComms","searchContent","setSearchContent","activeSearchIndex","setActiveSearchIndex","containerRef","useRef","activeItemRef","commListRef","onCommClick","newStrip","scrollToBottom","scrollTo","scrollHeight","onBodyClick","useCallback","contains","body","removeEventListener","capture","addEventListener","placeholder","searchComm","combinedName","onCommKeyUp","uniformContent","onPanelItemClick","onUniformContentChange","onKeyboardModeClick","isCommsChecked","newComms","handelDiscountUnify","handleDiscountModify","isIllegalQuantityStr","handleQuantityUnify","handleQuantityModify","isDiscountExcess","isContainUndiscountable","findIndex","inputString","borderColor","useBarcode","barcode","setBarcode","UPC","timeoutId","handleKeyDown","textInput","key","String","fromCharCode","keyCode","targetName","localName","clearTimeout","setTimeout","taxIdRegex","barCodeRegex","loveCodeRegex","certificateRegex","receivedAmountInput","receivedAmountList","mainPaymentMethod","minorPaymentMethod","paymentStatus","checkoutBtnWrapper","invoiceInfo","orderDetail","clearMethod","paymentMethods","receivedAmounts","creditCardResponse","updateReceivedAmounts","replaceReceivedAmounts","replaceCreditCardResponse","checkout","handleCheckoutClose","isPartialClear","setIsPartialClear","printContentRef","inputAmount","setInputAmount","unreceiveAmount","setUnreceiveAmount","giveChangeAmount","setGiveChangeAmount","isTaxIdChecked","setIsTaxIdChecked","taxId","setTaxId","carrierType","setCarrierType","invoiceCarrier","setInvoiceCarrier","printOrder","setPrintOrder","receiptMode","localStorage","getItem","salePointId","clearBarcode","distinguishCarrierType","onCheckoutClick","validateCheckout","successData","printContent","printIframe","innerHTML","print","receivedSum","values","previousValue","currentValue","newUnreceiveAmount","onPaymentClick","removeReceived","onCashClick","onCreditClick","addReceived","edcBridge","send","amount","edc","configBridge","getConfig","success","receivedPaymentId","paymentId","alert","initialAmount","targetReceiveAmount","omit","partialClearing","renderReceivedList","approvalNo","minorPaymentButtons","typeId","salePointPaymentsTypeId","renderMinorPaymentBtn","CheckCircle","Check","Transition","forwardRef","Slide","dialogTitle","titleCloseBtn","DialogCheckout","handleValidateAndClose","dispatch","useDispatch","fetchPaymentMethods","TransitionComponent","fieldGridStyle","orderHeaderStyle","orderListStyle","orderDetailStyle","btnFieldStyle","OrderList","sales","fetchSales","currentOrderId","setCurrentOrderId","currentPaidOrder","searchParams","handleItemClick","isMemberOpen","setIsMemberOpen","isSalePointOpen","setIsSalePointOpen","onSearchChange","originStartValue","originEndValue","newSearchContent","flexShrink","salePointNames","DialogSalePoint","salePointIdsArrayString","salePointNamesArrayString","salePointIds","max","min","isReturn","dialogActionStyle","deleteSale","currentCreditInfo","onReturnClick","salesRequest","paymentType","phoneBarcode","uniformNumber","transferSaleArrear","isRepaying","setIsRepaying","currentArrearInfo","isOwePayment","saleId","arrearId","restPayments","renderPayments","CrossIcon","CalcIcon","clearPosStrips","checkoutOpen","setCheckoutOpen","returnOpen","setReturnOpen","repayOpen","setRepayOpen","onBarcodeScanned","commRequest","sort","internationalBarcode","validateReceived","openCashRegister","commGrid","templateTagList","left","posLayouts","posLayoutsStatus","loading","fetchPriceMapping","fetchPosLayouts","currentLayoutIndex","setCurrentLayoutIndex","posLayout","stockList","tags","cards","card","stockPrice","style","tag","onTagClick","categoryName","leftPlatform","rightPlatform","panelContainer","INITIAL_KEYBOARD_MODE","Container"],"mappings":"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","file":"static/js/7.37c34f1a.chunk.js","sourcesContent":["import React, { useEffect } from 'react'\nimport { connect } from 'react-redux'\n\nconst authLevelMapping = {\n  shop: 5,\n  company: 10,\n  enterprise: 15\n}\n\nconst withAuth = authLevel => ChildComponent => {\n  const ComposedComponent = props => {\n    const { auth, level, history } = props\n\n    useEffect(() => {\n      if (!auth) {\n        history.push('/signin')\n        return\n      }\n      if (authLevel && (!level || authLevelMapping[authLevel] > authLevelMapping[level])) {\n        history.push('/')\n        return\n      }\n    }, [auth, level, history])\n\n    return (\n      <ChildComponent {...props} />\n    )\n  }\n\n  const mapStateToProps = state => {\n    return {\n      auth: state.auth.authenticated,\n      level: state.auth.level\n    }\n  }\n\n  return connect(mapStateToProps)(ComposedComponent)\n}\n\nexport default withAuth","// 取得前一天或後一天的 Date Input 字串\nexport const getDateString = (dateString, changeType) => {\n  const originMs = new Date(dateString).getTime()\n  const newMs = changeType === 'previous' ? (originMs - 86400000) : (originMs + 86400000)\n  return parseMsToDateString(newMs)\n}\n\nexport const parseMsToDateString = (ms, divider = '-') => {\n  const originDate = new Date(ms)\n  const monthNumber = originDate.getMonth() + 1\n  const monthString = monthNumber.toString().padStart(2, '0')\n  // const monthString = monthNumber < 10 ? ('0' + monthNumber.toString()) : monthNumber.toString()\n  const dateNumber = originDate.getDate()\n  const dateString = dateNumber.toString().padStart(2, '0')\n  // const dateString = dateNumber < 10 ? ('0' + dateNumber.toString()) : dateNumber.toString()\n  return (originDate.getFullYear().toString() + divider + monthString + divider + dateString)\n}","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { fetchMembers } from '../../slices/membersSlice'\nimport { memberRequest } from '../../apis'\nimport CancelIcon from '@mui/icons-material/Cancel'\nimport { fireDialogToast } from '../../helpers/sweetAlert'\nimport { Button, Dialog, DialogContent, IconButton, Typography, Box } from '@mui/material'\n\nconst MemberDialog = ({\n  auth,\n  open,\n  members,\n  handleClose,\n  fetchMembers,\n  onSelectClick,\n}) => {\n  const [memberFormInfo, setMemberFormInfo] = useState({})\n  const [validateErrors, setValidateError] = useState({})\n\n  useEffect(() => {\n    if (!open) return\n    fetchMembers()\n  }, [open, fetchMembers])\n\n  const handleInputChange = e => {\n    const { name, value } = e.target\n    const newValue = { ...memberFormInfo, [name]: value }\n    setMemberFormInfo(newValue)\n  }\n\n  const handleSubmit = e => {\n    e.preventDefault()\n    fetchMembers(memberFormInfo)\n    setValidateError({})\n  }\n\n  const handleCreate = async e => {\n    e.preventDefault()\n    if (validateCreate()) return\n\n    try {\n      const data = {\n        memberName: memberFormInfo.name,\n        phone: memberFormInfo.phone,\n      }\n      const response = await memberRequest.post('', data, {\n        headers: { 'Authorization': 'Bearer ' + auth.authenticated },\n      })\n      console.log(response)\n\n      fetchMembers()\n      setMemberFormInfo({})\n      fireDialogToast('新增會員成功', 'success')\n    } catch (error) {\n      fireDialogToast(`錯誤: ${error?.response?.data?.error || '新增會員失敗'}`, 'error')\n    }\n  }\n\n  const validateCreate = () => {\n    const errors = {}\n    if (!memberFormInfo.phone) {\n      errors.phone = '電話為必填'\n    } else if (memberFormInfo.phone[0] !== '0') {\n      errors.phone = '電話格式錯誤'\n    }\n    if (!memberFormInfo.name) {\n      errors.name = '姓名為必填'\n    }\n    setValidateError(errors)\n    return (Object.keys(errors).length > 0)\n  }\n\n  const renderList = (list) => {\n    return list.map(item => {\n      return (\n        <div className=\"list-item\" key={item.id}>\n          <div className=\"id-sec\">\n            <Typography variant=\"body1\" noWrap={true}>\n              {item.memberCode || '-'}\n            </Typography>\n          </div>\n          <div className=\"name-sec\">\n            <Typography variant=\"body1\" noWrap={true} title={item.memberName}>\n              {item.memberName}\n            </Typography>\n          </div>\n          <div className=\"mobile-sec\">\n            <Typography variant=\"body1\" noWrap={true}>\n              {item.phone || '-'}\n            </Typography>\n          </div>\n          <div className=\"tel-sec\">\n            <Typography variant=\"body1\" noWrap={true}>\n              {item.homePhone || '-'}\n            </Typography>\n          </div>\n          <div className=\"select-sec\" onClick={() => onSelectClick(item)}>\n            <Button sx={{\n              minWidth: '3.5em',\n              height: '1.75em',\n              padding: '0',\n              color: 'background.paper',\n              bgcolor: (theme) => theme.palette.primary.main,\n              '&:hover': {\n                bgcolor: '#fabd5e',\n              },\n            }}>\n              選取\n            </Button>\n          </div>\n        </div>\n      )\n    }\n    )\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-member\"\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"dialog-member\"\n      fullWidth maxWidth=\"sm\"\n      PaperProps={{\n        sx: { maxWidth: 700 }\n      }}\n    >\n      <Box\n        sx={{\n          margin: 0,\n          padding: '0.375em 1.75em 0.25em',\n          bgcolor: 'background.default',\n          '& h6': {\n            color: 'secondary.main',\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n          }\n        }}\n      // sx={{\n      //   flex: '0 0 auto',\n      //   margin: 0,\n      //   padding: '0.375em 1.25em 0.25em',\n      //   lineHeight: 1.6,\n      //   letterSpacing: '0.0075rem',\n      //   '& h6': {\n      //     color: (theme) => theme.palette.primary.main,\n      //     fontSize: '1.375rem',\n      //     fontWeight: 'bold',\n      //     letterSpacing: '0.05em',\n      //   }\n      // }}\n      >\n        <Typography variant=\"h6\">會員選取</Typography>\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: '#cb5c5c',\n            padding: 0,\n          }}>\n            <CancelIcon sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent sx={{ padding: '0.25em 1.75em 2em', bgcolor: 'background.paper' }}>\n        <Box component=\"form\" sx={formFieldStyle}>\n          <div className=\"input-field\">\n\n            <div className=\"input-wrapper\">\n              <label>姓名 : &nbsp;</label>\n              <input\n                className={`input-md ${validateErrors.name ? 'error' : ''}`}\n                type=\"text\"\n                name=\"name\"\n                value={memberFormInfo.name || ''}\n                onChange={handleInputChange}\n                autoComplete=\"off\"\n              />\n              {validateErrors.name && (<span>{validateErrors.name}</span>)}\n            </div>\n\n            <div className=\"input-wrapper\">\n              <label>電話 : &nbsp;</label>\n              <input\n                className={`input-md ${validateErrors.phone ? 'error' : ''}`}\n                type=\"text\"\n                name=\"phone\"\n                value={memberFormInfo.phone || ''}\n                onChange={handleInputChange}\n                autoComplete=\"off\"\n              />\n              {validateErrors.phone && (<span>{validateErrors.phone}</span>)}\n            </div>\n\n\n\n            <div className=\"input-wrapper\">\n              <label>寵物 : &nbsp;</label>\n              <input\n                className={`input-sm ${validateErrors.petName ? 'error' : ''}`}\n                type=\"text\"\n                name=\"petName\"\n                value={memberFormInfo.petName || ''}\n                onChange={handleInputChange}\n                autoComplete=\"off\"\n              />\n            </div>\n          </div>\n\n          <div className=\"submit-field\">\n            <Button\n              className=\"submitBtn\"\n              type=\"submit\"\n              onClick={handleSubmit}\n            >\n              搜尋\n            </Button>\n            <Button\n              className=\"newBtn\"\n              variant=\"contained\"\n              color=\"primary\"\n              disableElevation\n              onClick={handleCreate}\n            >\n              新增\n            </Button>\n          </div>\n        </Box>\n\n        {/* <Box sx={{\n          padding: '0.25em 0 0.5em',\n          '& button': {\n            fontSize: '1rem',\n            fontWeight: 'bold',\n            padding: '0 0.5em',\n            marginRight: '0.5em',\n            borderRadius: 0,\n            color: 'text.secondary',\n            borderColor: 'text.secondary',\n          },\n        }}>\n          <Button variant=\"outlined\">最近交易會員</Button>\n          <Button variant=\"outlined\">未結批價單會員</Button>\n        </Box> */}\n\n        <div>\n          <Box sx={{\n            display: 'flex',\n            bgcolor: 'secondary.main',\n            '& > div': {\n              display: 'flex',\n              justifyContent: 'center',\n              alignItems: 'center',\n              fontSize: '1rem',\n              borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n              color: 'background.paper',\n              height: '1.75em',\n            },\n            '& .id-sec': {\n              flex: '0 0 17.5%',\n            },\n            '& .name-sec': {\n              flex: '0 0 17.5%',\n            },\n            '& .mobile-sec': {\n              flex: '0 0 25%',\n            },\n            '& .tel-sec': {\n              flex: '0 0 25%',\n            },\n            '& .select-sec': {\n              flex: '0 0 15%',\n              borderRight: 'none',\n            },\n          }}>\n            <div className=\"id-sec\">代碼</div>\n            <div className=\"name-sec\">會員名稱</div>\n            <div className=\"mobile-sec\">手機號碼</div>\n            <div className=\"tel-sec\">住家號碼</div>\n            <div className=\"select-sec\"></div>\n          </Box>\n          <Box sx={{\n            maxHeight: '14rem',\n            overflow: 'overlay',\n            '& .list-item': {\n              display: 'flex',\n              '& > div': {\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                fontSize: '1rem',\n                borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n                color: 'secondary.main',\n                height: '2em',\n                overflow: 'hidden',\n                padding: '0 0.5em',\n              },\n              '&:nth-of-type(2n + 1)': {\n                bgcolor: '#ececec',\n              },\n              '& .id-sec': {\n                flex: '0 0 17.5%',\n              },\n              '& .name-sec': {\n                flex: '0 0 17.5%',\n              },\n              '& .mobile-sec': {\n                flex: '0 0 25%',\n              },\n              '& .tel-sec': {\n                flex: '0 0 25%',\n              },\n              '& .select-sec': {\n                flex: '0 0 15%',\n                borderRight: 'none',\n                overflow: 'hidden',\n              },\n            },\n          }}>\n            {renderList(members)}\n          </Box>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    auth: state.auth,\n    members: state.members,\n  }\n}\n\nconst formFieldStyle = {\n  display: 'flex',\n  padding: '0.5em 0 0.75em',\n  '& .input-field': {\n    flex: '0 0 85%',\n    color: 'secondary.main',\n    paddingRight: '0.5em',\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  '& .input-wrapper': {\n    flex: '0 0 50%',\n    py: '0.375em',\n    pr: '0.5em',\n    display: 'flex',\n    alignItems: 'center',\n    flexWrap: 'wrap',\n    position: 'relative',\n    '& span': {\n      color: 'error.light',\n      fontSize: '0.75rem',\n      position: 'absolute',\n      bottom: '0',\n      transform: 'translateY(50%)',\n    },\n  },\n  '& label': {\n    fontWeight: 'bold',\n    fontSize: '1.125rem',\n  },\n  '& input': {\n    flexGrow: 1,\n    lineHeight: 1.25,\n    padding: '0 0.25em',\n    '&::placeholder': {\n      fontSize: '0.875rem',\n      letterSpacing: '0.04em',\n    },\n    '&.error::placeholder': {\n      color: 'error.light',\n    },\n  },\n  '& input.input-md': {\n    width: 'calc(100% - 4em)',\n  },\n  '& input.input-sm': {\n    width: 'calc(100% - 6.5em)',\n  },\n  '& .submit-field': {\n    flex: '0 0 15%',\n    display: 'flex',\n    flexWrap: 'wrap',\n    justifyContent: 'center',\n    '& .submitBtn': {\n      flex: '0 0 100%',\n      color: 'background.paper',\n      fontWeight: 'bold',\n      fontSize: '1.125rem',\n      display: 'inline-flex',\n      justifyContent: 'center',\n      bgcolor: (theme) => theme.palette.primary.main,\n      // margin: '0.75em 0',\n      borderRadius: '0.5em',\n      borderBottomLeftRadius: 0,\n      borderBottomRightRadius: 0,\n      border: 'none',\n      '&:hover': {\n        // bgcolor: '#fabd5e',\n        bgcolor: (theme) => theme.palette.primary.light,\n      },\n    },\n    '& .newBtn': {\n      flex: '0 0 100%',\n      lineHeight: 1.5,\n      color: 'background.paper',\n      fontWeight: 'bold',\n      borderRadius: '0.5em',\n      borderTopLeftRadius: 0,\n      borderTopRightRadius: 0,\n      bgcolor: '#6aabc3',\n      '&:hover': {\n        bgcolor: '#72b9d3',\n      },\n    },\n  },\n}\n\nexport default connect(\n  mapStateToProps,\n  { fetchMembers }\n)(MemberDialog)","import React from 'react'\nimport Box from '@mui/material/Box'\nimport Grid from '@mui/material/Grid'\nimport Paper from '@mui/material/Paper'\n\nexport const showOrderTime = timestamp => {\n  return new Date(timestamp).toLocaleString()\n}\n\nexport const renderPayment = payments => {\n  return payments.map(payment => {\n    return (\n      <div className=\"received-sec\" key={payment.id}>\n        <span>\n          {`${payment.SalePointPayment?.paymentName} : `}\n        </span>\n        <span className=\"main-value\">\n          {payment.value}\n        </span>\n      </div>\n    )\n  })\n}\n\nexport const OrderItemDetail = ({ list }) => {\n  return (\n    <Box className=\"order-table\">\n      <div className=\"table-header\">\n        <div className=\"serial-sec\">項次</div>\n        <div className=\"name-sec\">商品名稱</div>\n        <div className=\"clerk-sec\">服務員</div>\n        <div className=\"price-sec\">定價</div>\n        <div className=\"quantity-sec\">數量</div>\n        <div className=\"discount-sec\">折數</div>\n        <div className=\"total-sec\">合計</div>\n      </div>\n\n      <div className=\"table-list\">\n        {list.map((item, index) => {\n          return (\n            <div className=\"table-item\" key={item.id}>\n              <div className=\"serial-sec\">{index + 1}</div>\n              <div className=\"name-sec\">\n                {(item.stockMaster && item.stockMaster.description) || item.stockDescription}\n              </div>\n              <div className=\"clerk-sec\">{item.user}</div>\n              <div className=\"price-sec\">{item.price}</div>\n              <div className=\"quantity-sec\">{item.quantity}</div>\n              <div className=\"discount-sec\">\n                {((item.price * item.quantity) - item.subTotal) || ''}\n              </div>\n              <div className=\"total-sec\">{item.subTotal}</div>\n            </div>\n          )\n        }\n        )}\n      </div>\n    </Box>\n  )\n}\n\nexport const PrintedOrder = ({ order }) => {\n  const creditCardInfo = order?.salesPayments?.find(payment => Boolean(payment.creditCard))?.creditCard || {}\n\n  return (\n    <Paper\n      sx={{\n        width: '100%',\n        minHeight: '100%',\n        overflow: 'hidden',\n        '& .order-table': orderTableStyle,\n      }}\n    >\n      <Grid container alignItems=\"center\"\n        sx={{\n          px: '0.5rem',\n          py: '0.25rem',\n          bgcolor: theme => theme.palette.background.default,\n        }}\n      >\n\n        <Grid item xs>\n          <Grid container>\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                日期 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {showOrderTime(order.date)}\n              </Grid>\n            </Grid>\n\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                會員 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {order.memberInfo ? `${order.memberInfo.memberName} | ${order.memberInfo.phone}` : '---'}\n              </Grid>\n            </Grid>\n\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                銷售員 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {order.salesman && order.salesman.realName}\n              </Grid>\n            </Grid>\n          </Grid>\n\n          <Grid container>\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                門市 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {(order?.cashRegister?.salePoint?.salePointName || '-')}\n              </Grid>\n            </Grid>\n\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                發票 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {order.invoicePage ? order.invoicePage.no : '無發票資訊'}\n              </Grid>\n            </Grid>\n\n            <Grid item xs container>\n              <Grid item xs=\"auto\">\n                服務員 :&nbsp;\n              </Grid>\n              <Grid item xs className=\"bold\">\n                {order.user && order.user.realName}\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n\n        <Grid item xs=\"auto\">\n          {order.no}\n        </Grid>\n\n      </Grid>\n\n      <OrderItemDetail list={order.salesDetails || []} />\n\n\n      <Grid container justifyContent=\"space-between\" alignItems=\"center\"\n        sx={{\n          p: '0.25rem',\n          borderTop: theme => `1px solid ${theme.palette.divider}`,\n        }}\n      >\n        <Grid item xs=\"auto\" container flexDirection=\"column\">\n\n          <Grid item xs container>\n            <Grid item xs=\"auto\">\n              信用卡號末四碼 :&nbsp;\n            </Grid>\n            <Grid item xs className=\"bold\">\n              {creditCardInfo.cardNo ? creditCardInfo.cardNo.replaceAll(' ', '').slice(-4) : '- - - -'}\n            </Grid>\n          </Grid>\n\n          <Grid item xs container>\n            <Grid item xs=\"auto\">\n              授權碼 :&nbsp;\n            </Grid>\n            <Grid item xs className=\"bold\">\n              {creditCardInfo.approvalCode || '- - - -'}\n            </Grid>\n          </Grid>\n\n        </Grid>\n\n        <Grid item xs=\"auto\">\n          <Box className=\"received-list\" display=\"inline-flex\" sx={{\n            '& > div': {\n              pr: '1rem',\n            },\n            '& .main-value': {\n              fontWeight: 'bold',\n            },\n          }}>\n            {renderPayment((order.salesPayments || []))}\n          </Box>\n\n          <Box className=\"total-sum\" display=\"inline-flex\" sx={{\n            fontSize: '1.25rem',\n          }}>\n            <span>總金額 :&nbsp;</span>\n            <span className=\"bold\">\n              {`${order ? order.actualTotal : '- - -'}元`}\n            </span>\n          </Box>\n        </Grid>\n      </Grid>\n\n    </Paper>\n  )\n}\n\nexport const orderTableStyle = {\n  '& .table-header': {\n    display: 'flex',\n    color: 'background.paper',\n    backgroundColor: '#a4a4a4',\n    '& > div': {\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      textAlign: 'center',\n      padding: '0.25em 0.5em',\n      wordBreak: 'break-all',\n      borderRight: theme => `1px solid ${theme.palette.background.paper}`,\n    },\n    '& > div:last-child': {\n      borderRight: 'none',\n    },\n    '& .name-sec': {\n      justifyContent: 'flex-start',\n      paddingLeft: '1.5em',\n      paddingRight: '1.5em',\n    },\n  },\n  '& .table-item': {\n    display: 'flex',\n    color: 'text.primary',\n    backgroundColor: 'background.darkPaper',\n    '&:nth-of-type(2n)': {\n      backgroundColor: 'background.paper',\n    },\n    '& > div': {\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      textAlign: 'center',\n      padding: '0.5em 0.5em',\n      wordBreak: 'break-all',\n      borderRight: theme => `1px solid ${theme.palette.background.paper}`,\n    },\n    '& > div:last-of-type': {\n      borderRight: 'none',\n    },\n    '& .name-sec': {\n      justifyContent: 'flex-start',\n      paddingLeft: '1.5em',\n      paddingRight: '1.5em',\n    },\n  },\n  '& .serial-sec': {\n    flex: '0 0 5%',\n    minWidth: '2rem',\n  },\n  '& .name-sec': {\n    flex: '1 0 auto',\n  },\n  '& .clerk-sec': {\n    flex: '0 0 10%'\n  },\n  '& .price-sec': {\n    flex: '0 0 10%'\n  },\n  '& .quantity-sec': {\n    flex: '0 0 10%'\n  },\n  '& .discount-sec': {\n    flex: '0 0 10%'\n  },\n  '& .total-sec': {\n    flex: '0 0 10%'\n  },\n}\n\n\nexport default PrintedOrder","import React from 'react'\nimport { Grid, Typography, Card, Checkbox } from '@mui/material'\n\nfunction SalePointCard({\n  salePoint,\n  selectedSalePoints,\n  handleSelectSalePoint,\n}) {\n  return (\n    <Card onClick={() => handleSelectSalePoint(salePoint)}>\n      <Grid container wrap=\"nowrap\" spacing={2}>\n        <Grid item container xs=\"auto\" alignItems=\"center\">\n          <Checkbox\n            readOnly\n            checked={selectedSalePoints.some(el => el.id === salePoint.id)}\n          />\n        </Grid>\n        <Grid item container xs alignItems=\"center\" zeroMinWidth>\n          <Typography className='salePoint-name' variant=\"subtitle1\" noWrap title={salePoint.salePointName}>\n            {salePoint.salePointName}\n          </Typography>\n\n          {/* <Typography className='salePoint-id' variant=\"body2\" noWrap>\n            {salePoint.stockId}\n          </Typography> */}\n        </Grid>\n      </Grid>\n    </Card>\n  )\n}\n\nexport default SalePointCard","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport CancelIcon from '@mui/icons-material/Cancel'\nimport SendIcon from '@mui/icons-material/Send'\nimport { Box, Button, Paper, Grid, Divider, Dialog, DialogContent, IconButton, Typography } from '@mui/material'\nimport SalePointCard from './SalePointCard'\nimport { salePointRequest } from '../../apis'\n\nfunction DialogSalePoint({\n  auth,\n  open,\n  handleClose,\n  onSalePointSelectClick,\n}) {\n  const [salePoints, setSalePoints] = useState([])\n  const [selectedSalePoints, setSelectedSalePoints] = useState([])\n\n  useEffect(() => {\n    const fetchSalePoints = async () => {\n      const { data } = await salePointRequest.get('', {\n        headers: { 'Authorization': 'Bearer ' + auth.authenticated },\n      })\n      setSalePoints(data)\n    }\n    fetchSalePoints()\n\n    return () => {\n      setSalePoints([])\n    }\n  }, [auth.authenticated])\n\n\n  const handleSelectSalePoint = salePoint => {\n    const newSelectedSalePoints = selectedSalePoints.some(el => el.id === salePoint.id)\n      ? selectedSalePoints.filter(el => el.id !== salePoint.id)\n      : [...selectedSalePoints, salePoint]\n    setSelectedSalePoints(newSelectedSalePoints)\n  }\n\n  const handleSubmit = () => {\n    onSalePointSelectClick(selectedSalePoints)\n  }\n\n  const onClose = () => {\n    setSelectedSalePoints([])\n    handleClose()\n  }\n\n  const renderSalePointCards = (salePoints, colNum) => {\n    return salePoints.map(salePoint => (\n      <div className=\"card-grid\" key={salePoint.id}>\n        <SalePointCard\n          salePoint={salePoint}\n          selectedSalePoints={selectedSalePoints}\n          handleSelectSalePoint={handleSelectSalePoint}\n        />\n      </div>\n    ))\n  }\n\n  const renderSelectedSalePoints = salePoints => {\n    return salePoints.map(salePoint => (\n      <Grid item xs={12} key={salePoint.id}>\n        <Paper elevation={0} square>\n          <Typography variant=\"subtitle2\">\n            {salePoint.salePointName}\n          </Typography>\n        </Paper>\n      </Grid>\n    ))\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-member\"\n      open={open}\n      onClose={onClose}\n      fullWidth\n      maxWidth=\"sm\"\n      aria-labelledby=\"dialog-member\"\n      PaperProps={{\n        sx: { maxWidth: 800 }\n      }}\n    >\n      <Box\n        sx={{\n          margin: 0,\n          padding: '0.375em 1.75em 0.25em',\n          bgcolor: 'background.default',\n          '& h6': {\n            color: 'secondary.main',\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n          }\n        }}\n      >\n        <Typography variant=\"h6\">門市選取</Typography>\n\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: 'error.main',\n            padding: 0,\n          }}>\n            <CancelIcon sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent sx={{ padding: '0.25em 1.75em 2em', bgcolor: 'background.paper' }}>\n\n        <Grid\n          container\n          alignItems=\"flex-start\"\n          // wrap=\"nowrap\"\n          sx={{\n            mt: '1.5rem',\n            p: '0.5rem 0.25rem',\n            bgcolor: '#eeeeee',\n            borderRadius: 2,\n            '& hr': {\n              height: 'unset',\n            },\n          }}>\n          <Grid\n            xs={12}\n            md\n            item\n          >\n            <Typography variant=\"subtitle1\" sx={{\n              p: '0.25rem 0.5rem',\n              fontWeight: 'bold',\n            }}>\n              門市列表\n            </Typography>\n            <Grid\n              container\n              sx={{\n                px: '0.5rem',\n                pb: '2rem',\n                maxHeight: 400,\n                overflowY: 'auto',\n                display: 'flex',\n                gap: '1rem',\n                '& .MuiCard-root': {\n                  p: '1.5rem 1rem',\n                },\n                '& .salePoint-name': {\n                  flex: '0 0 100%',\n                },\n                '& .card-grid': {\n                  flex: '0 0 calc(50% - 0.5rem)',\n                  maxWidth: 'calc(50% - 0.5rem)',\n                  '& .MuiPaper-root': {\n                    bgcolor: 'background.default',\n                  },\n                },\n              }}\n            >\n              {renderSalePointCards(salePoints, 6)}\n            </Grid>\n          </Grid>\n\n          <Divider orientation=\"vertical\" variant=\"middle\" flexItem sx={{ mx: '1rem' }} />\n\n          <Grid\n            xs={12}\n            md={3}\n            item\n          >\n            <Typography variant=\"subtitle1\" sx={{\n              p: '0.25rem 0.5rem',\n              fontWeight: 'bold',\n            }}>\n              已選取\n            </Typography>\n            <Grid\n              container\n              // spacing={1}\n              direction=\"column\"\n              wrap=\"nowrap\"\n              sx={{\n                pl: '0.25rem',\n                pr: '0.5rem',\n                maxHeight: 400,\n                overflowY: 'auto',\n                '& .MuiPaper-root': {\n                  p: '1.5rem 2rem',\n                  mb: '1rem',\n                },\n                '& .salePoint-id': {\n                  pt: '0.25rem',\n                  color: 'text.secondary',\n                },\n              }}\n            >\n              {renderSelectedSalePoints(selectedSalePoints)}\n            </Grid>\n          </Grid>\n\n        </Grid>\n\n        <Box component=\"form\" sx={formFieldStyle}>\n\n          <div className=\"submit-field\">\n            <Button\n              size=\"large\"\n              className=\"submitBtn primaryBtn\"\n              onClick={handleSubmit}\n              endIcon={<SendIcon />}\n            >\n              確認\n            </Button>\n          </div>\n        </Box>\n\n\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst formFieldStyle = {\n  display: 'flex',\n  p: '1.5em 0 0rem',\n  alignItems: 'center',\n  justifyContent: 'flex-end',\n  '& .input-field': {\n    flex: '0 0 30%',\n    color: 'secondary.main',\n    paddingRight: '0.5em',\n  },\n  '& .input-wrapper': {\n    padding: '0.375em 0',\n  },\n  '& label': {\n    fontWeight: 'bold',\n    fontSize: '1.125rem',\n  },\n  '& input': {\n    width: 'calc(100% - 4em)',\n    lineHeight: 1.25,\n    padding: '0 0.25em',\n    '&::placeholder': {\n      fontSize: '0.875rem',\n      letterSpacing: '0.04em',\n    },\n    '&.error::placeholder': {\n      color: 'error.light',\n    },\n  },\n  '& .submit-field': {\n    flex: '0 0 18%',\n    display: 'flex',\n    flexWrap: 'wrap',\n    justifyContent: 'center',\n    '& .submitBtn': {\n      flex: '0 0 100%',\n      fontWeight: 'bold',\n      fontSize: '1.125rem',\n      display: 'inline-flex',\n      justifyContent: 'center',\n      // borderRadius: '0.5em',\n      // border: 'none',\n    },\n    '& .primaryBtn': {\n      color: 'background.paper',\n      bgcolor: (theme) => theme.palette.primary.main,\n      '&:hover': {\n        bgcolor: (theme) => theme.palette.primary.light,\n      },\n    },\n  },\n}\n\nconst mapStateToProps = (state) => ({\n  auth: state.auth,\n})\n\nexport default connect(mapStateToProps)(DialogSalePoint)","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM6.5 9 10 5.5 13.5 9H11v4H9V9H6.5zm11 6L14 18.5 10.5 15H13v-4h2v4h2.5z\"\n}), 'SwapVerticalCircle');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m14 7-5 5 5 5V7z\"\n}), 'ArrowLeft');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"m10 17 5-5-5-5v10z\"\n}), 'ArrowRight');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5h-2zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4H6z\"\n}), 'PlayForWork');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z\"\n}), 'PointOfSale');\n\nexports.default = _default;","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { Box } from '@mui/material'\nimport { initialVisits, renewVisits } from '../../slices/visitsSlice'\n\nconst InfoHeader = props => {\n  const [dateString, setDateString] = useState('')\n  const [timeString, setTimeString] = useState('')\n  const { initialVisits, renewVisits, visits } = props\n\n  useEffect(() => {\n    setFormatDate()\n    const clockInterval = setInterval(() => {\n      renewVisits()\n      setFormatDate()\n      console.log('30s Passed.')\n    }, 30000)\n    return () => {\n      clearInterval(clockInterval)\n    }\n  }, [renewVisits])\n\n  useEffect(() => {\n    initialVisits()\n  }, [initialVisits])\n\n  const setFormatDate = () => {\n    const newDate = new Date()\n    const dateString = newDate.toLocaleDateString()\n    const dayString = '星期' + newDate.getDay().toLocaleString('zh-Hant-TW-u-nu-hanidec')\n\n    const originTimeString = newDate.toLocaleTimeString()\n    const slicedTimeString = originTimeString.slice(0, -3)\n    const timeString = slicedTimeString.replace('午', '午 ')\n\n    setDateString(dateString + ' ' + dayString);\n    setTimeString(timeString)\n  }\n\n  const memberActive = Object.keys(props.currentMember).length > 0 ? 'active' : ''\n\n  return (\n    <Box component=\"section\" id=\"info-header\" sx={{\n      flex: '0 1 5 %',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n      backgroundColor: 'background.darkPaper',\n      boxShadow: 'inset -10px 0px 15px -10px #aaaaaa',\n      padding: '0 2%',\n      '& .consumer-serial': {\n        display: 'inline-block',\n        fontWeight: 'bold',\n        paddingRight: '2em',\n      },\n      '& .member-name': {\n        display: 'inline-block',\n        fontWeight: 'bold',\n        color: '#c4c4c4',\n      },\n      '& .member-name.active span': {\n        color: '#91bbcb',\n        textShadow: theme => `1px 0px 1px ${theme.palette.background.default}`,\n      },\n      '& .time-field': {\n        fontSize: '0.875rem',\n        display: 'inline-block',\n        fontWeight: 'bold',\n        textAlign: 'right',\n        color: 'secondary.main',\n      },\n    }}>\n      <div>\n        <div className=\"consumer-serial\">\n          <span>客次&nbsp;:&nbsp;{visits.visitsNum}</span>\n        </div>\n        <div className={`member-name ${memberActive}`}>\n          <span>\n            會員&nbsp;:&nbsp;\n            {props.currentMember.memberName}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"time-field\">\n        <div>{dateString}</div>\n        <div>{timeString}</div>\n      </div>\n    </Box>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    currentMember: state.currentMember,\n    visits: state.visits,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { initialVisits, renewVisits }\n)(InfoHeader)\n","import React from 'react';\n\nclass Toggle extends React.Component {\n  render() {\n    return this.props.determineParam\n    ? this.props.children\n    : null\n  }\n}\n\nexport default Toggle;","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\"\n}), 'Cancel');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\"\n}), 'Restore');","import { generateUtilityClass, generateUtilityClasses } from '@mui/base';\nexport function getDialogActionsUtilityClass(slot) {\n  return generateUtilityClass('MuiDialogActions', slot);\n}\nconst dialogActionsClasses = generateUtilityClasses('MuiDialogActions', ['root', 'spacing']);\nexport default dialogActionsClasses;","import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nconst _excluded = [\"className\", \"disableSpacing\"];\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { unstable_composeClasses as composeClasses } from '@mui/base';\nimport styled from '../styles/styled';\nimport useThemeProps from '../styles/useThemeProps';\nimport { getDialogActionsUtilityClass } from './dialogActionsClasses';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nconst useUtilityClasses = ownerState => {\n  const {\n    classes,\n    disableSpacing\n  } = ownerState;\n  const slots = {\n    root: ['root', !disableSpacing && 'spacing']\n  };\n  return composeClasses(slots, getDialogActionsUtilityClass, classes);\n};\n\nconst DialogActionsRoot = styled('div', {\n  name: 'MuiDialogActions',\n  slot: 'Root',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.root, !ownerState.disableSpacing && styles.spacing];\n  }\n})(({\n  ownerState\n}) => _extends({\n  display: 'flex',\n  alignItems: 'center',\n  padding: 8,\n  justifyContent: 'flex-end',\n  flex: '0 0 auto'\n}, !ownerState.disableSpacing && {\n  '& > :not(:first-of-type)': {\n    marginLeft: 8\n  }\n}));\nconst DialogActions = /*#__PURE__*/React.forwardRef(function DialogActions(inProps, ref) {\n  const props = useThemeProps({\n    props: inProps,\n    name: 'MuiDialogActions'\n  });\n\n  const {\n    className,\n    disableSpacing = false\n  } = props,\n        other = _objectWithoutPropertiesLoose(props, _excluded);\n\n  const ownerState = _extends({}, props, {\n    disableSpacing\n  });\n\n  const classes = useUtilityClasses(ownerState);\n  return /*#__PURE__*/_jsx(DialogActionsRoot, _extends({\n    className: clsx(classes.root, className),\n    ownerState: ownerState,\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? DialogActions.propTypes\n/* remove-proptypes */\n= {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * If `true`, the actions do not have additional margin.\n   * @default false\n   */\n  disableSpacing: PropTypes.bool,\n\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object])\n} : void 0;\nexport default DialogActions;","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { replacePosStrips } from '../../../slices/posStripsSlice'\nimport { replaceCurrentMember } from '../../../slices/currentMemberSlice'\nimport { getTempOrderWithLocal, deleteTempOrderWithLocal } from '../../../slices/tempOrdersSlice'\nimport { replaceCurrentTempOrderId } from '../../../slices/currentIdsSlice'\nimport { Cancel, Restore } from '@mui/icons-material'\nimport { Box, Button, Dialog, DialogContent, DialogActions, IconButton, Typography } from '@mui/material'\n\n\nconst DialogTempOrder = props => {\n  const { open, handleClose, replacePosStrips, tempOrders, getTempOrderWithLocal, deleteTempOrderWithLocal, replaceCurrentTempOrderId, replaceCurrentMember } = props\n  // State currentTempOrderId 用於顯示細項列表\n  // Redux currentTempOrderId 用於結帳時調整訂單狀態\n  const [currentTempOrderId, setCurrentTempOrderId] = useState('')\n\n  useEffect(() => {\n    getTempOrderWithLocal()\n  }, [getTempOrderWithLocal])\n\n  useEffect(() => {\n    if (tempOrders[0]) setCurrentTempOrderId(tempOrders[0].id)\n  }, [tempOrders])\n\n  const onTempOrderClick = id => {\n    setCurrentTempOrderId(id)\n  }\n\n  const onRetrieveClick = () => {\n    replacePosStrips(currentTempOrder.content)\n    replaceCurrentMember(currentTempOrder.member || {})\n    replaceCurrentTempOrderId(currentTempOrderId)\n    handleClose()\n  }\n\n  const formatDateString = timestamp => {\n    const inputDate = new Date(timestamp);\n    const yearString = inputDate.getFullYear().toString()\n    const month = inputDate.getMonth() + 1\n    const monthString = month > 9 ? month.toString() : '0' + month.toString()\n    const date = inputDate.getDate()\n    const dateString = date > 9 ? date.toString() : '0' + date.toString()\n    const dayString = dayStrings[inputDate.getDay()]\n    const originTimeString = inputDate.toLocaleTimeString().replace('午', '午 0').slice(0, -3)\n    const timeString = originTimeString.length > 8 ? originTimeString.replace(' 01', ' 1') : originTimeString\n    return yearString + '/' + monthString + '/' + dateString + ' (' + dayString + ') ' + timeString\n  }\n\n  const currentTempOrder = tempOrders.find(tempOrder => tempOrder.id === currentTempOrderId)\n\n  const renderTempItem = tempOrders => {\n    return tempOrders.map((tempOrder, index) => {\n      const active = currentTempOrderId === tempOrder.id ? ' active' : ''\n\n      return (\n        <div className={`temp-item ${active}`} key={tempOrder.id} onClick={() => onTempOrderClick(tempOrder.id)}>\n          <div className=\"serial-sec\">{index + 1}</div>\n          <div className=\"time-sec\">{formatDateString(tempOrder.timestamp)}</div>\n          <div className=\"total-amount-sec\">{tempOrder.totalAmount}</div>\n          <div className=\"total-quantity-sec\">{tempOrder.totalQuantity}</div>\n          <div className=\"member-name-sec\">{tempOrder.member.memberName}</div>\n          <div className=\"member-phone-sec\">{tempOrder.member.phone}</div>\n          <div className=\"delete-sec\" onClick={() => deleteTempOrderWithLocal(tempOrder.id)}>\n            <Cancel className=\"delete-icon\" />\n          </div>\n        </div>\n      )\n    })\n  }\n\n  const renderDetailItem = details => {\n    return details.map((detail, index) => (\n      <div className=\"detail-item\" key={detail.id}>\n        <div className=\"serial-sec\">{index + 1}</div>\n        <div className=\"comm-name-sec\">{detail.stockName}</div>\n        <div className=\"price-sec\">{detail.price}</div>\n        <div className=\"quantity-sec\">{detail.quantity}</div>\n        <div className=\"discount-sec\">{detail.discount || ' - '}</div>\n        <div className=\"total-sec\">{detail.total}</div>\n      </div>\n    ))\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-temp-order\"\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"dialog-temp-order\"\n      fullWidth maxWidth=\"md\"\n    >\n\n      <Box sx={{\n        flex: '0 0 auto',\n        margin: 0,\n        padding: '0.375em 1.75em 0.25em',\n        lineHeight: 1.6,\n        letterSpacing: '0.0075rem',\n        bgcolor: 'background.default',\n        '& h6': {\n          color: 'secondary.main',\n          fontSize: '1.25rem',\n          fontWeight: 'bold',\n          letterSpacing: '0.05em',\n        },\n      }}>\n        <Typography variant=\"h6\">訂單暫存</Typography>\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: 'error.main',\n            padding: 0,\n          }}>\n            <Cancel sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent sx={{ padding: '0.5em 1.75em 0', bgcolor: 'background.paper', }}>\n        <Typography variant=\"h6\" sx={{\n          color: (theme) => theme.palette.primary.main,\n          fontSize: '1.25rem',\n          fontWeight: 'bold',\n          letterSpacing: '0.05em',\n        }}>暫存清單</Typography>\n        <Box sx={tempHeaderStyle}>\n          <div className=\"serial-sec\">項次</div>\n          <div className=\"time-sec\">暫存時間</div>\n          <div className=\"total-amount-sec\">總金額</div>\n          <div className=\"total-quantity-sec\">總數量</div>\n          <div className=\"member-name-sec\">會員姓名</div>\n          <div className=\"member-phone-sec\">會員電話</div>\n          <div className=\"delete-sec\"></div>\n        </Box>\n        <Box sx={tempListStyle}>\n          {renderTempItem(tempOrders)}\n        </Box>\n\n        <hr />\n        <Typography variant=\"h6\" sx={{\n          color: (theme) => theme.palette.primary.main,\n          fontSize: '1.25rem',\n          fontWeight: 'bold',\n          letterSpacing: '0.05em',\n        }}>清單明細</Typography>\n\n        <Box sx={detailHeaderStyle}>\n          <div className=\"serial-sec\">項次</div>\n          <div className=\"comm-name-sec\">商品名稱</div>\n          <div className=\"price-sec\">定價</div>\n          <div className=\"quantity-sec\">數量</div>\n          <div className=\"discount-sec\">折數</div>\n          <div className=\"total-sec\">合計</div>\n        </Box>\n\n        <Box sx={detailListStyle}>\n          {currentTempOrder ? renderDetailItem(currentTempOrder.content) : '無資料'}\n        </Box>\n      </DialogContent>\n\n      <DialogActions sx={{\n        padding: '1em 1.75em',\n        bgcolor: 'background.paper'\n      }}>\n        <Button\n          onClick={onRetrieveClick}\n          startIcon={<Restore sx={{ '&:first-of-type': { fontSize: '1.25em' } }} />}\n          sx={{\n            display: 'inline-flex',\n            justifyContent: 'center',\n            fontSize: '1.375rem',\n            fontWeight: 'bold',\n            borderRadius: '0.5em',\n            border: 'none',\n            color: 'background.paper',\n            bgcolor: (theme) => theme.palette.primary.main,\n            minWidth: 105,\n            '&:hover': {\n              bgcolor: '#fabd5e',\n            },\n          }}\n        >取回</Button>\n      </DialogActions>\n\n    </Dialog>\n  )\n}\n\nconst dayStrings = ['日', '一', '二', '三', '四', '五', '六']\n\nconst tempHeaderStyle = {\n  display: 'flex',\n  color: 'background.darkPaper',\n  bgcolor: 'secondary.main',\n  '& > div': {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    fontSize: '1rem',\n    borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    paddingTop: '0.125em',\n    paddingBottom: '0.125em',\n  },\n  '& .serial-sec': {\n    flex: '0 0 5%',\n    borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n  },\n  '& .time-sec': {\n    flex: '0 0 30%',\n  },\n  '& .total-amount-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .total-quantity-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .member-name-sec': {\n    flex: '0 0 17.5%',\n  },\n  '& .member-phone-sec': {\n    flex: '0 0 17.5%',\n  },\n  '& .delete-sec': {\n    flex: '0 0 5%',\n    borderRight: 'none',\n  }\n}\n\nconst tempListStyle = {\n  maxHeight: '8rem',\n  overflow: 'overlay',\n  '& .temp-item': {\n    display: 'flex',\n    cursor: 'pointer',\n    userSelect: 'none',\n    bgcolor: 'background.darkPaper',\n    '& > div': {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      fontSize: '1rem',\n      color: 'secondary.main',\n      height: '2em',\n      padding: '0.25em',\n      borderRight: '1px solid #f0f0f0',\n      overflow: 'overlay',\n    },\n    '&:nth-of-type(2n + 1)': {\n      bgcolor: '#e6e6e6',\n    },\n    '& .serial-sec': {\n      flex: '0 0 5%',\n      borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    },\n    '& .time-sec': {\n      flex: '0 0 30%',\n    },\n    '& .total-amount-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .total-quantity-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .member-name-sec': {\n      flex: '0 0 17.5%',\n    },\n    '& .member-phone-sec': {\n      flex: '0 0 17.5%',\n    },\n    '& .delete-sec': {\n      flex: '0 0 5%',\n      borderRight: 'none',\n    },\n    '&.active': {\n      bgcolor: 'active.main',\n    },\n    '& .delete-icon': {\n      color: '#c4c4c4',\n      fontSize: '1.125em',\n    },\n  },\n}\n\nconst detailHeaderStyle = {\n  display: 'flex',\n  color: 'background.darkPaper',\n  bgcolor: 'secondary.main',\n  '& > div': {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    fontSize: '1rem',\n    borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    paddingTop: '0.5em',\n    paddingBottom: '0.5em',\n  },\n  '& .comm-name-sec': {\n    flex: '0 0 45%',\n    paddingLeft: '0.5em',\n    paddingRight: '0.5em',\n  },\n  '& .serial-sec': {\n    flex: '0 0 5%',\n    borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n  },\n  '& .price-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .quantity-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .discount-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .total-sec': {\n    flex: '0 0 12.5%',\n    borderRight: 'none',\n  },\n}\n\nconst detailListStyle = {\n  minHeight: '10rem',\n  maxHeight: '10.5rem',\n  overflow: 'overlay',\n  '& .detail-item': {\n    display: 'flex',\n    bgcolor: 'background.darkPaper',\n    '& > div': {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      fontSize: '1rem',\n      color: 'secondary.main',\n      paddingTop: '0.5em',\n      paddingBottom: '0.5em',\n      borderRight: '1px solid #f0f0f0',\n    },\n    '&:nth-of-type(2n + 1)': {\n      bgcolor: '#e6e6e6',\n    },\n    '& .serial-sec': {\n      flex: '0 0 5%',\n      borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    },\n    '& .comm-name-sec': {\n      flex: '0 0 45%',\n      paddingLeft: '0.5em',\n      paddingRight: '0.5em',\n    },\n    '& .price-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .quantity-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .discount-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .total-sec': {\n      flex: '0 0 12.5%',\n      borderRight: 'none',\n    },\n  },\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    tempOrders: state.tempOrders\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { replacePosStrips, getTempOrderWithLocal, deleteTempOrderWithLocal, replaceCurrentTempOrderId, replaceCurrentMember }\n)(DialogTempOrder)\n","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M8 5v14l11-7z\"\n}), 'PlayArrow');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M7 8V5l-7 7 7 7v-3l-4-4 4-4zm6 1V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z\"\n}), 'ReplyAll');","import React, { useState, useEffect, useMemo, Fragment } from 'react'\nimport { connect } from 'react-redux'\nimport { useTheme, alpha } from '@mui/system'\nimport { TransitionGroup } from 'react-transition-group'\nimport { Cancel, ReplyAll, PlayArrow } from '@mui/icons-material'\nimport { Box, Button, Checkbox, Dialog, DialogContent, IconButton, Typography, Fade } from '@mui/material'\nimport { Toast } from '../../../helpers/sweetAlert'\nimport { replacePosStrips } from '../../../slices/posStripsSlice'\nimport { fetchMembers } from '../../../slices/membersSlice'\nimport { replaceCurrentMember } from '../../../slices/currentMemberSlice'\nimport { replaceCurrentExternalOrderId } from '../../../slices/currentIdsSlice'\nimport { replaceExternalOrders, replaceActiveExternalOrder, fetchExternalOrders, fetchActiveExternalOrder, addSelectedExternalOrder, removeSelectedExternalOrder, clearSelectedExternalOrders, selectAllExternalOrders } from '../../../slices/externalOrdersSlice'\nimport { getDateString } from '../../../helpers/dateParser'\n\nconst DialogInfoImport = ({\n  open,\n  members,\n  externalOrders,\n  activeExternalOrder,\n  selectedExternalOrders,\n  replacePosStrips,\n  fetchExternalOrders,\n  fetchActiveExternalOrder,\n  addSelectedExternalOrder,\n  removeSelectedExternalOrder,\n  clearSelectedExternalOrders,\n  selectAllExternalOrders,\n  replaceExternalOrders,\n  replaceActiveExternalOrder,\n  replaceCurrentExternalOrderId,\n  replaceCurrentMember,\n  fetchMembers,\n  handleClose\n}) => {\n  const theme = useTheme()\n  const [orderDate, setOrderDate] = useState('')\n  const [memberName, setMemberName] = useState('')\n  const [isSelectedAll, setIsSelectedAll] = useState(false)\n  const [activeMemberId, setActiveMemberId] = useState('')\n\n  useEffect(() => {\n    return () => {\n      replaceActiveExternalOrder({})\n    }\n  }, [replaceActiveExternalOrder])\n\n  useEffect(() => {\n    return () => {\n      clearSelectedExternalOrders()\n    }\n  }, [clearSelectedExternalOrders])\n\n  useEffect(() => {\n    fetchMembers()\n  }, [fetchMembers])\n\n  useEffect(() => {\n    if (members[0]) {\n      setActiveMemberId(members[0].id)\n      fetchExternalOrders({\n        isSales: false,\n        memberId: members[0].id,\n      })\n    } else {\n      replaceExternalOrders([])\n      replaceActiveExternalOrder({})\n    }\n  }, [members, fetchExternalOrders, replaceExternalOrders, replaceActiveExternalOrder])\n\n  useEffect(() => {\n    if (externalOrders[0]) {\n      fetchActiveExternalOrder({ id: externalOrders[0].id })\n    } else {\n      replaceActiveExternalOrder({})\n    }\n    setIsSelectedAll(false)\n    clearSelectedExternalOrders()\n  }, [externalOrders, fetchActiveExternalOrder, replaceActiveExternalOrder, clearSelectedExternalOrders])\n\n  // useEffect(() => {\n  //   activeExternalOrder.member && setActiveMemberId(activeExternalOrder.member)\n  // }, [activeExternalOrder])\n\n  const selectedOrderGroup = useMemo(() => {\n    return selectedExternalOrders.reduce((prev, current) => {\n      return current.tempSalesDetails ? [...prev, ...current.tempSalesDetails] : prev\n    }, [])\n  }, [selectedExternalOrders])\n\n\n  const onMemberNameChange = e => {\n    setMemberName(e.target.value)\n  }\n\n  const onMemberSearch = () => {\n    // 判定輸入的第二個字元是否為數字\n    const searchType = (memberName && memberName[1] !== ' ' && !Number.isNaN(Number(memberName[1])))\n      ? 'phone'\n      : 'name'\n    fetchMembers({ [searchType]: memberName })\n  }\n\n  const onMemberClick = id => {\n    setActiveMemberId(id)\n    fetchExternalOrders({\n      isSales: false,\n      memberId: id,\n    })\n  }\n\n  const onMemberKeyUp = (e, id) => {\n    if (e.code === 'Enter') {\n      onMemberClick(id)\n    }\n  }\n\n  const onDateChange = e => {\n    setOrderDate(e.target.value)\n  }\n\n  const changeDate = e => {\n    const changeType = e.currentTarget.dataset.changeType\n    orderDate && setOrderDate(getDateString(orderDate, changeType))\n  }\n\n  const onDateSearch = () => {\n    if (!orderDate) return\n    if (!activeMemberId) {\n      return Toast.fire({\n        title: '提醒: 未選擇會員',\n        target: document.querySelector('.MuiDialog-root')\n      })\n    }\n\n    fetchExternalOrders({\n      isSales: false,\n      memberId: activeMemberId,\n      ...(orderDate && {\n        startDate: orderDate,\n        endDate: orderDate,\n      })\n    })\n  }\n\n  const onOnlyDateSearch = () => {\n    if (!orderDate) return\n    fetchExternalOrders({\n      isSales: false,\n      ...(orderDate && {\n        startDate: orderDate,\n        endDate: orderDate,\n      })\n    })\n  }\n\n  const onOrderClick = id => {\n    fetchActiveExternalOrder({ id })\n  }\n\n  const onOrderKeyUp = (e, id) => {\n    if (e.code === 'Enter') {\n      onOrderClick(id)\n    }\n  }\n\n  const convertExternalOrder = (data) => {\n    return data.map(item => (\n      {\n        ...item,\n        tempSalesDetailsId: item.id,\n        stockName: item.stockName || item.stockDescription,\n        price: item.price || item.salePrice,\n        originalTotal: item.price ? (item.price * item.quantity) : (item.salePrice * item.quantity),\n        discount: ((item.price - item.salePrice) * item.quantity).toString(),\n        total: item.subTotal,\n      }\n    ))\n  }\n\n  const onRetrieveClick = () => {\n\n    if (selectedExternalOrders.length > 0) {\n      replaceCurrentMember(selectedExternalOrders[0].memberInfo || {})\n      replacePosStrips(\n        convertExternalOrder(selectedOrderGroup)\n      )\n      replaceCurrentExternalOrderId(selectedExternalOrders.map(order => order.id).join(','))\n\n    }\n    else if (Object.keys(activeExternalOrder).length > 0) {\n      replaceCurrentMember(activeExternalOrder.memberInfo || {})\n      replacePosStrips(\n        convertExternalOrder(activeExternalOrder.tempSalesDetails)\n      )\n      replaceCurrentExternalOrderId(activeExternalOrder.id)\n    }\n    else {\n      return Toast.fire({\n        title: '提醒: 無選擇的訂單',\n        target: document.querySelector('.MuiDialog-root')\n      })\n    }\n    handleClose()\n  }\n\n  const onCheckboxClick = order => e => {\n    e.target.checked\n      ? addSelectedExternalOrder(order)\n      : removeSelectedExternalOrder(order.id)\n  }\n\n  const onSelectAllClick = () => {\n    if (isSelectedAll) {\n      clearSelectedExternalOrders()\n      setIsSelectedAll(false)\n    } else {\n      selectAllExternalOrders(externalOrders)\n      setIsSelectedAll(true)\n    }\n  }\n\n\n  const renderMembers = members => {\n    return members.map((member, index) => {\n      const active = member.id === activeMemberId ? 'active' : ''\n      return (\n        <div\n          onClick={() => onMemberClick(member.id)}\n          onKeyUp={(e) => onMemberKeyUp(e, member.id)}\n          className={`table-item ${active}`}\n          key={member.id}\n          tabIndex={0}\n        >\n          <div className=\"serial-sec sec-item\">{index + 1}</div>\n          <div className=\"member-sec sec-item\">{member.memberName + ' | ' + member.phone}</div>\n        </div>\n      )\n    })\n  }\n\n  const renderOrders = orders => {\n    return orders.map((order, index) => {\n      const active = order.id === activeExternalOrder.id ? 'active' : ''\n      console.log('order.pet', order.pet)\n      console.log('order.memberInfo', order.memberInfo)\n      return (\n        <Fade key={order.id} direction=\"left\">\n          <div\n            tabIndex={0}\n            className={`table-item ${active}`}\n            onClick={() => onOrderClick(order.id)}\n            onKeyUp={(e) => onOrderKeyUp(e, order.id)}\n          >\n            <div className=\"checkbox-sec sec-item\">\n              <Checkbox\n                className=\"checkbox-color\"\n                checked={selectedExternalOrders.some(item => item.id === order.id)}\n                onChange={onCheckboxClick(order)}\n                onClick={e => e.stopPropagation()}\n                onKeyUp={e => e.stopPropagation()}\n                color=\"default\"\n                size=\"small\" />\n            </div>\n            <div className=\"serial-sec sec-item\">{index + 1}</div>\n            <div className=\"id-sec sec-item\">\n              <div>\n                <Typography variant=\"body1\" noWrap>\n                  {new Date(order.date).toLocaleDateString()}\n                </Typography>\n              </div>\n              <div>\n                <Typography variant=\"body1\" noWrap title={order.no}>\n                  {order.no}\n                </Typography>\n              </div>\n            </div>\n            {/* <div className=\"store-sec sec-item\">\n              {order.salePoint ? order.salePoint.salePointName : '-'}\n            </div> */}\n            <div className=\"member-sec sec-item\">\n              {order.memberInfo\n                ? <Fragment>\n                  <div>\n                    <Typography variant=\"body1\" noWrap>\n                      {order.memberInfo.memberName}\n                    </Typography>\n                  </div>\n                  <div>\n                    <Typography variant=\"body1\" noWrap title={order.memberInfo.phone}>\n                      {order.memberInfo.phone}\n                    </Typography>\n                  </div>\n                </Fragment>\n                : '-'\n              }\n            </div>\n            <div className=\"pet-sec sec-item\">\n              {order.pet ? order.pet.petName : '-'}\n            </div>\n            <div className=\"clerk-sec sec-item\">\n              {order.user ? order.user.realName : '-'}\n            </div>\n            <div className=\"total-sec sec-item\">{order.total}</div>\n            <div className=\"actual-total-sec sec-item bold\">{order.actualTotal}</div>\n          </div>\n\n        </Fade>\n      )\n    })\n  }\n\n\n  const renderDetails = details => {\n    return details.map((detail, index) => {\n      return (\n        <Fade key={detail.id} direction=\"left\">\n          <div className=\"table-item\" tabIndex={0}>\n            <div className=\"serial-sec sec-item\">{index + 1}</div>\n            <div className=\"comm-name-sec sec-item\">{detail.stockName || detail.stockDescription}</div>\n            <div className=\"price-sec sec-item\">{detail.price}</div>\n            <div className=\"quantity-sec sec-item\">{detail.quantity}</div>\n            <div className=\"discount-sec sec-item\">{(detail.price * detail.quantity) - detail.subTotal}</div>\n            <div className=\"total-sec sec-item\">{detail.subTotal}</div>\n          </div>\n        </Fade>\n      )\n    })\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-info-import\"\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"dialog-info-import\"\n      fullWidth\n      PaperProps={{\n        sx: { maxWidth: 1300 }\n      }}\n    >\n      <Box\n        sx={{\n          flex: '0 0 auto',\n          margin: 0,\n          padding: '0.375em 1.75em 0.25em',\n          lineHeight: 1.6,\n          letterSpacing: '0.0075rem',\n          bgcolor: 'background.default',\n          '& h6': {\n            color: 'secondary.main',\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n          }\n        }}\n      >\n        <Typography variant=\"h6\">資料匯入</Typography>\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: '#cb5c5c',\n            padding: 0,\n          }}>\n            <Cancel sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent sx={{ padding: '0.5em 1.75em 2em', bgcolor: 'background.darkPaper' }}>\n        <Box className=\"top-content\" sx={{\n          display: 'flex',\n          paddingBottom: '1.5em',\n          borderBottom: '1px solid #c4c4c4',\n          overflow: 'auto',\n        }}>\n          <Box className=\"member-field\" sx={{\n            flex: '0 0 30%',\n            minWidth: 0,\n            '& label': {\n              color: 'secondary.main',\n            },\n          }}>\n            <Typography variant=\"h6\" sx={{\n              color: (theme) => theme.palette.primary.main,\n              fontSize: '1.25rem',\n              fontWeight: 'bold',\n              letterSpacing: '0.05em',\n            }}>\n              會員搜尋\n            </Typography>\n            <label>電話/姓名&nbsp;:</label>\n            <Box\n              className=\"member-input-wrapper\"\n              component=\"form\"\n              onSubmit={e => e.preventDefault()}\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                '& .member-input': {\n                  // flex: '0 0 calc(100% - 7.5em)',\n                  flexGrow: 1,\n                  border: '0.5px solid #c4c4c4',\n                  minWidth: 0,\n                },\n                '& .submit-btn': {\n                  py: 0,\n                  px: '1rem',\n                  ml: '0.5rem',\n                  borderRadius: 1,\n                  fontSize: '1rem',\n                  bgcolor: 'primary.light',\n                  color: 'background.paper',\n                  minWidth: 'unset',\n                  '&:hover': {\n                    bgcolor: alpha(theme.palette.primary.main, 0.8),\n                  },\n                },\n              }}\n            >\n              <input\n                className=\"member-input\"\n                type=\"text\"\n                value={memberName}\n                onChange={onMemberNameChange}\n              />\n              <Button className=\"submit-btn\" onClick={onMemberSearch} type=\"submit\">搜尋</Button>\n            </Box>\n\n            <Box className=\"member-table\" sx={memberTableStyle}>\n              <div className=\"table-header\">\n                <div className=\"serial-sec sec-item\">\n                  項次\n                </div>\n                <div className=\"member-sec sec-item\">\n                  會員\n                </div>\n              </div>\n\n              <div className=\"table-list\">\n                {members.length > 0\n                  ? renderMembers(members)\n                  : (\n                    <div className=\"no-data\">無會員資料</div>\n                  )\n                }\n              </div>\n            </Box>\n          </Box>\n\n          <Box className=\"order-field\" sx={{\n            flex: '0 0 70%',\n            paddingLeft: '2em',\n            minWidth: 0,\n          }}>\n            <Box sx={{\n              display: 'inline-flex',\n              justifyContent: 'space-between',\n              width: '100%',\n            }}>\n\n              <Box className=\"info-input-container\" sx={{\n                flex: '1 0 40%',\n                '& label': {\n                  color: 'secondary.main'\n                },\n              }}>\n                <Typography variant=\"h6\" sx={{\n                  color: (theme) => theme.palette.primary.main,\n                  fontSize: '1.25rem',\n                  fontWeight: 'bold',\n                  letterSpacing: '0.05em',\n                }}>\n                  資料清單\n                </Typography>\n                <label>日期&nbsp;:</label>\n                <Box\n                  component=\"form\"\n                  onSubmit={e => e.preventDefault()}\n                  className=\"date-input-wrapper\"\n                  sx={{\n                    display: 'flex',\n                    alignItems: 'center',\n                    '& .date-input': {\n                      flexGrow: 1,\n                      border: '0.5px solid #c4c4c4',\n                      minWidth: 0,\n                      maxWidth: '15rem',\n                    },\n                    '& .submit-btn': {\n                      py: 0,\n                      px: '1rem',\n                      mr: '0.5rem',\n                      borderRadius: 1,\n                      fontSize: '1rem',\n                      bgcolor: 'primary.light',\n                      color: 'background.paper',\n                      minWidth: 'unset',\n                      '&:hover': {\n                        bgcolor: alpha(theme.palette.primary.main, 0.8),\n                      },\n                    },\n                  }}\n                >\n                  <input\n                    type=\"date\"\n                    name=\"startDate\"\n                    className=\"date-input\"\n                    value={orderDate || ''}\n                    onChange={onDateChange}\n                  />\n                  <IconButton size=\"small\" onClick={changeDate} data-change-type=\"previous\">\n                    <PlayArrow fontSize=\"small\" className=\"previous-btn\" sx={{\n                      color: '#767676',\n                      transform: 'rotateZ(180deg)',\n                      cursor: 'pointer',\n                      '&:active': {\n                        color: '#333333',\n                      },\n                    }} />\n                  </IconButton>\n\n                  <IconButton size=\"small\" onClick={changeDate} data-change-type=\"next\">\n                    <PlayArrow fontSize=\"small\" className=\"next-btn\" sx={{\n                      color: '#767676',\n                      cursor: 'pointer',\n                      '&:active': {\n                        color: '#333333',\n                      },\n                    }} />\n                  </IconButton>\n                  <Button type=\"submit\" className=\"submit-btn\" onClick={onDateSearch}>搜尋</Button>\n                  <Button type=\"submit\" className=\"submit-btn\" onClick={onOnlyDateSearch}>日期搜尋</Button>\n                </Box>\n              </Box>\n\n              <Box className=\"import-submit-container\" sx={{\n                flex: '0 0 30%',\n                display: 'flex',\n                alignItems: 'flex-end',\n                justifyContent: 'flex-end',\n              }}>\n                <Button\n                  tabIndex={1}\n                  onClick={onRetrieveClick}\n                  startIcon={\n                    <ReplyAll sx={{ '&:first-of-type': { fontSize: '1.25em', transform: 'rotateY(180deg)' } }} />\n                  }\n                  sx={{\n                    display: 'inline-flex',\n                    justifyContent: 'center',\n                    fontSize: '1.375rem',\n                    fontWeight: 'bold',\n                    borderRadius: '0.5em',\n                    border: 'none',\n                    color: 'background.paper',\n                    bgcolor: theme.palette.primary.main,\n                    minWidth: '105px',\n                    '&:hover': {\n                      bgcolor: alpha(theme.palette.primary.main, 0.8),\n                    },\n                  }}\n                >匯入</Button>\n              </Box>\n            </Box>\n\n            <Box className=\"order-table\" sx={orderTableStyle}>\n              <div className=\"table-header\">\n                <div className=\"checkbox-sec sec-item\">\n                  <Checkbox\n                    className=\"checkbox-color\"\n                    checked={isSelectedAll}\n                    onChange={onSelectAllClick}\n                    color=\"default\"\n                    size=\"small\" />\n                </div>\n                <div className=\"serial-sec sec-item\">項次</div>\n                <div className=\"id-sec sec-item\">日期 - 單號</div>\n                {/* <div className=\"store-sec sec-item\">部門</div> */}\n                <div className=\"member-sec sec-item\">會員 - 電話</div>\n                <div className=\"pet-sec sec-item\">寵物</div>\n                <div className=\"clerk-sec sec-item\">服務人員</div>\n                <div className=\"total-sec sec-item\">總和</div>\n                <div className=\"actual-total-sec sec-item bold\">總金額</div>\n              </div>\n\n              <Box className=\"table-list\">\n                {\n                  (externalOrders.length > 0)\n                    ? (\n                      <TransitionGroup>\n                        {renderOrders(externalOrders)}\n                      </TransitionGroup>\n                    )\n                    : (\n                      <Fade in={externalOrders.length <= 0} direction=\"left\">\n                        <div className=\"no-data\">無清單資料</div>\n                      </Fade>\n                    )\n                }\n\n              </Box>\n            </Box>\n          </Box>\n        </Box>\n\n        <Box className=\"bottom-content\" sx={{ paddingTop: '0.5em' }}>\n          <Typography variant=\"h6\" sx={{\n            color: theme.palette.primary.main,\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n            letterSpacing: '0.05em',\n          }}>\n            資料明細\n          </Typography>\n          <Box className=\"detail-table\" sx={detailTableStyle}>\n            <div className=\"table-header\">\n              <div className=\"serial-sec sec-item\">項次</div>\n              <div className=\"comm-name-sec sec-item\">商品名稱</div>\n              <div className=\"price-sec sec-item\">定價</div>\n              <div className=\"quantity-sec sec-item\">數量</div>\n              <div className=\"discount-sec sec-item\">折扣</div>\n              <div className=\"total-sec sec-item\">合計</div>\n            </div>\n\n            <div className=\"table-list consistent\">\n              {\n                (Object.keys(activeExternalOrder).length > 0) && activeExternalOrder.tempSalesDetails\n                  ? (\n                    <TransitionGroup>\n                      {renderDetails(activeExternalOrder.tempSalesDetails)}\n                    </TransitionGroup>\n                  )\n                  : (\n                    <Fade in={(Object.keys(activeExternalOrder).length <= 0) || !activeExternalOrder.tempSalesDetails} direction=\"left\">\n                      <div className=\"no-data\">無清單資料</div>\n                    </Fade>\n                  )\n              }\n            </div>\n          </Box>\n\n          {\n            (Object.keys(selectedExternalOrders).length > 0) && (\n              <React.Fragment>\n                <Typography variant=\"h6\" sx={{\n                  color: theme.palette.primary.main,\n                  fontSize: '1.25rem',\n                  fontWeight: 'bold',\n                  letterSpacing: '0.05em',\n                }}>\n                  已選取明細\n                </Typography>\n                <Box className=\"detail-table\" sx={detailTableStyle}>\n                  <div className=\"table-header\">\n                    <div className=\"serial-sec sec-item\">項次</div>\n                    <div className=\"comm-name-sec sec-item\">商品名稱</div>\n                    <div className=\"price-sec sec-item\">定價</div>\n                    <div className=\"quantity-sec sec-item\">數量</div>\n                    <div className=\"total-sec sec-item\">合計</div>\n                  </div>\n\n                  <div className=\"table-list\">\n                    {/* {renderDetails(selectedOrderGroup)} */}\n                    <TransitionGroup>\n                      {renderDetails(selectedOrderGroup)}\n                    </TransitionGroup>\n                  </div>\n                </Box>\n              </React.Fragment>\n            )\n          }\n        </Box>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    members: state.members,\n    externalOrders: state.externalOrders,\n    activeExternalOrder: state.activeExternalOrder,\n    selectedExternalOrders: state.selectedExternalOrders,\n  }\n}\n\nconst memberTableStyle = {\n  paddingTop: '1em',\n  '& .table-header': {\n    display: 'flex',\n    height: '2em',\n    color: 'background.paper',\n    fontSize: '1rem',\n    bgcolor: 'secondary.main',\n  },\n  '& .table-list': {\n    maxHeight: '10rem',\n    overflow: 'overlay',\n  },\n  '& .no-data': {\n    height: '10rem',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    color: 'text.disabled',\n    bgcolor: 'background.light',\n    fontSize: '1.5rem',\n    fontWeight: 'bold',\n  },\n  '& .table-item': {\n    display: 'flex',\n    color: 'secondary.main',\n    fontSize: '1rem',\n    bgcolor: 'background.light',\n    cursor: 'pointer',\n  },\n  '& .table-item:nth-of-type(2n + 1)': {\n    bgcolor: '#ebebeb',\n  },\n  '& .table-item.active': {\n    bgcolor: 'active.main',\n  },\n  '& .sec-item': {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '0.25em',\n  },\n  '& .serial-sec': {\n    flex: '0 0 20%',\n    borderRight: '1px solid #eeeeee',\n  },\n  '& .member-sec': {\n    flex: '0 0 80%',\n  },\n}\n\nconst orderTableStyle = {\n  display: 'inline-block',\n  paddingTop: '1em',\n  width: '100%',\n  '& .table-header': {\n    display: 'flex',\n    height: '2em',\n    color: 'background.paper',\n    fontSize: '1rem',\n    bgcolor: 'secondary.main',\n  },\n  '& .table-list': {\n    maxHeight: '10rem',\n    overflow: 'overlay',\n  },\n  '& .no-data': {\n    height: '10rem',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    color: 'text.disabled',\n    bgcolor: 'background.light',\n    fontSize: '1.5rem',\n    fontWeight: 'bold',\n  },\n  '& .table-item': {\n    display: 'flex',\n    height: '3.33333em',\n    color: 'secondary.main',\n    fontSize: '1rem',\n    bgcolor: 'background.light',\n    cursor: 'pointer',\n    userSelect: 'none',\n  },\n  '& .table-item:nth-of-type(2n + 1)': {\n    bgcolor: '#ebebeb',\n  },\n  '& .table-item.active': {\n    bgcolor: 'active.main',\n  },\n  '& .sec-item': {\n    py: '0.25em',\n    px: '0.5em',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    textAlign: 'center',\n    borderRight: '1px solid #eeeeee',\n    minWidth: 0,\n  },\n  '& .checkbox-sec': {\n    flex: '0 0 6%',\n  },\n  '& .serial-sec': {\n    flex: '0 0 7%',\n  },\n  '& .id-sec': {\n    flex: '1 0 16%',\n    wordBreak: 'break-all',\n    flexDirection: 'column',\n  },\n  '& .id-sec > div': {\n    width: '100%',\n  },\n  '& .member-sec': {\n    flex: '1 0 16%',\n    wordBreak: 'break-all',\n    flexDirection: 'column',\n  },\n  '& .member-sec > div': {\n    width: '100%',\n  },\n  '& .pet-sec': {\n    flex: '0 0 13%',\n  },\n  '& .clerk-sec': {\n    flex: '0 0 13%',\n  },\n  '& .total-sec': {\n    flex: '0 0 13%',\n  },\n  '& .actual-total-sec': {\n    flex: '0 0 13%',\n  },\n  '& .checkbox-color': {\n    color: '#c4c4c4'\n  }\n}\n\nconst detailTableStyle = {\n  pt: '0.25rem',\n  pb: '0.5rem',\n  '& .table-header': {\n    display: 'flex',\n    height: '2em',\n    color: 'background.paper',\n    fontSize: '1rem',\n    bgcolor: 'secondary.main',\n  },\n  '& .table-list': {\n    // minHeight: '13rem',\n    maxHeight: '11.5rem',\n    overflow: 'overlay',\n    '&.consistent': {\n      minHeight: '11.5rem',\n    },\n  },\n  '& .no-data': {\n    height: '11.5rem',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    color: 'text.disabled',\n    bgcolor: '#fffcf7',\n    fontSize: '1.5rem',\n    fontWeight: 'bold',\n  },\n  '& .table-item': {\n    display: 'flex',\n    color: 'secondary.main',\n    fontSize: '1rem',\n    bgcolor: '#ffffff',\n    userSelect: 'none',\n  },\n  '& .table-item:nth-of-type(2n + 1)': {\n    bgcolor: '#fffcf7',\n  },\n  '& .table-item.active': {\n    bgcolor: 'active.main',\n  },\n  '& .sec-item': {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: '0.5em 0',\n    borderRight: '1px solid #eeeeee',\n  },\n  '& .serial-sec': {\n    flex: '0 0 5%',\n  },\n  '& .comm-name-sec': {\n    flex: '0 0 32.5%',\n    padding: '0.5em',\n  },\n  '& .price-sec': {\n    flex: '0 0 10%',\n  },\n  '& .quantity-sec': {\n    flex: '0 0 10%',\n  },\n  '& .discount-sec': {\n    flex: '0 0 10%',\n  },\n  '& .total-sec': {\n    flex: '0 0 12.5%',\n  },\n}\n\nexport default connect(\n  mapStateToProps,\n  {\n    replacePosStrips,\n    replaceExternalOrders,\n    replaceActiveExternalOrder,\n    fetchExternalOrders,\n    fetchActiveExternalOrder,\n    addSelectedExternalOrder,\n    removeSelectedExternalOrder,\n    clearSelectedExternalOrders,\n    selectAllExternalOrders,\n    replaceCurrentExternalOrderId,\n    replaceCurrentMember,\n    fetchMembers\n  }\n)(DialogInfoImport)","import React, { useState, useEffect } from 'react'\nimport { v4 as uuidv4 } from 'uuid'\nimport { connect } from 'react-redux'\nimport { Box } from '@mui/material'\nimport { replacePosStrips } from '../../slices/posStripsSlice'\nimport { replaceCurrentMember } from '../../slices/currentMemberSlice'\nimport { addTempOrderWithLocal } from '../../slices/tempOrdersSlice'\nimport { replaceCurrentTempOrderId, replaceCurrentExternalOrderId, replaceCurrentSalesmanId } from '../../slices/currentIdsSlice'\n\nimport { Toast } from '../../helpers/sweetAlert'\nimport { userRequest } from '../../apis'\nimport Toggle from '../Toggle'\nimport DialogMember from '../ui/DialogMember'\nimport DialogTempOrder from './Dialog/DialogTempOrder'\nimport DialogInfoImport from './Dialog/DialogInfoImport'\n\nconst ControlBar = ({\n  auth,\n  setSelectedIds,\n  posStrips,\n  posStripsSum,\n  currentMember,\n  currentTempOrderId,\n  currentExternalOrderId,\n  currentSalesmanId,\n  addTempOrderWithLocal,\n  replacePosStrips,\n  replaceCurrentTempOrderId,\n  replaceCurrentMember,\n  replaceCurrentExternalOrderId,\n  replaceCurrentSalesmanId,\n}) => {\n\n  const [memberOpen, setMemberOpen] = useState(false)\n  const [tempLoadOpen, setTempLoadOpen] = useState(false)\n  const [importOpen, setImportOpen] = useState(false)\n  const [users, setUsers] = useState([])\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      const { data } = await userRequest.get('', {\n        headers: { 'Authorization': 'Bearer ' + auth.authenticated },\n        params: { limit: 'zero' },\n      })\n      setUsers(data.list)\n    }\n\n    fetchUsers()\n  }, [auth.authenticated])\n\n  const validateExternalOrder = () => {\n    if (currentExternalOrderId) {\n      Toast.fire({\n        title: '請先取消匯入',\n        target: document.querySelector('.right-platform')\n      })\n      return false\n    }\n    return true\n  }\n\n  const onTempCreateClick = () => {\n    if (!validateExternalOrder()) return\n    if (posStrips.length < 1) return Toast.fire({\n      title: '請至少有一項商品',\n      target: document.querySelector('.right-platform')\n    })\n    const newTempOrder = {\n      id: uuidv4(),\n      timestamp: Date.now(),\n      totalQuantity: posStripsSum.quantity,\n      totalAmount: posStripsSum.total,\n      member: currentMember,\n      content: posStrips,\n    }\n    addTempOrderWithLocal(newTempOrder)\n    setSelectedIds([])\n    replacePosStrips([])\n    replaceCurrentMember({})\n    replaceCurrentTempOrderId('')\n    Toast.fire({\n      icon: 'success',\n      title: '已加入暫存',\n      target: document.querySelector('.right-platform')\n    })\n  }\n\n  const onMemberClick = () => {\n    if (!validateExternalOrder()) return\n    setMemberOpen(true)\n  }\n\n  const onTempLoadClick = () => {\n    if (!validateExternalOrder()) return\n    setTempLoadOpen(true)\n  }\n\n  const onImportClick = () => {\n    if (currentTempOrderId) return Toast.fire({\n      title: '請先取消暫存',\n      target: document.querySelector('.right-platform')\n    })\n    setImportOpen(true)\n  }\n\n  const onCancelMemberClick = () => {\n    if (!validateExternalOrder()) return\n    replaceCurrentMember({})\n  }\n\n  const onCancelTempLoadClick = () => {\n    replacePosStrips([])\n    replaceCurrentMember({})\n    replaceCurrentTempOrderId('')\n  }\n\n  const onCancelImportClick = () => {\n    replacePosStrips([])\n    replaceCurrentMember({})\n    replaceCurrentExternalOrderId('')\n  }\n\n  const onSelectMemberClick = member => {\n    replaceCurrentMember(member)\n    setMemberOpen(false)\n  }\n\n  const onSalesmanChange = e => {\n    replaceCurrentSalesmanId(e.target.value)\n  }\n\n  const salesmanOptions = users.map(user => {\n    return (\n      <option key={user.userId} value={user.userId}>{user.realName}</option>\n    )\n  })\n\n\n  return (\n    <Box component=\"section\" id=\"control-bar\"\n      sx={{\n        flex: '0 0 6.125 %',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        bgcolor: 'background.paper',\n        padding: '0.5em 0 0.25em',\n        '& .salesperson-field': {\n          display: 'flex',\n          flexWrap: 'wrap',\n        },\n        '& select': {\n          fontSize: '1rem',\n          width: '5.5em',\n          height: '1.5em',\n          padding: '0 0.25em',\n          outline: 'none',\n          appearance: 'none',\n          backgroundPosition: 'right 0.25em top 50%',\n          backgroundSize: 'contain',\n          backgroundRepeat: 'no-repeat',\n          marginTop: '0.25em',\n          marginBottom: '0.25em',\n        },\n        '& select.salesperson-selector': {\n          color: 'primary.main',\n          bgcolor: 'background.paper',\n          borderRadius: '0.125rem',\n          textAlign: 'center',\n          textOverflow: 'ellipsis',\n          border: (theme) => `1px solid ${theme.palette.primary.main}`,\n        },\n        '& select.split-account-selector': {\n          color: '#626262',\n          border: '1px solid #aaaaaa',\n          borderRadius: '0.125rem',\n          backgroundImage: 'url(\"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%23aaaaaa%22%20d%3D%22M7%2010l5%205%205-5z%22%2F%3E%3C%2Fsvg%3E\")',\n        },\n        '& input': {\n          fontSize: '1rem',\n          lineHeight: 1.5,\n          textAlign: 'center',\n          verticalAlign: 'middle',\n          backgroundColor: 'transparent',\n          border: '1px solid transparent',\n          userSelect: 'none',\n          padding: '0.05em 0.5em',\n          margin: '0.25em 0',\n          transition: 'all 0.2s ease-out',\n          '&:hover': {\n            bgcolor: '#f2f2f2',\n          },\n        },\n        '& input.smooth-btn': {\n          color: '#aaaaaa',\n          border: '1px solid #aaaaaa',\n          marginRight: '0.75em',\n          borderRadius: '0.25rem',\n          '&.active': {\n            color: 'background.paper',\n            backgroundColor: '#6aa1da',\n            border: theme => `1px solid ${theme.palette.background.paper}`,\n          },\n          '&.block': {\n            color: 'background.paper',\n            backgroundColor: '#ebebeb',\n            border: theme => `1px solid ${theme.palette.background.paper}`,\n          },\n          '&:last-of-type': {\n            mr: 0,\n          },\n        },\n      }}\n    >\n      <div className=\"salesperson-field\">\n        <select className=\"salesperson-selector\" value={currentSalesmanId} onChange={onSalesmanChange}>\n          <option value=\"\" disabled>銷售員</option>\n          {salesmanOptions}\n        </select>\n        {/* <select className=\"split-account-selector\">\n          <option value=\"\">分帳</option>\n        </select> */}\n      </div>\n\n      <div>\n        {currentExternalOrderId ? (\n          <input\n            className=\"smooth-btn active\"\n            type=\"button\"\n            value=\"取消匯入\"\n            onClick={onCancelImportClick}\n          />\n        ) : (\n          <input\n            className={`smooth-btn ${currentTempOrderId ? 'block' : ''}`}\n            type=\"button\"\n            value=\"資料匯入\"\n            onClick={onImportClick}\n          />\n        )\n        }\n\n        <Toggle determineParam={importOpen}>\n          <DialogInfoImport\n            open={importOpen}\n            handleClose={() => setImportOpen(false)}\n          />\n        </Toggle>\n\n        {(Object.keys(currentMember).length > 1) ? (\n          <input\n            className={`smooth-btn ${currentExternalOrderId ? 'block' : 'active'}`}\n            type=\"button\"\n            value=\"取消會員\"\n            onClick={onCancelMemberClick}\n          />\n        ) : (\n          <input\n            className={`smooth-btn ${currentExternalOrderId ? 'block' : ''}`}\n            type=\"button\"\n            value=\"&emsp;會員&emsp;\"\n            onClick={onMemberClick}\n          />\n        )\n        }\n\n        <Toggle determineParam={memberOpen}>\n          <DialogMember\n            open={memberOpen}\n            onSelectClick={onSelectMemberClick}\n            handleClose={() => setMemberOpen(false)}\n          />\n        </Toggle>\n\n        {currentTempOrderId ? (\n          <input\n            className=\"smooth-btn active\"\n            type=\"button\"\n            value=\"取消暫存\"\n            onClick={onCancelTempLoadClick}\n          />\n        ) : (\n          <input\n            className={`smooth-btn ${currentExternalOrderId ? 'block' : ''}`}\n            type=\"button\"\n            value=\"選取暫存\"\n            onClick={onTempLoadClick}\n          />\n        )\n        }\n\n        <Toggle determineParam={tempLoadOpen}>\n          <DialogTempOrder\n            open={tempLoadOpen}\n            handleClose={() => setTempLoadOpen(false)} />\n        </Toggle>\n\n        <input\n          className={`smooth-btn ${currentExternalOrderId ? 'block' : ''}`}\n          type=\"button\"\n          value=\"加入暫存\"\n          onClick={onTempCreateClick}\n        />\n\n      </div>\n    </Box>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    auth: state.auth,\n    posStrips: state.posStrips,\n    posStripsSum: state.posStripsSum,\n    currentMember: state.currentMember,\n    currentSalesmanId: state.currentSalesmanId,\n    currentTempOrderId: state.currentTempOrderId,\n    currentExternalOrderId: state.currentExternalOrderId,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  {\n    addTempOrderWithLocal,\n    replacePosStrips,\n    replaceCurrentTempOrderId,\n    replaceCurrentMember,\n    replaceCurrentExternalOrderId,\n    replaceCurrentSalesmanId,\n  }\n)(ControlBar)","import { MULTIPLE_MODE } from '../publicVariable'\n\n// -驗證折扣字串-\nexport const verifyDiscountString = (discountString) => {\n  // const percentTest = new RegExp('^\\\\d+%$').test(discountString)\n  const percentTest = new RegExp('^%\\\\d{0,2}$').test(discountString)\n  const amountTest = new RegExp('^\\\\d*\\\\d$').test(discountString)\n  if (percentTest) return 'percentage'\n  else if (amountTest) return 'constant'\n  return ''\n}\n\n// -計算折扣額度-\nexport const convertDiscount = (comm, mode, discountString) => {\n  let discountAmount = 0\n  if (mode === 'percentage') {\n    // discountAmount = (Number(discountString.slice(0, -1)) * comm.price) / 100\n    const newDiscountString = discountString.replace('%', '.')\n    const discountNum = Number(newDiscountString)\n    if (!Number.isNaN(discountNum)) {\n      discountAmount = (1 - discountNum) * comm.price\n    }\n  }\n  if (mode === 'constant') {\n    discountAmount = Number(discountString)\n  }\n\n  return discountAmount\n}\n\n// -品項總和計算-\nexport const calcCommTotal = comm => {\n  let total = comm.price * comm.quantity\n  if (comm.discount) {\n    const discountMode = verifyDiscountString(comm.discount)\n    const discountAmount = convertDiscount(comm, discountMode, comm.discount)\n    const discountMultiple =\n      discountMode === 'percentage' || MULTIPLE_MODE === 'single'\n        ? comm.quantity\n        : 1\n    // total -= Math.ceil(discountAmount * discountMultiple)\n    total = Math.ceil(total - (discountAmount * discountMultiple))\n  }\n  return {\n    ...comm,\n    originalTotal: comm.price * comm.quantity,\n    salePrice: total / comm.quantity,\n    total,\n  }\n}","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux'\nimport { Toast } from '../../helpers/sweetAlert'\nimport { useTheme, alpha } from '@mui/system'\nimport { Checkbox, SvgIcon, Box, Typography } from '@mui/material'\nimport CancelIcon from '@mui/icons-material/Cancel'\nimport { replacePosStripsSum } from '../../slices/posStripsSumSlice'\nimport { replacePosStrips, deletePosStrip } from '../../slices/posStripsSlice'\nimport { verifyDiscountString, convertDiscount, calcCommTotal } from '../../helpers/discountCalc'\n\nconst CommStripList = (props) => {\n  const {\n    posStrips,\n    setUniformContent,\n    setKeyboardMode,\n    activeCommId,\n    setActiveCommId,\n    selectedIds,\n    setSelectedIds,\n    posStripsSum,\n    replacePosStripsSum,\n  } = props\n\n  const theme = useTheme()\n  const [isSelectedAll, setIsSelectedAll] = useState(false)\n\n  // -每次條目更動時，更新總數量及總金額-\n  useEffect(() => {\n    let primitiveTotal = 0\n    let quantity = 0\n    let total = 0\n    posStrips.forEach((strip) => {\n      primitiveTotal += strip.originalTotal\n      quantity += strip.quantity\n      total += strip.total\n    })\n    replacePosStripsSum({\n      primitiveTotal,\n      quantity,\n      total,\n    })\n  }, [posStrips, replacePosStripsSum]);\n\n  const onSelectAllClick = () => {\n    if (isSelectedAll) {\n      setSelectedIds([])\n      setIsSelectedAll(false)\n    } else {\n      const allStripsId = posStrips.map(strip => strip.id)\n      setSelectedIds(allStripsId)\n      setIsSelectedAll(true)\n    }\n  }\n\n  const onCommClick = (id) => {\n    setActiveCommId(id)\n    setUniformContent('')\n  }\n\n  const onInputClick = (e) => {\n    setUniformContent('')\n    setKeyboardMode(e.target.dataset.keyboardMode)\n  }\n\n  const onCommCheckboxClick = (e, itemId) => {\n    e.target.checked\n      ? setSelectedIds([...selectedIds, itemId])\n      : setSelectedIds(\n        selectedIds.filter((selectedId) => selectedId !== itemId)\n      )\n    setUniformContent('')\n  }\n\n  const onClearClick = () => {\n    setSelectedIds([])\n    setActiveCommId('')\n    setUniformContent('')\n  }\n\n  const handleInputChange = (e, itemId, isNumber) => {\n    const processedComms = posStrips.map((strip) => {\n      return strip.id === itemId\n        ? calcCommTotal({\n          ...strip,\n          [e.target.name]: isNumber ? Number(e.target.value) : e.target.value,\n        })\n        : strip\n    })\n    props.replacePosStrips(processedComms)\n  }\n\n  const onQuantityChange = (e, itemId) => {\n    if (Number(e.target.value) < 1) return\n    handleInputChange(e, itemId, true)\n  }\n\n  const onDiscountChange = (e, item) => {\n    if (item.undiscountable)\n      return Toast.fire({\n        title: '警告: 此為不可折扣的商品',\n        target: document.querySelector('.right-platform'),\n      })\n    const discountMode = verifyDiscountString(e.target.value)\n    if (!discountMode && e.target.value !== '') return\n    const discountAmount = convertDiscount(item, discountMode, e.target.value)\n    if (item.price * item.quantity >= discountAmount) {\n      handleInputChange(e, item.id)\n    } else {\n      Toast.fire({\n        title: '警告: 折扣額度大於商品價格',\n        target: document.querySelector('.right-platform'),\n      })\n    }\n  }\n\n  const renderedStrips = (strips) => {\n    return strips.map((strip, index) => {\n      const active = strip.id === activeCommId ? 'active' : '';\n      return (\n        <div\n          className={`strip-item ${active}`}\n          onClick={() => onCommClick(strip.id)}\n          key={strip.id}\n        >\n          <div className=\"checkbox-sec\">\n            <Checkbox\n              color=\"default\"\n              size=\"small\"\n              checked={selectedIds.includes(strip.id)}\n              onChange={(e) => onCommCheckboxClick(e, strip.id)}\n            />\n          </div>\n          <div className=\"serial-sec\">{index + 1}</div>\n          <div className=\"name-sec\">\n            <div>\n              <Typography>\n                {strip.stockName}\n                {strip.undiscountable ? <UndiscountIcon /> : null}\n              </Typography>\n            </div>\n            <div>\n              <Typography className=\"sub\" variant=\"body2\">\n                商品編號 : {strip.stockId}\n              </Typography>\n            </div>\n          </div>\n          <div className=\"price-sec\">{strip.price}</div>\n          <div className=\"quantity-sec\">\n            <input\n              className=\"strip-input\"\n              type=\"number\"\n              name=\"quantity\"\n              data-keyboard-mode=\"quantityMode\"\n              value={strip.quantity}\n              onClick={onInputClick}\n              onChange={(e) => onQuantityChange(e, strip.id)}\n            />\n          </div>\n          <div className=\"discount-sec\">\n            <input\n              className=\"strip-input\"\n              type=\"text\"\n              name=\"discount\"\n              data-keyboard-mode=\"discountMode\"\n              value={strip.discount}\n              onClick={onInputClick}\n              onChange={(e) => onDiscountChange(e, strip)}\n              autoComplete=\"off\"\n            />\n          </div>\n          <div className=\"total-sec\">{strip.total}</div>\n          <div className=\"delete-sec\">\n            <CancelIcon onClick={() => props.deletePosStrip(strip.id)} />\n          </div>\n        </div>\n      )\n    })\n  }\n\n  return (\n    <Box component=\"section\" id=\"comm-strip-list\" sx={{\n      flex: '0 0 43.875%',\n      display: 'flex',\n      flexDirection: 'column',\n      backgroundColor: 'background.darkPaper',\n      minHeight: '1px',\n      '& .MuiCheckbox-root': {\n        color: theme.palette.primary.main,\n      },\n      '& .Mui-checked': {\n        color: theme.palette.primary.main,\n      },\n    }}>\n      {/* Header */}\n      <Box className=\"strip-header\" sx={styles.stripHeader}>\n        <div className=\"checkbox-sec\">\n          <Checkbox\n            name=\"select-all\"\n            color=\"default\"\n            size=\"small\"\n            checked={isSelectedAll}\n            onChange={onSelectAllClick}\n            inputProps={{\n              'aria-label': 'select-all-strips',\n            }}\n          />\n        </div>\n        <div className=\"serial-sec\">項次</div>\n        <div className=\"name-sec\">商品名稱</div>\n        <div className=\"price-sec\">定價</div>\n        <div className=\"quantity-sec\">數量</div>\n        <div className=\"discount-sec\">折數</div>\n        <div className=\"total-sec\">合計</div>\n        <div className=\"delete-sec\"></div>\n      </Box>\n\n      {/* List */}\n      <Box className=\"strip-list\" ref={props.listRef} sx={styles.stripList}>\n        {renderedStrips(posStrips)}\n      </Box>\n\n      {/* Footer */}\n      <Box className=\"strip-footer\" sx={{\n        flex: '0 0 2.25em',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        fontWeight: 'bold',\n        fontSize: '1.125rem',\n        color: 'background.paper',\n        bgcolor: 'primary.main',\n        padding: '0 1em',\n        '& .clear-selected-btn': {\n          fontSize: '0.95rem',\n          lineHeight: 1.5,\n          textAlign: 'center',\n          verticalAlign: 'middle',\n          bgcolor: alpha(theme.palette.text.secondary, 0.05),\n          padding: '0.125em 0.75em',\n          userSelect: 'none',\n          color: 'background.darkPaper',\n          border: theme => `1px solid ${theme.palette.background.darkPaper}`,\n          transition: 'all 0.2s ease-out',\n          '&:hover': {\n            bgcolor: 'primary.main',\n          },\n        },\n        '& .total-wrapper': {\n          display: 'flex',\n          '& svg': {\n            width: '0.75em',\n            height: '0.75em',\n          },\n        },\n        '& .total-sum': {\n          display: 'inline-flex',\n          alignItems: 'center',\n          padding: '0 0.75em',\n        },\n        '& .quantity-sum': {\n          display: 'inline-flex',\n          alignItems: 'center',\n          padding: '0 0.75em',\n          '& span': {\n            paddingLeft: '0.25em',\n          },\n        },\n      }}>\n        <input\n          className=\"clear-selected-btn\"\n          type=\"button\"\n          value=\"清除選取\"\n          onClick={onClearClick}\n        />\n\n        <div className=\"total-wrapper\">\n          <div className=\"quantity-sum\">\n            <LabelsIcon />\n            <span>\n              總數量&nbsp;:&nbsp;\n              {posStripsSum.quantity}\n            </span>\n          </div>\n\n          <div className=\"total-sum\">\n            <MoneyIcon />\n            <span>\n              總金額&nbsp;:&nbsp;\n              {posStripsSum.total}\n              元\n            </span>\n          </div>\n        </div>\n      </Box>\n    </Box>\n  )\n}\n\nconst LabelsIcon = () => {\n  return (\n    <SvgIcon viewBox=\"0 0 22 19\">\n      <path\n        d=\"M0.78125 4.02008H21.0938C21.5252 4.02008 21.875 3.70175 21.875 3.30902V1.53137C21.875 1.13864 21.5252 0.820312 21.0938 0.820312H0.78125C0.349756 0.820312 0 1.13864 0 1.53137V3.30902C0 3.70175 0.349756 4.02008 0.78125 4.02008ZM0.78125 11.1307H21.0938C21.5252 11.1307 21.875 10.8123 21.875 10.4196V8.64197C21.875 8.24924 21.5252 7.93091 21.0938 7.93091H0.78125C0.349756 7.93091 0 8.24924 0 8.64197V10.4196C0 10.8123 0.349756 11.1307 0.78125 11.1307ZM0.78125 18.2413H21.0938C21.5252 18.2413 21.875 17.9229 21.875 17.5302V15.7526C21.875 15.3598 21.5252 15.0415 21.0938 15.0415H0.78125C0.349756 15.0415 0 15.3598 0 15.7526V17.5302C0 17.9229 0.349756 18.2413 0.78125 18.2413Z\"\n        fill=\"#FAFAFA\"\n      />\n    </SvgIcon>\n  );\n};\n\nconst MoneyIcon = () => {\n  return (\n    <SvgIcon viewBox=\"0 0 15 23\">\n      <path\n        d=\"M10.2131 10.3726L4.93964 8.96824C4.32929 8.80825 3.90448 8.28829 3.90448 7.71055C3.90448 6.98616 4.54901 6.39954 5.34491 6.39954H8.58222C9.17793 6.39954 9.76387 6.56397 10.2521 6.86617C10.55 7.04838 10.9504 7.00394 11.2043 6.77729L12.9035 5.26628C13.2502 4.95964 13.2014 4.44857 12.8156 4.17747C11.6193 3.3242 10.1252 2.84868 8.59199 2.84424V0.71106C8.59199 0.319977 8.24043 0 7.81074 0L6.24823 0C5.81855 0 5.46698 0.319977 5.46698 0.71106V2.84424H5.34491C2.23455 2.84424 -0.265451 5.27517 0.0226352 8.15941C0.227714 10.2081 1.94647 11.8747 4.11444 12.4524L9.11933 13.7857C9.72969 13.9501 10.1545 14.4656 10.1545 15.0434C10.1545 15.7677 9.50996 16.3544 8.71406 16.3544H5.47675C4.88104 16.3544 4.29511 16.1899 3.80682 15.8877C3.50897 15.7055 3.10858 15.75 2.85467 15.9766L1.15545 17.4876C0.80877 17.7943 0.857598 18.3053 1.24334 18.5764C2.43963 19.4297 3.93378 19.9052 5.46698 19.9097V22.0428C5.46698 22.4339 5.81855 22.7539 6.24823 22.7539H7.81074C8.24043 22.7539 8.59199 22.4339 8.59199 22.0428V19.9008C10.8674 19.8608 13.0012 18.6298 13.7531 16.6699C14.8029 13.9323 13.0402 11.1236 10.2131 10.3726Z\"\n        fill=\"#FAFAFA\"\n      />\n    </SvgIcon>\n  )\n}\n\nconst UndiscountIcon = () => {\n  return (\n    <SvgIcon>\n      <path\n        d=\"M8.48629 0C13.2778 0 17 3.69819 17 8.5C17 13.5452 12.9385 17 8.48629 17C3.87641 17 0 13.2024 0 8.5C0 3.94496 3.58851 0 8.48629 0ZM1.9125 6.20706C1.65887 6.90625 1.53206 7.67056 1.53206 8.5C1.53206 12.301 4.68871 15.4371 8.51371 15.4371C12.7089 15.4371 14.5871 11.948 14.6317 11.8692L11.4304 10.4433C11.1665 11.7149 10.0183 12.2599 9.09294 12.3421V13.648H8.10585V12.3387C7.16331 12.3284 6.30302 11.9891 5.525 11.3208L6.69375 10.1383C7.78024 11.146 9.65504 11.2282 9.65504 10.0629C9.65504 9.8504 9.57964 9.67903 9.42883 9.54536C8.94214 9.33972 9.36714 9.54194 1.9125 6.20706ZM8.51371 1.51835C7.19758 1.51835 4.66129 1.81653 2.66996 4.70585L5.91915 6.1625C6.2619 5.08972 7.30383 4.69214 8.10585 4.64415V3.33831H9.09294V4.64415C9.87097 4.68528 10.5804 4.94919 11.2179 5.43246L10.1109 6.57036C8.64738 5.54556 7.24899 6.29617 7.71169 6.95081C9.54194 7.77681 9.2129 7.62944 10.8992 8.37661L15.2554 10.32C15.396 9.72359 15.4679 9.11694 15.4679 8.5C15.4679 6.54637 14.7893 4.90121 13.4355 3.56794C12.0885 2.2004 10.4468 1.51835 8.51371 1.51835Z\"\n        fill=\"#C4C4C4\"\n      />\n    </SvgIcon>\n  )\n}\n\nconst styles = {\n  stripHeader: {\n    flex: '0 0 3em',\n    display: 'flex',\n    color: 'background.darkPaper',\n    bgcolor: 'secondary.main',\n    '& > div': {\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    },\n    '& > div:last-of-type': {\n      borderRight: 'none',\n    },\n    '& > div.checkbox-sec': {\n      flex: '1 0 3.75%',\n      minWidth: '35.5px',\n    },\n    '& > div.serial-sec': {\n      flex: '0 2 7.5%',\n    },\n    '& > div.name-sec': {\n      flex: '2 1 35%',\n      flexWrap: 'wrap',\n      justifyContent: 'flex-start',\n      paddingLeft: '0.75em',\n    },\n    '& > div.price-sec': {\n      flex: '1 0 7.5%',\n    },\n    '& > div.quantity-sec': {\n      flex: '0 0 10%',\n    },\n    '& > div.discount-sec': {\n      flex: '0 0 10%',\n    },\n    '& > div.total-sec': {\n      flex: '1 0 7.5%',\n    },\n    '& > div.delete-sec': {\n      flex: '1 0 2.5%',\n    },\n  },\n  stripList: {\n    flex: '1 0 50%',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'overlay',\n    '& .strip-item': {\n      flex: '0 0 25%',\n      display: 'flex',\n      color: 'secondary.main',\n      userSelect: 'none',\n      backgroundColor: 'background.paper',\n      '@media (min-width: 1600px)': {\n        flex: '0 0 20%',\n      },\n      '&:last-of-type': {\n        boxShadow: '0px 8px 15px -14px #d3d3d3',\n      },\n      '&:nth-of-type(2n + 1)': {\n        backgroundColor: '#eeeeee',\n      },\n      '&.active': {\n        bgcolor: 'active.main',\n      },\n      '& input.strip-input': {\n        textAlign: 'left',\n        width: '3em',\n        borderRadius: '0.2em',\n        border: '0.5px solid #c4c4c4',\n        backgroundColor: 'transparent',\n        outlineColor: '#aaaaaa',\n      },\n      '& > div': {\n        fontSize: '0.9rem',\n        display: 'inline-flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        padding: '0.25em 0',\n        borderRight: '1px solid #f7f7f7',\n      },\n      '& > div:last-of-type': {\n        borderRight: 'none',\n      },\n      '& > div.checkbox-sec': {\n        flex: '1 0 3.75%',\n        minWidth: '35.5px',\n      },\n      '& > div.serial-sec': {\n        flex: '0 2 7.5%',\n      },\n      '& > div.name-sec': {\n        flex: '2 1 35%',\n        flexWrap: 'wrap',\n        justifyContent: 'flex-start',\n        paddingLeft: '0.75em',\n      },\n      '& > div.name-sec svg': {\n        width: '0.9em',\n        height: '0.9em',\n        paddingTop: '0.15em',\n        marginLeft: '0.05em',\n      },\n      '& > div.name-sec > div': {\n        flex: '0 0 100%',\n      },\n      '& > div.name-sec .MuiTypography-root': {\n        fontWeight: 'bold',\n      },\n      '& > div.name-sec .sub': {\n        color: 'text.disabled',\n      },\n      '& > div.price-sec': {\n        flex: '1 0 7.5%',\n      },\n      '& > div.quantity-sec': {\n        flex: '0 0 10%',\n      },\n      '& > div.discount-sec': {\n        flex: '0 0 10%',\n      },\n      '& > div.total-sec': {\n        flex: '1 0 7.5%',\n      },\n      '& > div.delete-sec': {\n        flex: '1 0 2.5%',\n      },\n      '& > div.delete-sec .MuiSvgIcon-root': {\n        color: '#c4c4c4',\n        fontSize: '1.125rem',\n        cursor: 'pointer',\n      },\n\n    },\n  },\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    posStrips: state.posStrips,\n    posStripsSum: state.posStripsSum,\n  }\n}\n\nexport default connect(mapStateToProps, {\n  replacePosStrips,\n  deletePosStrip,\n  replacePosStripsSum,\n})(CommStripList)\n","import { v4 as uuidv4 } from 'uuid'\n\nexport const getNewStrip = (comm, priceMapping) => {\n  const price = priceMapping\n    ? (priceMapping[comm.stockId] || comm.price)\n    : (comm.price ? comm.price.price : 0)\n\n  return {\n    id: uuidv4(),\n    stockId: comm.stockId,\n    stockName: comm.stockName || comm.description,\n    undiscountable: comm.undiscountable,\n    quantity: 1,\n    discount: '',\n    price: price,\n    total: price,\n    salePrice: price,\n    originalTotal: price,\n  }\n\n}\n\nexport const mapDetail = detail => {\n  return detail.map(item => {\n    return {\n      item: item.stockDescription || item.stockMaster.description,\n      qty: item.quantity,\n      salePrice: item.salePrice,\n      subTotal: item.subTotal,\n    }\n  })\n}\n\nexport const printReceipt = salesInfo => {\n  const invoiceHeads = salesInfo?.cashRegister?.salePoint || {}\n  const saleDetail = salesInfo?.salesDetails || []\n  const actualTotal = salesInfo?.actualTotal\n\n  window.printerBridge.printReceipt(\n    {\n      headTime: invoiceHeads.headTime,\n      invoiceHead1: invoiceHeads.invoiceHead1 || '',\n      invoiceHead2: invoiceHeads.invoiceHead2 || '',\n      invoiceHead3: invoiceHeads.invoiceHead3 || '',\n      invoiceHead4: invoiceHeads.invoiceHead4 || '',\n      invoiceHead5: invoiceHeads.invoiceHead5 || '',\n      invoiceHead6: invoiceHeads.invoiceHead6 || '',\n      salePointInvoiceName: invoiceHeads.salePointInvoiceName || '',\n    },\n    mapDetail(saleDetail),\n    actualTotal,\n  )\n}","import React, { useRef, useState, useEffect, useCallback } from 'react'\nimport { connect } from 'react-redux'\nimport { getNewStrip } from '../../helpers/checkout'\nimport { addPosStrip } from '../../slices/posStripsSlice'\nimport { fetchComms, replaceComms } from '../../slices/commsSlice'\nimport { Button, Typography, Box } from '@mui/material'\nimport { useTheme, alpha } from '@mui/system'\n\nconst SearchComm = ({\n  comms, fetchComms, replaceComms, addPosStrip, setActiveCommId, setUniformContent, listRef\n}) => {\n  const theme = useTheme()\n  const [searchContent, setSearchContent] = useState('')\n  const [activeSearchIndex, setActiveSearchIndex] = useState(0)\n  const containerRef = useRef(null)\n  const activeItemRef = useRef(null)\n  const commListRef = useRef(null)\n\n  const onSearchClick = e => {\n    e.preventDefault()\n    fetchComms(searchContent ? { name: searchContent } : {})\n    document.body.addEventListener('click', onBodyClick, { capture: true })\n  }\n\n  const onCommClick = async (comm) => {\n    if (!comm.stockId) return\n    const newStrip = getNewStrip(comm)\n    await addPosStrip(newStrip)\n    setUniformContent('')\n    setActiveCommId(newStrip.id)\n    scrollToBottom(listRef.current)\n  }\n\n  const onCommKeyUp = (e, comm) => {\n    if (e.code === 'Enter') {\n      onCommClick(comm)\n    }\n  }\n\n  const scrollToBottom = el => {\n    el.scrollTo(0, el.scrollHeight)\n  }\n\n  const onBodyClick = useCallback((e) => {\n    if (containerRef.current && containerRef.current.contains(e.target)) return\n    replaceComms([])\n    setActiveSearchIndex(0)\n    document.body.removeEventListener('click', onBodyClick, { capture: true })\n  }, [replaceComms])\n\n  useEffect(() => {\n    if (containerRef.current && Object.keys(comms).length > 0) {\n      document.body.addEventListener('click', onBodyClick, { capture: true })\n    }\n    return () => {\n      document.body.removeEventListener('click', onBodyClick, { capture: true })\n    }\n  }, [onBodyClick, comms])\n\n  const renderSearchResult = () => {\n    return comms.map((searchComm, index) => {\n      const active = index === activeSearchIndex ? 'active' : ''\n      const ref = index === activeSearchIndex ? activeItemRef : null\n      const combinedName = searchComm.description + ' - ' + searchComm.stockId\n      return (\n        <div\n          onClick={() => onCommClick(searchComm)}\n          onKeyUp={e => onCommKeyUp(e, searchComm)}\n          className={`search-item ${active}`}\n          data-id={searchComm.stockId}\n          tabIndex=\"0\"\n          key={index}\n          ref={ref}\n        >\n          <div className=\"comm-name micro-scroll\">\n            <Typography noWrap={true} variant=\"body1\" title={combinedName}>\n              {combinedName}\n            </Typography>\n          </div>\n          <small className=\"comm-price\">{searchComm.price ? searchComm.price.price : 0}</small>\n        </div>\n      )\n    })\n    // return <div className=\"search-list\" ref={commListRef}>{searchComms}</div>;\n  }\n\n  return (\n    <Box component=\"section\" id=\"search-comm\" sx={styles.root}>\n      <div className=\"search-comm-container\" ref={containerRef}>\n        <Box component=\"form\" className=\"search-bar\" sx={{\n          display: 'flex',\n          width: '100%',\n          '& .comm-input': {\n            width: 'calc(100% - 4.5rem)',\n            border: `1px solid ${theme.palette.primary.main}`,\n            paddingLeft: '0.5em',\n            outlineColor: theme.palette.primary.main,\n            '&::placeholder': {\n              color: '#c4c4c4',\n            },\n          },\n          '& .submit-btn': {\n            width: '4.5rem',\n            fontSize: '1rem',\n            borderRadius: 0,\n            padding: '0.25em 1em',\n            color: 'background.paper',\n            backgroundColor: theme.palette.primary.main,\n            '&:hover': {\n              bgcolor: alpha(theme.palette.primary.main, 0.8),\n            },\n          },\n        }}>\n          <input\n            type=\"text\"\n            className=\"comm-input\"\n            value={searchContent}\n            onChange={e => setSearchContent(e.target.value)}\n            placeholder=\"在此輸入商品名稱\"\n          />\n          <Button\n            onClick={onSearchClick}\n            className=\"submit-btn\"\n            variant=\"contained\"\n            disableElevation\n            type=\"submit\"\n          >\n            搜尋\n          </Button>\n        </Box>\n        <Box className=\"search-list\" ref={commListRef} sx={styles.searchList}>\n          {renderSearchResult()}\n        </Box>\n      </div>\n    </Box>\n  )\n}\n\nconst styles = {\n  root: {\n    flex: '0 0 50%',\n    display: 'flex',\n    alignItems: 'flex-end',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    minWidth: 0,\n    '& .search-comm-container': {\n      position: 'relative',\n      flex: '0 0 85%',\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'flex-start',\n      alignContent: 'flex-start',\n      width: '100%',\n      paddingRight: '1em',\n      minHeight: 0,\n    },\n  },\n  searchList: {\n    flexGrow: 1,\n    width: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'auto',\n    minHeight: 0,\n    '& .search-item': {\n      flex: '0 0 20%',\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'space-between',\n      cursor: 'pointer',\n      backgroundColor: 'background.light',\n      borderBottom: '1px solid #dddddd',\n      padding: '0 0.5em',\n      minHeight: 0,\n      '&:focus': {\n        zIndex: 2,\n        bgcolor: 'active.main',\n        outline: 'none',\n      },\n      '&:last-of-type': {\n        borderBottom: 'none',\n      },\n    },\n    '& .comm-name': {\n      display: 'flex',\n      fontWeight: 'bold',\n      letterSpacing: '0.04em',\n      paddingRight: '0.5em',\n      color: '#585a63',\n      overflow: 'overlay',\n      '& p': {\n        display: 'inline-block',\n      },\n      '& small': {\n        fontSize: '0.75em',\n        color: '#585a63',\n      },\n    },\n    '& .comm-price': {\n      letterSpacing: '0.02em',\n    },\n  },\n}\n\nconst mapStateToProps = state => {\n  return {\n    comms: state.comms\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { addPosStrip, fetchComms, replaceComms }\n)(SearchComm)","import React from 'react'\nimport { connect } from 'react-redux'\nimport { Box } from '@mui/material'\nimport { replacePosStrips } from '../../slices/posStripsSlice'\nimport { useTheme, alpha } from '@mui/system'\nimport { Toast } from '../../helpers/sweetAlert'\nimport { verifyDiscountString, convertDiscount, calcCommTotal } from '../../helpers/discountCalc'\n\nconst NumberPanel = ({\n  posStrips, replacePosStrips,\n  uniformContent, setUniformContent,\n  keyboardMode, setKeyboardMode,\n  activeCommId, selectedIds,\n}) => {\n  const theme = useTheme()\n\n  const onPanelItemClick = e => {\n    onUniformContentChange(uniformContent + e.target.dataset.text, keyboardMode)\n  }\n\n  const onPanelBackClick = () => {\n    if (uniformContent.length === 0) return\n    onUniformContentChange(uniformContent.slice(0, -1), keyboardMode)\n  }\n\n  const onKeyboardModeClick = e => {\n    setKeyboardMode(e.target.dataset.keyboardMode)\n    setUniformContent('')\n  }\n\n  const onUniformContentChange = (newValue, keyboardMode) => {\n    if (selectedIds.length <= 0 && !activeCommId) return Toast.fire({ title: '提醒: 請先選擇商品', target: document.querySelector('.right-platform') })\n    const isCommsChecked = (selectedIds.length > 0)\n    let newComms = []\n    switch (keyboardMode) {\n      case 'discountMode':\n        newComms = isCommsChecked ? handelDiscountUnify(newValue) : handleDiscountModify(newValue)\n        break\n      case 'quantityMode':\n        if (isIllegalQuantityStr(newValue)) return\n        setUniformContent(newValue);\n        newComms = isCommsChecked ? handleQuantityUnify(newValue) : handleQuantityModify(newValue)\n        break\n      default:\n        newComms = [...posStrips]\n    }\n    replacePosStrips(newComms)\n  };\n\n  // -勾選多筆折扣處理-\n  const handelDiscountUnify = newValue => {\n    const discountMode = verifyDiscountString(newValue);\n    if (!discountMode && newValue !== '') return posStrips\n    const newComms = []\n    let isDiscountExcess = false\n    let isContainUndiscountable = false\n    posStrips.findIndex(strip => {\n      if (selectedIds.includes(strip.id)) {\n        const discountAmount = convertDiscount(strip, discountMode, newValue)\n        if (strip.undiscountable) {\n          isContainUndiscountable = true\n          Toast.fire({\n            title: '警告: 包含無法折扣的商品',\n            target: document.querySelector('.right-platform')\n          })\n          return true\n        }\n        if ((strip.price * strip.quantity) < discountAmount) {\n          isDiscountExcess = true;\n          Toast.fire({\n            title: '警告: 折扣額度大於部分商品',\n            target: document.querySelector('.right-platform')\n          })\n          return true\n        }\n        newComms.push(calcCommTotal({ ...strip, discount: newValue }))\n        return false\n      }\n      else {\n        newComms.push(strip);\n        return false\n      }\n    })\n    if (isContainUndiscountable || isDiscountExcess) { return posStrips }\n    else {\n      setUniformContent(newValue)\n      return newComms\n    }\n  }\n\n  // -勾選單筆折扣處理-\n  const handleDiscountModify = newValue => {\n    const discountMode = verifyDiscountString(newValue)\n    if (!discountMode && newValue !== '') return posStrips\n    return posStrips.map(strip => {\n      if (strip.id === activeCommId) {\n        if (strip.undiscountable) {\n          Toast.fire({\n            title: '警告: 此為不可折扣的商品',\n            target: document.querySelector('.right-platform')\n          })\n          return strip\n        }\n        const discountAmount = convertDiscount(strip, discountMode, newValue)\n        if ((strip.price * strip.quantity) >= discountAmount) {\n          setUniformContent(newValue)\n          return calcCommTotal({ ...strip, discount: newValue })\n        }\n        else {\n          Toast.fire({\n            title: '警告: 折扣額度大於部分商品',\n            target: document.querySelector('.right-platform')\n          })\n          return strip\n        }\n      }\n      else { return strip }\n    })\n  }\n\n  // -勾選多筆數量處理-\n  const handleQuantityUnify = newValue => {\n    return posStrips.map(strip => {\n      return selectedIds.includes(strip.id)\n        ? calcCommTotal({ ...strip, quantity: Number(newValue) || 1 })\n        : strip\n    })\n  }\n\n  // -勾選單筆數量處理-\n  const handleQuantityModify = newValue => {\n    return posStrips.map(strip => {\n      return strip.id === activeCommId\n        ? calcCommTotal({ ...strip, quantity: Number(newValue) || 1 })\n        : strip\n    })\n  }\n\n  // -檢查是否為合法數字字串-\n  const isIllegalQuantityStr = inputString => {\n    return (inputString !== '' && (isNaN(inputString) || Number(inputString) <= 0))\n  }\n\n  return (\n    <Box component=\"section\" id=\"number-panel\" sx={{\n      flex: '0 0 50%',\n      display: 'flex',\n      alignItems: 'flex-end',\n      justifyContent: 'center',\n      flexDirection: 'column',\n      '& .number-panel-container': {\n        flex: '0 0 85%',\n        display: 'flex',\n        width: '100%',\n      },\n    }}>\n      <div className=\"number-panel-container\">\n\n        <Box className=\"left-panel\" sx={{\n          flex: '0 0 90%',\n          display: 'flex',\n          flexDirection: 'column',\n          borderRight: theme => `1px solid ${theme.palette.background.paper}`,\n          '& .current-input': {\n            flex: '0 0 17.5%',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n            userSelect: 'none',\n            color: '#cccccc',\n            bgcolor: theme => alpha(theme.palette.secondary.main, 0.86),\n          },\n        }}>\n          <div className=\"current-input\">\n            {uniformContent || '點擊數字面板'}\n          </div>\n          <Box className=\"panel-item-list\" sx={{\n            flex: '0 0 82.5%',\n            display: 'flex',\n            flexWrap: 'wrap',\n            '& .panel-item': {\n              flex: '0 0 25%',\n              display: 'inline-flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              fontSize: '1.25rem',\n              fontWeight: 'bold',\n              color: 'background.paper',\n              cursor: 'pointer',\n              userSelect: 'none',\n              borderRight: theme => `1px solid ${theme.palette.background.paper}`,\n              borderTop: theme => `1px solid ${theme.palette.background.paper}`,\n              bgcolor: theme => alpha(theme.palette.secondary.main, 0.86),\n              '&.orange': {\n                color: theme.palette.primary.main,\n              },\n              '&:nth-last-of-type(4n + 1)': {\n                borderRight: 'none'\n              },\n            },\n          }}>\n            <div className=\"panel-item\" data-text=\"1\" onClick={onPanelItemClick}>1</div>\n            <div className=\"panel-item\" data-text=\"2\" onClick={onPanelItemClick}>2</div>\n            <div className=\"panel-item\" data-text=\"3\" onClick={onPanelItemClick}>3</div>\n            <div className=\"panel-item orange\" data-text=\"-\" onClick={onPanelBackClick}>←</div>\n            <div className=\"panel-item\" data-text=\"4\" onClick={onPanelItemClick}>4</div>\n            <div className=\"panel-item\" data-text=\"5\" onClick={onPanelItemClick}>5</div>\n            <div className=\"panel-item\" data-text=\"6\" onClick={onPanelItemClick}>6</div>\n            <div className=\"panel-item\" data-text=\"%\" onClick={onPanelItemClick}>%</div>\n            <div className=\"panel-item\" data-text=\"7\" onClick={onPanelItemClick}>7</div>\n            <div className=\"panel-item\" data-text=\"8\" onClick={onPanelItemClick}>8</div>\n            <div className=\"panel-item\" data-text=\"9\" onClick={onPanelItemClick}>9</div>\n            <div className=\"panel-item\" data-text=\"0\" onClick={onPanelItemClick}>0</div>\n          </Box>\n        </Box>\n\n        <Box className=\"right-panel\" sx={{\n          flex: '0 0 10%',\n          display: 'flex',\n          justifyContent: 'flex-end',\n          flexDirection: 'column',\n          borderLeft: 'none',\n          '& .panel-type': {\n            flex: ' 0 0 50%',\n            display: 'flex',\n            textAlign: 'center',\n            alignItems: 'center',\n            justifyContent: 'center',\n            fontWeight: 'bold',\n            color: '#c4c4c4',\n            cursor: 'pointer',\n            userSelect: 'none',\n            border: '1px solid #c4c4c4',\n            bgcolor: 'background.paper',\n            padding: '0 0.5em',\n            '&:hover': {\n              bgcolor: alpha(theme.palette.text.secondary, 0.01),\n            },\n            '&:last-of-type': {\n              borderTop: 'none',\n            },\n            '&.active': {\n              color: 'background.paper',\n              borderColor: theme.palette.primary.main,\n              bgcolor: theme.palette.primary.main,\n              '&:hover': {\n                bgcolor: alpha(theme.palette.primary.main, 0.8)\n              },\n            },\n          },\n        }}>\n          <div\n            className={`panel-type ${keyboardMode === 'quantityMode' ? 'active' : ''}`}\n            data-keyboard-mode=\"quantityMode\"\n            onClick={onKeyboardModeClick}>\n            數量\n          </div>\n          <div\n            className={`panel-type ${keyboardMode === 'discountMode' ? 'active' : ''}`}\n            data-keyboard-mode=\"discountMode\"\n            onClick={onKeyboardModeClick}>\n            折扣\n          </div>\n        </Box>\n      </div>\n    </Box>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    posStrips: state.posStrips\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { replacePosStrips }\n)(NumberPanel)","import { useState, useEffect } from 'react'\n\nconst useBarcode = () => {\n  const [barcode, setBarcode] = useState('')\n\n  const clearBarcode = () => {\n    setBarcode('')\n  }\n\n  useEffect(() => {\n    let UPC = ''\n    let timeoutId = 0\n    const handleKeyDown = e => {\n      const textInput = e.key || String.fromCharCode(e.keyCode)\n      const targetName = e.target.localName\n\n      if (textInput && textInput.length === 1 && targetName !== 'input') {\n        if (timeoutId) { clearTimeout(timeoutId) }\n        UPC += textInput\n        timeoutId = setTimeout(() => {\n          if (UPC.length >= 8) { setBarcode(UPC) }\n          UPC = ''\n        }, 20)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyDown)\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown)\n    }\n  }, [])\n\n\n  return [barcode, clearBarcode]\n}\n\nexport default useBarcode","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"\n}), 'CheckCircle');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n}), 'Check');","import React, { useState, useEffect, useMemo, useRef } from 'react'\nimport { omit } from 'lodash-es'\nimport { alpha } from '@mui/material'\nimport { connect } from 'react-redux'\nimport { CheckCircle, Check } from '@mui/icons-material'\nimport { Box, Grid, Button, DialogContent } from '@mui/material'\nimport PrintedOrder from '../../ui/PrintedOrder'\nimport useBarcode from '../../../hooks/useBarcode'\nimport { fireDialogToast } from '../../../helpers/sweetAlert'\nimport { printReceipt } from '../../../helpers/checkout'\nimport { checkout } from '../../../slices/posStripsSumSlice'\nimport { replaceCreditCardResponse } from '../../../slices/creditCardResponseSlice'\nimport { updateReceivedAmounts, replaceReceivedAmounts } from '../../../slices/receivedAmountsSlice'\n// import { RECEIVED_METHOD_MAPPING, PAYMENT_METHOD_MAPPING } from '../../../publicVariable'\n\nconst taxIdRegex = new RegExp('^\\\\d{8}$')\nconst barCodeRegex = new RegExp('^\\\\/{1}[0-9A-Z.+-]{7}$')\nconst loveCodeRegex = new RegExp('^\\\\d{3,7}$')\nconst certificateRegex = new RegExp('^[A-Z]{2}\\\\d{14}$')\n\n\nfunction DialogCheckoutContent({\n  handleCheckoutClose,\n  isPartialClear,\n  setIsPartialClear,\n  user,\n  posStrips,\n  posStripsSum,\n  currentMember,\n  paymentMethods,\n  receivedAmounts,\n  creditCardResponse,\n  replaceCreditCardResponse,\n  updateReceivedAmounts,\n  replaceReceivedAmounts,\n  checkout,\n}) {\n  const printContentRef = useRef(null)\n  const [inputAmount, setInputAmount] = useState(0)\n  const [unreceiveAmount, setUnreceiveAmount] = useState(0)\n  const [giveChangeAmount, setGiveChangeAmount] = useState(0)\n  const [isTaxIdChecked, setIsTaxIdChecked] = useState(false)\n  const [taxId, setTaxId] = useState('')\n  const [carrierType, setCarrierType] = useState('')\n  const [invoiceCarrier, setInvoiceCarrier] = useState('')\n  const [printOrder, setPrintOrder] = useState(null)\n  const receiptMode = useMemo(() => (\n    window.localStorage.getItem(`receiptMode/${user.salePointId}`)\n  ), [user])\n\n  const [barcode, clearBarcode] = useBarcode()\n\n  useEffect(() => {\n    if (!barcode) return\n    setInvoiceCarrier(barcode)\n    distinguishCarrierType(barcode)\n    clearBarcode()\n  }, [barcode, clearBarcode])\n\n  const onCheckoutClick = async () => {\n    if (!validateCheckout()) return\n    const successData = await checkout({\n      giveChangeAmount,\n      ...(isTaxIdChecked && { taxId }),\n      ...(carrierType && { invoiceCarrier }),\n    })\n\n    if (successData) {\n      if (receiptMode === '收據機') {\n        printReceipt(successData)\n      } else if (receiptMode === '印表機') {\n        setPrintOrder(successData)\n      }\n\n      handleCheckoutClose()\n    }\n  }\n\n  useEffect(() => {\n    if (printOrder) {\n      const printContent = printContentRef.current\n      const printIframe = document.querySelector('#print-iframe')\n      printIframe.innerHTML = printContent.innerHTML\n      window.print()\n\n      printIframe.innerHTML = null\n      setPrintOrder(null)\n    }\n\n  }, [printOrder])\n\n  // 驗證可否結帳\n  const validateCheckout = () => {\n    if (unreceiveAmount > 0) {\n      fireDialogToast('提醒: 款項尚未收齊')\n      return false\n    }\n    if (taxId && !isTaxIdChecked) {\n      fireDialogToast('提醒: 統一編號不符合')\n      return false\n    }\n    if (invoiceCarrier && !carrierType) {\n      fireDialogToast('提醒: 載具號碼不符合')\n      return false\n    }\n    return true\n  }\n\n  // 計算已收金額\n  const receivedSum = useMemo(() => {\n    return Object.values(receivedAmounts).reduce((previousValue, currentValue) => (\n      previousValue + currentValue\n    ), 0)\n  }, [receivedAmounts])\n\n  // 計算找零金額與未收金額\n  useEffect(() => {\n    const newUnreceiveAmount = posStripsSum.total - receivedSum\n    if (newUnreceiveAmount > 0) {\n      setGiveChangeAmount(0)\n      setUnreceiveAmount(newUnreceiveAmount)\n    } else {\n      setGiveChangeAmount(-newUnreceiveAmount)\n      setUnreceiveAmount(0)\n    }\n  }, [posStripsSum, receivedSum])\n\n  const onInputAmountChange = e => {\n    if (Number.isNaN(Number(e.target.value))) return\n    setInputAmount(Number(e.target.value))\n  }\n\n  // 將未收金額填入[輸入欄位]\n  const onFillInClick = () => {\n    if (unreceiveAmount > 0) {\n      setInputAmount(unreceiveAmount)\n    }\n  }\n\n  // 依照模式判斷付款按鈕之功能\n  const onPaymentClick = e => {\n    if (isPartialClear) return removeReceived(e)\n    if (!inputAmount && (unreceiveAmount === 0)) return fireDialogToast('提醒: 已可結帳')\n    if (!inputAmount) return fireDialogToast('提醒: 請輸入金額')\n\n    if (e.target.dataset.name === 'cash') {\n      onCashClick(e)\n    } else if (e.target.dataset.name === 'credit') {\n      onCreditClick(e)\n    } else {\n      addReceived(e)\n    }\n  }\n\n  const onCashClick = e => {\n    // 在這裡打開**收銀機**\n\n    // 目前假定現金的 salePointPaymentId 固定為'1'\n    // 所以將 salePointPaymentId 寫定為'1'在按鈕dataset上,\n    addReceived(e)\n  }\n\n  const onCreditClick = async e => {\n    // 在這裡處理**信用卡機**\n    if (Object.keys(creditCardResponse).length > 0) {\n      fireDialogToast('提醒: 已有信用卡付款資料')\n      return\n    }\n\n    const response = await window.edcBridge.send({\n      amount: inputAmount,\n      edc: window.configBridge.getConfig()?.edc,\n    })\n\n    if (!response.success) {\n      fireDialogToast('警告: 付款失敗', 'error')\n      return\n    }\n\n    replaceCreditCardResponse(response)\n    fireDialogToast('信用卡付款成功', 'success')\n    // 以下暫用其他付款方式的紀錄已收金額\n    // 並暫時將 salePointPaymentId 寫定為'2'在按鈕dataset上,\n    // 之後改為根據卡機變更 salePointPaymentId\n    addReceived(e)\n  }\n\n  // 以[選定付款方式]付[輸入欄位]之金額\n  const addReceived = e => {\n    const receivedPaymentId = e.target.dataset.paymentId\n    // 僅允許現金有找零\n    if ((receivedPaymentId !== '1') && (inputAmount > unreceiveAmount)) return alert('輸入金額不能超過未收金額')\n\n    const initialAmount = receivedAmounts[receivedPaymentId] || 0\n    updateReceivedAmounts({ [receivedPaymentId]: initialAmount + inputAmount })\n    setInputAmount(0)\n  }\n\n  // 清除[選定付款方式]之已付金額\n  const removeReceived = e => {\n    const receivedPaymentId = e.target.dataset.paymentId\n    const targetReceiveAmount = receivedAmounts[receivedPaymentId]\n    if (!targetReceiveAmount) return\n    if (!inputAmount || (targetReceiveAmount === inputAmount)) {\n      replaceReceivedAmounts(omit(receivedAmounts, [receivedPaymentId]))\n    }\n    else if (targetReceiveAmount > inputAmount) {\n      updateReceivedAmounts({ [receivedPaymentId]: targetReceiveAmount - inputAmount })\n      setInputAmount(0)\n    }\n  }\n\n  // 發票相關輸入\n  const onTaxIdChange = e => {\n    setTaxId(e.target.value)\n    if (taxIdRegex.test(e.target.value)) {\n      setIsTaxIdChecked(true)\n    } else {\n      setIsTaxIdChecked(false)\n    }\n  }\n\n  const distinguishCarrierType = newValue => {\n    if (barCodeRegex.test(newValue)) {\n      setCarrierType('barCode')\n    } else if (loveCodeRegex.test(newValue)) {\n      setCarrierType('loveCode')\n    } else if (certificateRegex.test(newValue)) {\n      setCarrierType('certificate')\n    } else {\n      setCarrierType('')\n    }\n  }\n\n  const onInvoiceCarrierChange = e => {\n    const newValue = e.target.value\n    setInvoiceCarrier(newValue)\n    distinguishCarrierType(newValue)\n  }\n\n  // 清除所有已付金額\n  const onAllReceivedClearClick = () => {\n    replaceReceivedAmounts({})\n    replaceCreditCardResponse({})\n  }\n\n  // 付款按鈕切換成[部分清除模式]\n  const onPartialClearClick = () => {\n    setIsPartialClear(true)\n  }\n\n  // 解除[部分清除模式]模式\n  const onPartialClearCancelClick = () => {\n    setIsPartialClear(false)\n  }\n\n  // UI判斷[部分清除模式]之參數\n  const partialClearing = isPartialClear ? 'clearing' : ''\n\n  const renderReceivedList = receivedAmounts => {\n    const paymentIds = Object.keys(receivedAmounts)\n    return paymentIds.map(paymentId => {\n      return (\n        <div key={paymentId}>\n          <span>{paymentMethods[paymentId].paymentName} :</span>\n          <span>{receivedAmounts[paymentId]}</span>\n        </div>\n      )\n    })\n  }\n\n  const renderMinorPaymentBtn = paymentMethods => {\n    const minorPaymentButtons = []\n\n    Object.keys(paymentMethods).forEach(paymentId => {\n      const typeId = paymentMethods[paymentId].salePointPaymentsTypeId\n      if (typeId === '1' || typeId === '2') return\n      minorPaymentButtons.push(\n        <Button\n          key={paymentId}\n          color=\"secondary\"\n          variant=\"outlined\"\n          onClick={onPaymentClick}\n          data-payment-id={paymentId}\n        >\n          {paymentMethods[paymentId].paymentName}\n        </Button>\n      )\n    })\n\n    return minorPaymentButtons\n  }\n\n  const renderCheckoutDetail = list => {\n    return list.map((item, index) => {\n      return (\n        <div className=\"table-item\" key={index}>\n          <div className=\"serial-sec sec-item\">{index + 1}</div>\n          <div className=\"comm-name-sec sec-item\">{item.stockName}</div>\n          <div className=\"price-sec sec-item\">{item.price}</div>\n          <div className=\"quantity-sec sec-item\">{item.quantity}</div>\n          <div className=\"discount-sec sec-item\">{item.discount}</div>\n          <div className=\"total-sec sec-item\">{item.total}</div>\n        </div>\n      )\n    })\n  }\n\n\n  return (\n    <DialogContent sx={{\n      padding: '0.5em 1.75em 0',\n      backgroundColor: 'background.paper',\n    }}>\n\n      <Box\n        className=\"member-info\"\n        sx={{\n          '& > div': {\n            display: 'inline-block',\n            fontSize: '0.9rem',\n            color: 'secondary.matte',\n            paddingRight: '1em',\n          },\n          '& .content': {\n            fontWeight: 'bold',\n          },\n        }}\n      >\n        {\n          currentMember.memberName && (\n            <div>\n              <span className=\"label\">會員名稱 : </span>\n              <span className=\"content\">{currentMember.memberName || ''}</span>\n            </div>\n          )\n        }\n\n        {/* <div>\n          <span className=\"label\">點數 : </span>\n          <span className=\"content\">100000點</span>\n        </div>\n        <div>\n          <span className=\"label\">儲值金 : </span>\n          <span className=\"content\">100000元</span>\n        </div> */}\n      </Box>\n\n      <Grid container>\n        <Grid item xs={5} sx={{\n          display: 'flex',\n          flexDirection: 'column',\n        }}>\n          <Box\n            className={`received-amount-input ${partialClearing}`}\n            sx={styles.receivedAmountInput}\n          >\n            <input\n              value={inputAmount || ''}\n              onChange={onInputAmountChange}\n              placeholder=\"輸入收款金額\" />\n            <Button\n              variant=\"contained\"\n              disableElevation\n              disabled={isPartialClear || unreceiveAmount <= 0}\n              onClick={onFillInClick}\n            >\n              填入\n            </Button>\n          </Box>\n\n          <Box\n            className=\"received-amount-list\"\n            sx={styles.receivedAmountList}\n          >\n            {renderReceivedList(receivedAmounts)}\n          </Box>\n\n          {creditCardResponse.success && (\n            <Box\n              className=\"received-amount-list credit-info\"\n              sx={styles.receivedAmountList}\n            >\n              <div>\n                <span>授權碼 :</span>\n                <span>{creditCardResponse.response?.approvalNo?.replaceAll(' ', '')}</span>\n              </div>\n              <div>\n                <span>末四碼 :</span>\n                <span>{creditCardResponse.response?.cardNo?.slice(-4)}</span>\n              </div>\n            </Box>\n          )}\n\n        </Grid>\n        <Grid item xs={7} sx={{ paddingLeft: '2em' }}>\n          <Box\n            className={`main-payment-method ${partialClearing}`}\n            sx={styles.mainPaymentMethod}>\n            <Button data-payment-id=\"1\" data-name=\"cash\" onClick={onPaymentClick}>現金</Button>\n            <Button data-payment-id=\"2\" data-name=\"credit\" onClick={onPaymentClick}>信用卡</Button>\n          </Box>\n          <Box\n            className={`minor-payment-method ${partialClearing}`}\n            sx={styles.minorPaymentMethod}\n          >\n            {renderMinorPaymentBtn(paymentMethods)}\n            {/* <Button variant='outlined' color=\"secondary\" data-name=\"remittance\" onClick={onPaymentClick}>匯款</Button>\n            <Button variant='outlined' color=\"secondary\" data-name=\"discount\" onClick={onPaymentClick}>整筆折扣</Button>\n            <Button variant='outlined' color=\"secondary\" data-name=\"point\" onClick={onPaymentClick}>點數折扣</Button>\n            <Button variant='outlined' color=\"secondary\" data-name=\"stored\" onClick={onPaymentClick}>儲值金</Button> */}\n          </Box>\n        </Grid>\n      </Grid>\n\n      <Grid container>\n        <Grid item container\n          className={`payment-status ${partialClearing}`}\n          sx={styles.paymentStatus}\n        >\n          <Grid item>\n            未收金額 : <span className=\"unreceived\">\n              {unreceiveAmount}\n            </span>\n          </Grid>\n          <Grid item>\n            找零金額 : <span>{giveChangeAmount}</span>\n          </Grid>\n          <Grid item>\n            已收金額 : <span>{receivedSum}</span>\n          </Grid>\n          <Grid item>\n            應收金額 : <span>{posStripsSum.total}</span>\n          </Grid>\n        </Grid>\n        <Grid\n          item\n          className=\"checkout-btn-wrapper\"\n          sx={styles.checkoutBtnWrapper}\n        >\n          <Button\n            variant=\"contained\"\n            disableElevation\n            disabled={unreceiveAmount > 0}\n            onClick={onCheckoutClick}\n            startIcon={<CheckCircle sx={{ '&:first-of-type': { fontSize: '1.25em' } }} />}\n          >\n            結帳\n          </Button>\n        </Grid>\n\n      </Grid>\n\n      <Grid\n        container\n        className=\"invoice-info\"\n        sx={styles.invoiceInfo}\n      >\n        <div className=\"input-wrapper\">\n          <span>統一編號</span>\n          <input\n            type=\"text\"\n            value={taxId}\n            onChange={onTaxIdChange}\n          />\n          {isTaxIdChecked && <Check />}\n        </div>\n\n        <div className=\"input-wrapper\">\n          <span>載具號碼</span>\n          <input\n            type=\"text\"\n            value={invoiceCarrier}\n            onChange={onInvoiceCarrierChange}\n          />\n          {carrierType && <Check />}\n        </div>\n\n        <div className=\"input-wrapper\">\n          <span>載具類型</span>\n          <select value={carrierType} disabled >\n            <option value=\"\">- 將依載具號碼判斷 -</option>\n            <option value=\"barCode\">手機條碼</option>\n            <option value=\"loveCode\">愛心碼</option>\n            <option value=\"certificate\">自然人憑證</option>\n          </select>\n        </div>\n      </Grid>\n\n      <Box sx={{ padding: '1.5em 0' }}>\n        <Box\n          className=\"order-detail\"\n          sx={styles.orderDetail}\n        >\n          <div className=\"table-header\">\n            <div className=\"serial-sec sec-item\">項次</div>\n            <div className=\"comm-name-sec sec-item\">商品名稱</div>\n            <div className=\"price-sec sec-item\">定價</div>\n            <div className=\"quantity-sec sec-item\">數量</div>\n            <div className=\"discount-sec sec-item\">折數</div>\n            <div className=\"total-sec sec-item\">合計</div>\n          </div>\n\n          <div className='table-body'>\n            {renderCheckoutDetail(posStrips)}\n          </div>\n        </Box>\n      </Box>\n\n      <Box\n        className=\"clear-method\"\n        sx={styles.clearMethod}\n      >\n        <Button className=\"all-clear\" variant='outlined' color='error' onClick={onAllReceivedClearClick}>\n          清除付款\n        </Button>\n        {isPartialClear ? (\n          <Button className=\"partial-clear clearing\" variant='outlined' color=\"primary\"\n            onClick={onPartialClearCancelClick}\n          >\n            結束部分清除\n          </Button>\n        ) : (\n          <Button className=\"partial-clear\" variant='outlined' color=\"secondary\" onClick={onPartialClearClick}>\n            部分清除付款\n          </Button>\n        )}\n      </Box>\n\n      <Box className=\"print-content\" ref={printContentRef}\n        sx={{\n          display: 'none',\n        }}\n      >\n        {printOrder && <PrintedOrder order={printOrder} />}\n      </Box>\n    </DialogContent>\n  )\n}\n\nconst styles = {\n  receivedAmountInput: {\n    display: 'flex',\n    padding: '0.5em 0',\n    '& input': {\n      flex: '0 0 80%',\n      width: '100%',\n      lineHeight: 2,\n      textAlign: 'center',\n      fontSize: '1.25rem',\n      fontWeight: 'bold',\n      letterSpacing: '0.02em',\n      border: '1px solid #aaaaaa',\n      borderRight: 'none',\n      borderTopLeftRadius: '0.25em',\n      borderBottomLeftRadius: '0.25em',\n      color: (theme) => theme.palette.primary.main,\n      outlineColor: (theme) => theme.palette.primary.main,\n      backgroundColor: 'background.paper',\n      '&::placeholder': {\n        color: '#c4c4c4',\n      },\n    },\n    '& button': {\n      flex: '0 0 20%',\n      textAlign: 'center',\n      fontSize: '1rem',\n      fontWeight: 'bold',\n      letterSpacing: '0.025em',\n      border: (theme) => `1px solid ${theme.palette.primary.main}`,\n      borderLeft: 'none',\n      borderTopLeftRadius: 0,\n      borderBottomLeftRadius: 0,\n      color: 'background.default',\n      backgroundColor: (theme) => theme.palette.primary.main,\n      '&:hover': {\n        backgroundColor: '#fabd5e',\n      },\n      '&:disabled': {\n        borderColor: '#aaaaaa',\n      }\n    },\n  },\n  receivedAmountList: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n    alignContent: 'center',\n    fontSize: '0.95rem',\n    fontWeight: 'bold',\n    color: '#5a658e',\n    padding: '0.125em 0',\n    '& > div': {\n      display: 'inline-block',\n    },\n    '& span': {\n      paddingRight: '0.675em',\n    },\n    '&.credit-info': {\n      px: '0.5rem',\n      borderRadius: '0.25rem',\n      color: 'text.primary',\n      bgcolor: 'active.light',\n      textShadow: theme => `1px 1px 1px ${theme.palette.background.paper}`,\n    },\n  },\n  mainPaymentMethod: {\n    padding: '0.5em 0 1em',\n    '& button': {\n      fontSize: '1.125rem',\n      fontWeight: 'bold',\n      color: 'background.paper',\n      backgroundColor: 'secondary.matte',\n      width: '47.5%',\n      '&:first-of-type': {\n        marginRight: '5%',\n      },\n      '&:hover': {\n        backgroundColor: '#606c9a',\n      },\n    },\n    '&.clearing button': {\n      backgroundColor: '#f26c44',\n      '&:hover': {\n        backgroundColor: '#ff6d41',\n      },\n    },\n  },\n  minorPaymentMethod: {\n    padding: '0.25em 0 1em',\n    '& button': {\n      fontSize: '0.9rem',\n      width: '22%',\n      paddingLeft: 0,\n      paddingRight: 0,\n      marginLeft: '4%',\n      backgroundColor: '#f6f6f6',\n      letterSpacing: '0.08em',\n      '&:first-of-type': {\n        marginLeft: 0,\n      },\n      '&:hover': {\n        backgroundColor: '#f0f0f0',\n      },\n    },\n    '&.clearing button': {\n      color: '#666666',\n      borderColor: '#ffe1d9',\n      backgroundColor: '#fff1ed',\n      '&:hover': {\n        backgroundColor: '#fff6f4',\n      },\n    },\n  },\n  paymentStatus: {\n    lineHeight: 2,\n    flex: '0 0 80%',\n    maxWidth: '80%',\n    justifyContent: 'space-around',\n    borderRadius: '0.3em',\n    borderTop: '1px dashed #dddddd',\n    borderBottom: '1px dashed #dddddd',\n    backgroundColor: '#ecf4f7',\n    margin: '0.5em 0',\n    '&.clearing': {\n      backgroundColor: '#fffdf5',\n    },\n    '& span': {\n      fontSize: '1.25rem',\n      fontWeight: 'bold',\n      letterSpacing: '0.025em',\n    },\n    '& .unreceived': {\n      color: '#88a6e3',\n    },\n  },\n  checkoutBtnWrapper: {\n    flex: '0 0 20%',\n    maxWidth: '20%',\n    display: 'flex',\n    justifyContent: 'flex-end',\n    '& button': {\n      width: '90%',\n      fontWeight: 'bold',\n      fontSize: '1.5rem',\n      color: 'background.paper',\n      backgroundColor: (theme) => theme.palette.primary.main,\n      borderRadius: '0.5em',\n      '&:hover': {\n        backgroundColor: '#fabd5e',\n      },\n    },\n  },\n  invoiceInfo: {\n    padding: '1em 0',\n    justifyContent: 'space-between',\n    borderBottom: '1px solid #c4c4c4',\n    '& .input-wrapper': {\n      position: 'relative',\n      flex: '0 0 32%',\n      '& span': {\n        display: 'inline-block',\n        width: '5em',\n        color: '#3c3c3c',\n      },\n      '& input': {\n        width: 'calc(100% - 5em)',\n        border: '1px solid #aaaaaa',\n        borderRadius: '0.125em',\n        outlineColor: (theme) => theme.palette.primary.main,\n        backgroundColor: 'background.paper',\n        letterSpacing: '0.0375em',\n        padding: '0 0.375em',\n        height: '1.75em',\n      },\n      '& select': {\n        width: 'calc(100% - 5em)',\n        border: '1px solid #aaaaaa',\n        borderRadius: '0.125em',\n        backgroundColor: 'background.paper',\n        letterSpacing: '0.0375em',\n        padding: '0 0.25em',\n        height: '1.75em',\n        textAlign: 'center',\n      },\n      '& svg': {\n        fontSize: '1rem',\n        position: 'absolute',\n        right: (theme) => theme.spacing(0.5),\n        top: '50%',\n        transform: 'translate(0, -50%)',\n        color: 'rgb(119 171 63 / 50%)',\n      },\n    }\n  },\n  orderDetail: {\n    // boxShadow: '3px 4px 13px -3px #cccccc',\n    '& .table-header': {\n      display: 'flex',\n      height: '2em',\n      color: 'background.paper',\n      fontSize: '1rem',\n      backgroundColor: '#a4a4a4',\n    },\n    '& .table-body': {\n      maxHeight: '10.5rem',\n      overflow: 'auto',\n    },\n    '& .table-item': {\n      display: 'flex',\n      color: 'secondary.main',\n      fontSize: '1rem',\n      backgroundColor: '#eaeaea',\n      cursor: 'pointer',\n    },\n    '& .table-item:nth-of-type(2n + 1)': {\n      backgroundColor: 'background.light',\n    },\n    '& .sec-item': {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: '0.25em',\n      borderRight: '1px solid #eeeeee',\n      minWidth: 0,\n    },\n    '& .serial-sec': {\n      flex: '0 0 10%',\n    },\n    '& .comm-name-sec': {\n      flex: '0 0 45%',\n      padding: '0.5em',\n    },\n    '& .price-sec': {\n      flex: '0 0 10%',\n    },\n    '& .quantity-sec': {\n      flex: '0 0 10%',\n    },\n    '& .discount-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .total-sec': {\n      flex: '0 0 12.5%',\n      borderRight: 'none',\n    },\n  },\n  clearMethod: {\n    paddingBottom: '1.5em',\n    '& button': {\n      backgroundColor: '#fefefe',\n      '&:first-of-type': {\n        marginRight: '1em',\n      },\n      '&.all-clear': {\n        color: theme => alpha(theme.palette.error.light, 0.8),\n        borderColor: theme => alpha(theme.palette.error.light, 0.5),\n        bgcolor: theme => theme.palette.background.default,\n      },\n      '&.partial-clear': {\n        color: theme => alpha(theme.palette.text.primary, 0.6),\n        borderColor: theme => alpha(theme.palette.text.primary, 0.3),\n        bgcolor: theme => theme.palette.background.default,\n      },\n      '&.clearing': {\n        color: 'background.paper',\n        backgroundColor: '#666666',\n      },\n    },\n  },\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user,\n    posStrips: state.posStrips,\n    posStripsSum: state.posStripsSum,\n    paymentMethods: state.paymentMethods.content,\n    receivedAmounts: state.receivedAmounts,\n    invoiceInfo: state.invoiceInfo,\n    creditCardResponse: state.creditCardResponse,\n    currentMember: state.currentMember,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  {\n    updateReceivedAmounts,\n    replaceReceivedAmounts,\n    replaceCreditCardResponse,\n    checkout\n  }\n)(DialogCheckoutContent)\n\n","import React, { useEffect } from 'react'\nimport { Cancel } from '@mui/icons-material'\nimport { Box, Dialog, IconButton, Typography, Slide } from '@mui/material'\nimport DialogCheckoutContent from './DialogCheckoutContent'\nimport { fetchPaymentMethods } from '../../../slices/paymentMethodsSlice'\nimport { useDispatch } from 'react-redux'\n\nconst DialogCheckout = ({ open, handleCheckoutClose, handleValidateAndClose, isPartialClear, setIsPartialClear }) => {\n  const dispatch = useDispatch()\n\n  useEffect(() => {\n    dispatch(fetchPaymentMethods())\n  }, [dispatch])\n\n  return (\n    <Dialog\n      id=\"dialog-checkout\"\n      open={open}\n      TransitionComponent={Transition}\n      onClose={handleValidateAndClose}\n      aria-labelledby=\"dialog-checkout\"\n      fullWidth\n      PaperProps={{ sx: { maxWidth: 960 } }}\n      sx={{\n        '& .MuiBackdrop-root': {\n          backgroundColor: 'rgba(0, 0, 0, 0.7)',\n        }\n      }}\n    >\n      <Box className=\"dialog-title\" sx={styles.dialogTitle}>\n        <Typography variant=\"h6\">結帳畫面</Typography>\n        {handleValidateAndClose ? (\n          <IconButton aria-label=\"close\" onClick={handleValidateAndClose} sx={styles.titleCloseBtn}>\n            <Cancel sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n      <DialogCheckoutContent\n        handleCheckoutClose={handleCheckoutClose}\n        isPartialClear={isPartialClear}\n        setIsPartialClear={setIsPartialClear}\n      />\n    </Dialog>\n  )\n}\n\nconst Transition = React.forwardRef((props, ref) => {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n})\n\nconst styles = {\n  dialogTitle: {\n    flex: '0 0 auto',\n    margin: 0,\n    padding: '0.375em 1.75em 0.25em',\n    lineHeight: 1.6,\n    letterSpacing: '0.0075rem',\n    bgcolor: 'background.default',\n    '& h6': {\n      color: 'secondary.main',\n      fontSize: '1.25rem',\n      fontWeight: 'bold',\n    }\n  },\n  titleCloseBtn: {\n    position: 'absolute',\n    right: '0.5em',\n    top: '0.25em',\n    color: (theme) => theme.palette.error.main,\n    padding: 0,\n  },\n}\n\nexport default DialogCheckout","import React, { useState, Fragment } from 'react'\nimport { omit } from 'lodash-es'\nimport { getDateString } from '../../helpers/dateParser'\n\nimport Box from '@mui/material/Box'\nimport Grid from '@mui/material/Grid'\nimport Button from '@mui/material/Button'\nimport Divider from '@mui/material/Divider'\nimport Typography from '@mui/material/Typography'\n\nimport ArrowLeft from '@mui/icons-material/ArrowLeft'\nimport ArrowRight from '@mui/icons-material/ArrowRight'\n\nimport DialogMember from '../ui/DialogMember'\nimport DialogSalePoint from '../ui/DialogSalePoint'\n\nconst OrderList = ({\n  sales,\n  fetchSales,\n  currentOrderId,\n  setCurrentOrderId,\n  currentPaidOrder,\n  searchParams,\n  handleItemClick,\n}) => {\n  const [searchContent, setSearchContent] = useState({})\n  const [isMemberOpen, setIsMemberOpen] = useState(false)\n  const [isSalePointOpen, setIsSalePointOpen] = useState(false)\n\n  const handleSearch = () => {\n    fetchSales({\n      isReturn: 0,\n      ...searchParams,\n      ...omit(searchContent, ['memberName', 'salePointNames']),\n    })\n  }\n\n  const onSearchChange = e => {\n    setSearchContent({\n      ...searchContent,\n      [e.target.name]: e.target.value,\n    })\n  }\n\n  const changeDate = e => {\n    const changeType = e.currentTarget.dataset.changeType\n    const originStartValue = searchContent.startDate\n    const originEndValue = searchContent.endDate\n\n    if (!originStartValue && !originEndValue) return\n    const newSearchContent = {\n      ...searchContent,\n      ...(originStartValue && { startDate: getDateString(originStartValue, changeType) }),\n      ...(originEndValue && { endDate: getDateString(originEndValue, changeType) }),\n    }\n    setSearchContent(newSearchContent)\n  }\n\n  const onPaidOrderClick = id => {\n    (handleItemClick && handleItemClick())\n    setCurrentOrderId(id)\n    // setSelectedIds([])\n    // setIsSelectedAll(false)\n  }\n\n  const handleMemberSelect = member => {\n    setSearchContent(prev => ({\n      ...prev,\n      memberId: member.id,\n      memberName: member.memberName,\n    }))\n\n    setIsMemberOpen(false)\n  }\n\n  const handleMemberClear = () => {\n    setSearchContent(prev => omit(prev, ['memberId', 'memberName']))\n  }\n\n  const handleSalePointSelect = salePoints => {\n    const salePointIdsArrayString = salePoints.map(el => el.id).join(',')\n    const salePointNamesArrayString = salePoints.map(el => el.salePointName).join(',')\n\n    setSearchContent(prev => ({\n      ...prev,\n      salePointIds: salePointIdsArrayString,\n      salePointNames: salePointNamesArrayString,\n    }))\n    setIsSalePointOpen(false)\n  }\n\n  const handleSalePointClear = () => {\n    setSearchContent(prev => omit(prev, ['salePointIds', 'salePointNames']))\n  }\n\n  const renderOrders = orders => {\n    return orders.list && orders.list.map((order, index) => {\n      const active = currentOrderId === order.id ? ' active' : '';\n      return (\n        <div className={`order-item ${active}`} key={order.id} onClick={() => onPaidOrderClick(order.id)}>\n          <div className=\"serial-sec\">{index + 1}</div>\n          <div className=\"time-sec\">{formatDateString(order.date)}</div>\n          <div className=\"total-sec\">{order.total}</div>\n          <div className=\"actual-total-sec\">{order.actualTotal}</div>\n          <div className=\"member-name-sec\">{order.memberInfo ? order.memberInfo.memberName : ''}</div>\n          <div className=\"member-phone-sec\">{order.memberInfo ? order.memberInfo.phone : ''}</div>\n          {/* <div className=\"invoice-sec\">SR19356271</div> */}\n        </div>\n      )\n    })\n  }\n\n  const renderOrderDetail = details => {\n    return details.map((detail, index) => {\n      return (\n        <div className=\"table-item\" key={detail.id}>\n          {/* <div className=\"checkbox-sec sec-item\">\n            <Checkbox\n              className=\"checkbox-color\"\n              color=\"default\"\n              size=\"small\"\n              checked={selectedIds.includes(detail.id)}\n              onChange={(e) => onCommCheckboxClick(e, detail.id)}\n            />\n          </div> */}\n          <div className=\"serial-sec sec-item\">{index + 1}</div>\n          <div className=\"name-sec sec-item\">{detail.stockDescription || detail.stockMaster.description}</div>\n          <div className=\"price-sec sec-item\">{detail.price}</div>\n          <div className=\"quantity-sec sec-item\">{detail.quantity}</div>\n          <div className=\"discount-sec sec-item\">\n            {((detail.price * detail.quantity) - detail.subTotal)}\n          </div>\n          <div className=\"total-sec sec-item\">{detail.subTotal}</div>\n        </div>\n      )\n    })\n  }\n\n  const formatDateString = timestamp => {\n    const inputDate = new Date(timestamp);\n    const yearString = inputDate.getFullYear().toString();\n    const month = inputDate.getMonth() + 1;\n    const monthString = month > 9 ? month.toString() : '0' + month.toString();\n    const date = inputDate.getDate();\n    const dateString = date > 9 ? date.toString() : '0' + date.toString();\n    const dayString = dayStrings[inputDate.getDay()];\n    const originTimeString = inputDate.toLocaleTimeString().replace('午', '午 0').slice(0, -3);\n    const timeString = originTimeString.length > 8 ? originTimeString.replace(' 01', ' 1') : originTimeString;\n    return yearString + '/' + monthString + '/' + dateString + ' (' + dayString + ') ' + timeString;\n  }\n\n\n  return (\n    <Fragment>\n      {/* <Typography variant=\"h6\"\n        sx={{\n          color: (theme) => theme.palette.primary.main,\n          fontSize: '1.25rem',\n          fontWeight: 'bold',\n          letterSpacing: '0.05em',\n        }}\n      >\n        訂單清單\n      </Typography> */}\n\n      <Box display=\"flex\" sx={{ pb: '1.25rem', }}>\n        <Grid\n          container\n          className=\"search-field-container\"\n          sx={{\n            flexGrow: 1,\n            // flexWrap: 'nowrap',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n            fontWeight: 'bold',\n            '& label': {\n              flexShrink: 0,\n              fontSize: '1rem',\n            },\n            '& input': {\n              border: '1px solid #c4c4c4',\n              borderRadius: '0.25em',\n              display: 'inline-block',\n              minWidth: 0,\n            },\n            '& select': {\n              lineHeight: 1.75,\n              border: '1px solid #c4c4c4',\n              borderRadius: '0.25em',\n              display: 'inline-block',\n              minWidth: 0,\n            },\n            '& input.error::placeholder': {\n              color: '#cb5c5c',\n            },\n          }}\n        >\n\n          <Box sx={fieldGridStyle}>\n\n            <Box sx={btnFieldStyle}>\n              <label>會員 :</label>\n              <input type=\"text\" value={searchContent.memberName || ''} readOnly />\n              <Button\n                disableElevation\n                variant=\"contained\"\n                onClick={() => setIsMemberOpen(true)}\n              >\n                查詢\n              </Button>\n              <Button\n                variant=\"contained\"\n                disableElevation\n                onClick={handleMemberClear}\n              >\n                清除\n              </Button>\n\n              <DialogMember\n                open={isMemberOpen}\n                onSelectClick={handleMemberSelect}\n                handleClose={() => setIsMemberOpen(false)}\n              />\n            </Box>\n\n          </Box>\n\n          <Box sx={fieldGridStyle}>\n\n            <Box sx={btnFieldStyle}>\n              <label>門市 :</label>\n              <input type=\"text\" value={searchContent.salePointNames || ''} readOnly />\n              <Button\n                disableElevation\n                variant=\"contained\"\n                onClick={() => setIsSalePointOpen(true)}\n              >\n                查詢\n              </Button>\n              <Button\n                variant=\"contained\"\n                disableElevation\n                onClick={handleSalePointClear}\n              >\n                清除\n              </Button>\n\n              <DialogSalePoint\n                open={isSalePointOpen}\n                onSalePointSelectClick={handleSalePointSelect}\n                handleClose={() => setIsSalePointOpen(false)}\n              />\n            </Box>\n\n          </Box>\n\n          <Box\n            sx={{\n              flexGrow: 1,\n              maxWidth: '100%',\n              display: 'flex',\n              justifyContent: 'space-between',\n              // '@media (min-width: 960px)': {\n              //   flex: '1 0 31%',\n              //   maxWidth: '31%',\n              // },\n            }}\n          >\n            <Box\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                position: 'relative',\n                flexGrow: 1,\n                '& .date-input-wrapper': {\n                  pl: '1rem',\n                  display: 'flex',\n                  flexGrow: 1,\n                  minWidth: 0,\n                  '& input': {\n                    width: '100%',\n                  },\n                },\n                '& .date-control': {\n                  flex: '0 0 auto',\n                  color: '#767676',\n                  cursor: 'pointer',\n                },\n              }}\n            >\n              <label className=\"label\">銷售日期 :</label>\n\n              <div className=\"date-input-wrapper\">\n                <input\n                  type='date'\n                  name=\"startDate\"\n                  className=\"date-input\"\n                  onChange={onSearchChange}\n                  max={searchContent.endDate}\n                  value={searchContent.startDate || ''}\n                />\n              </div>\n\n              <div className=\"date-input-wrapper\">\n                <input\n                  type='date'\n                  name=\"endDate\"\n                  className=\"date-input\"\n                  onChange={onSearchChange}\n                  min={searchContent.startDate}\n                  value={searchContent.endDate || ''}\n                />\n              </div>\n\n              <div className=\"date-control\">\n                <ArrowLeft viewBox=\"1 2.5 20 20\" data-change-type=\"previous\" onClick={changeDate} />\n                <ArrowRight viewBox=\"4 2.5 20 20\" data-change-type=\"next\" onClick={changeDate} />\n              </div>\n            </Box>\n          </Box>\n\n\n        </Grid>\n\n        <Box\n          sx={{\n            pl: '1rem',\n            display: 'flex',\n          }}\n        >\n          <Button\n            onClick={handleSearch}\n            sx={{\n              color: 'background.paper',\n              fontSize: '0.875rem',\n              bgcolor: (theme) => theme.palette.primary.main,\n              '&:hover': {\n                bgcolor: 'primary.light',\n              },\n            }}\n          >\n            搜尋\n          </Button>\n        </Box>\n\n\n      </Box>\n\n      <div className=\"search-result\">\n        <div>\n          <Box sx={orderHeaderStyle}>\n            <div className=\"serial-sec\">項次</div>\n            <div className=\"time-sec\">交易時間</div>\n            <div className=\"total-sec\">總和</div>\n            <div className=\"actual-total-sec\">總金額</div>\n            <div className=\"member-name-sec\">會員姓名</div>\n            <div className=\"member-phone-sec\">會員電話</div>\n          </Box>\n          <Box sx={orderListStyle}>\n            {renderOrders(sales)}\n          </Box>\n        </div>\n\n        <Divider sx={{ mt: '1.5rem', mb: '0.75rem', }} />\n\n        <Typography variant=\"h6\"\n          sx={{\n            color: (theme) => theme.palette.primary.main,\n            fontSize: '1.25rem',\n            fontWeight: 'bold',\n            letterSpacing: '0.05em',\n          }}\n        >\n          交易明細\n        </Typography>\n        <Box sx={orderDetailStyle}>\n          <div className=\"table-header\">\n            <div className=\"serial-sec sec-item\">項次</div>\n            <div className=\"name-sec sec-item\">商品名稱</div>\n            <div className=\"price-sec sec-item\">定價</div>\n            <div className=\"quantity-sec sec-item\">數量</div>\n            <div className=\"discount-sec sec-item\">折數</div>\n            <div className=\"total-sec sec-item\">合計</div>\n          </div>\n\n          <Box className=\"table-list\">\n            {(currentPaidOrder && currentPaidOrder.salesDetails)\n              ? renderOrderDetail(currentPaidOrder.salesDetails)\n              : null}\n          </Box>\n        </Box>\n      </div>\n\n    </Fragment>\n  )\n}\n\nconst dayStrings = ['日', '一', '二', '三', '四', '五', '六']\n\nconst fieldGridStyle = {\n  flex: '0 0 100%',\n  maxWidth: '100%',\n  display: 'flex',\n  justifyContent: 'space-between',\n  '@media (min-width: 600px)': {\n    flex: '0 0 49%',\n    maxWidth: '49%',\n  },\n}\n\nconst orderHeaderStyle = {\n  display: 'flex',\n  color: 'background.darkPaper',\n  bgcolor: 'secondary.main',\n  '& > div': {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    fontSize: '1rem',\n    borderRight: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    paddingTop: '0.125em',\n    paddingBottom: '0.125em',\n  },\n  '& .serial-sec': {\n    flex: '0 0 7%',\n    borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n  },\n  '& .time-sec': {\n    flexGrow: 1,\n  },\n  '& .total-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .actual-total-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .member-name-sec': {\n    flex: '0 0 15%',\n  },\n  '& .member-phone-sec': {\n    flex: '0 0 17.5%',\n  },\n  '& .invoice-sec': {\n    flex: '0 0 17.5%',\n    justifyContent: 'flex-start',\n    borderRight: 'none',\n    padding: '0 1em',\n  },\n}\n\nconst orderListStyle = {\n  maxHeight: '8rem',\n  overflow: 'overlay',\n  '& .order-item': {\n    display: 'flex',\n    cursor: 'pointer',\n    userSelect: 'none',\n    bgcolor: 'background.darkPaper',\n    '& > div': {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      fontSize: '1rem',\n      color: 'secondary.main',\n      height: '2em',\n      padding: '0.25em',\n      borderRight: '1px solid #f0f0f0',\n      overflow: 'overlay',\n    },\n    '&:nth-of-type(2n + 1)': {\n      bgcolor: '#e6e6e6',\n    },\n    '& .serial-sec': {\n      flex: '0 0 7%',\n      borderLeft: theme => `1px solid ${theme.palette.background.darkPaper}`,\n    },\n    '& .time-sec': {\n      flexGrow: 1,\n    },\n    '& .total-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .actual-total-sec': {\n      flex: '0 0 12.5%',\n    },\n    '& .member-name-sec': {\n      flex: '0 0 15%',\n    },\n    '& .member-phone-sec': {\n      flex: '0 0 17.5%',\n    },\n    '& .invoice-sec': {\n      flex: '0 0 17.5%',\n      justifyContent: 'flex-start',\n      borderRight: 'none',\n      padding: '0 1em',\n    },\n    '&.active': {\n      bgcolor: 'active.main',\n    },\n  },\n}\n\nconst orderDetailStyle = {\n  display: 'inline-block',\n  width: '100%',\n  '& .table-header': {\n    display: 'flex',\n    height: '2em',\n    color: 'background.paper',\n    fontSize: '1rem',\n    bgcolor: 'secondary.main',\n  },\n  '& .table-list': {\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'overlay',\n    height: '10rem',\n  },\n  '& .table-item': {\n    flex: '0 0 25%',\n    display: 'flex',\n    color: 'secondary.main',\n    fontSize: '1rem',\n    bgcolor: 'background.light',\n    cursor: 'pointer',\n    userSelect: 'none',\n  },\n  '& .table-item:nth-of-type(2n + 1)': {\n    bgcolor: '#ebebeb',\n  },\n  '& .table-item.active': {\n    bgcolor: 'active.main',\n  },\n  '& .sec-item': {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    textAlign: 'center',\n    padding: '0.25em',\n    borderRight: '1px solid #eeeeee',\n    minWidth: 0,\n  },\n  '& .checkbox-sec': {\n    flex: '0 0 6%',\n  },\n  '& .serial-sec': {\n    flex: '0 0 7%',\n  },\n  '& .name-sec': {\n    flex: '1 0 20%',\n    wordBreak: 'break-all',\n  },\n  '& .price-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .quantity-sec': {\n    flex: '0 0 10%',\n  },\n  '& .discount-sec': {\n    flex: '0 0 10%',\n  },\n  '& .total-sec': {\n    flex: '0 0 12.5%',\n  },\n  '& .checkbox-color': {\n    color: (theme) => theme.palette.primary.main,\n    padding: '0.25em',\n  },\n}\n\nconst btnFieldStyle = {\n  pb: '0.5rem',\n  minWidth: 0,\n  display: 'flex',\n  flexGrow: 1,\n  alignItems: 'center',\n  position: 'relative',\n  '& label': {\n    pr: '1rem',\n  },\n  '& input': {\n    padding: '0 0.25em',\n    flexGrow: 1,\n    '&:disabled': {\n      color: '#000000',\n      bgcolor: '#fbfbfb',\n    },\n  },\n  '& button': {\n    padding: '0 7px',\n    minWidth: '41px',\n    marginLeft: '0.25rem',\n    marginTop: '0.125rem',\n    marginBottom: '0.125rem',\n    color: 'background.paper',\n    bgcolor: (theme) => theme.palette.primary.main,\n    '&:hover': {\n      bgcolor: 'primary.light',\n    },\n  },\n}\n\nexport default OrderList","import React, { useState, useEffect, useMemo } from 'react'\nimport { connect } from 'react-redux'\n\nimport Box from '@mui/material/Box'\nimport Dialog from '@mui/material/Dialog'\nimport Button from '@mui/material/Button'\nimport IconButton from '@mui/material/IconButton'\nimport Typography from '@mui/material/Typography'\nimport DialogContent from '@mui/material/DialogContent'\nimport DialogActions from '@mui/material/DialogActions'\nimport OrderList from '../../ui/OrderList'\n\nimport Cancel from '@mui/icons-material/Cancel'\nimport SwapVerticalCircle from '@mui/icons-material/SwapVerticalCircle'\n\nimport { salesRequest } from '../../../apis'\nimport { fireDialogToast } from '../../../helpers/sweetAlert'\nimport { replacePosStrips } from '../../../slices/posStripsSlice'\nimport { replaceCurrentMember } from '../../../slices/currentMemberSlice'\nimport { fetchSales, deleteSale } from '../../../slices/salesSlice'\n\nconst DialogReturn = ({\n  auth,\n  open,\n  sales,\n  deleteSale,\n  fetchSales,\n  handleClose,\n}) => {\n  const [currentOrderId, setCurrentOrderId] = useState('')\n\n  const currentPaidOrder = useMemo(() => {\n    return (sales.list && sales.list.find(order => order.id === currentOrderId)) || {}\n  }, [sales, currentOrderId])\n\n  const currentCreditInfo = useMemo(() => {\n    return (currentPaidOrder?.salesPayments\n      && currentPaidOrder.salesPayments.find(payment => Boolean(payment.creditCard))?.creditCard)\n      || {}\n  }, [currentPaidOrder])\n\n  useEffect(() => {\n    fetchSales({\n      isReturn: 0,\n    })\n  }, [fetchSales])\n\n  useEffect(() => {\n    if (sales.list && sales.list[0]) setCurrentOrderId(sales.list[0].id);\n  }, [sales])\n\n  const onReturnClick = async () => {\n    try {\n      await salesRequest.post(`/refund/${currentOrderId}`, null, {\n        headers: { 'Authorization': 'Bearer ' + auth.authenticated },\n      })\n      deleteSale(currentOrderId)\n      fireDialogToast('退貨完成', 'success')\n\n    } catch (error) {\n      fireDialogToast(`警告: ${error}`, 'error')\n    }\n  }\n\n  const renderPayments = payments => {\n    return payments.map((payment) => {\n      const paymentType = payment.SalePointPayment || {}\n\n      return (\n        <div key={payment.id}>\n          <span className=\"received-method\">{paymentType.paymentName}：</span>\n          <span className=\"received-content\">{payment.value}</span>\n        </div>\n      )\n    })\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-temp-order\"\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"dialog-temp-order\"\n      maxWidth=\"md\"\n      fullWidth\n    >\n      <Box\n        sx={{\n          flex: '0 0 auto',\n          margin: 0,\n          padding: '0.375em 1.25em 0.25em',\n          lineHeight: 1.6,\n          letterSpacing: '0.0075rem',\n          bgcolor: 'background.default',\n          '& h6': {\n            color: 'secondary.main',\n            fontSize: '1.375rem',\n            fontWeight: 'bold',\n            letterSpacing: '0.05em',\n          }\n        }}\n      >\n        <Typography variant=\"h6\">訂單退貨</Typography>\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: '#cb5c5c',\n            padding: 0,\n          }}>\n            <Cancel sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent\n        sx={{\n          padding: '1.25em 1.75em 0',\n          bgcolor: 'background.paper',\n        }}\n      >\n        <OrderList\n          sales={sales}\n          fetchSales={fetchSales}\n          currentOrderId={currentOrderId}\n          setCurrentOrderId={setCurrentOrderId}\n          currentPaidOrder={currentPaidOrder}\n        />\n\n      </DialogContent>\n\n      <DialogActions sx={dialogActionStyle}>\n        <div className=\"order-info\">\n          <div className=\"received-field\">\n            <div>\n              <Typography variant=\"subtitle2\" className=\"received-title\">\n                當筆付款方式 :\n              </Typography>\n            </div>\n            <div className=\"received-pool\">\n\n              {renderPayments((currentPaidOrder && currentPaidOrder.salesPayments) || [])}\n\n            </div>\n          </div>\n\n          <div className=\"other-field\">\n            <div>\n              <Typography variant=\"subtitle2\" className=\"other-title\">\n                其他詳細資訊\n              </Typography>\n            </div>\n            <div className=\"other-pool\">\n              <div>\n                <span className=\"other-method\">卡號末四碼：</span>\n                <span className=\"other-content\">\n                  {currentCreditInfo.cardNo ? currentCreditInfo.cardNo.replaceAll(' ', '').slice(-4) : '- - - -'}\n                </span>\n              </div>\n              <div>\n                <span className=\"other-method\">授權碼：</span>\n                <span className=\"other-content\">{currentCreditInfo.approvalCode || '- - - -'}</span>\n              </div>\n              <div>\n                <span className=\"other-method\">載具號碼：</span>\n                <span className=\"other-content\">{currentPaidOrder.phoneBarcode || '- - - -'}</span>\n              </div>\n              <div>\n                <span className=\"other-method\">統一編號：</span>\n                <span className=\"other-content\">{currentPaidOrder.uniformNumber || '- - - -'}</span>\n              </div>\n            </div>\n          </div>\n\n        </div>\n        <div className=\"returnBtn-wrapper\">\n          <Button\n            startIcon={<SwapVerticalCircle sx={{ '&:first-of-type': { fontSize: '1.25em' } }} />}\n            onClick={onReturnClick}\n            sx={{\n              display: 'inline-flex',\n              justifyContent: 'center',\n              fontSize: '1.375rem',\n              fontWeight: 'bold',\n              borderRadius: '0.5em',\n              border: 'none',\n              color: 'background.paper',\n              bgcolor: (theme) => theme.palette.primary.main,\n              minWidth: '105px',\n              '&:hover': {\n                bgcolor: '#fabd5e',\n              },\n            }}\n          >\n            退貨\n          </Button>\n        </div>\n      </DialogActions>\n\n    </Dialog>\n  )\n}\n\nconst dialogActionStyle = {\n  justifyContent: 'space-between',\n  padding: '1em 1.75em',\n  bgcolor: 'background.paper',\n  '& .order-info': {\n    flexGrow: 1,\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  '& .received-field': {\n    flex: '0 0 36%',\n    display: 'flex',\n    flexWrap: 'wrap',\n    padding: '0 0.25em',\n    '& > div': {\n      flex: '0 0 100%',\n    },\n  },\n  '& .received-title': {\n    display: 'inline-block',\n    borderRadius: '0.25em',\n    bgcolor: 'active.main',\n    padding: '0 0.25em',\n  },\n  '& .received-pool': {\n    display: 'inline-flex',\n    flexWrap: 'wrap',\n    '& > div': {\n      flex: '1 0 50%',\n      display: 'flex',\n      fontSize: '0.875rem',\n    },\n  },\n  '& .received-method': {\n    minWidth: 0,\n  },\n  '& .received-content': {\n    flexGrow: 1,\n    minWidth: 0,\n  },\n  '& .other-field': {\n    flexGrow: 1,\n    flexShrink: 1,\n    padding: '0 0.25em',\n    '& > div': {\n      flex: '0 0 100%',\n    },\n  },\n  '& .other-title': {\n    display: 'inline-block',\n    borderRadius: '0.25em',\n    bgcolor: 'active.main',\n    padding: '0 0.25em',\n  },\n  '& .other-pool': {\n    display: 'flex',\n    flexWrap: 'wrap',\n    '& > div': {\n      flex: '0 0 50%',\n      display: 'flex',\n      fontSize: '0.875rem',\n    },\n  },\n  '& .other-content': {\n    flexGrow: 1,\n  },\n  '& .returnBtn-wrapper': {\n    display: 'flex',\n    alignItems: 'center',\n  },\n}\n\nconst mapStateToProps = state => {\n  return {\n    auth: state.auth,\n    sales: state.sales,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  {\n    fetchSales,\n    deleteSale,\n    replacePosStrips,\n    replaceCurrentMember,\n  }\n)(DialogReturn)","import React, { useState, useEffect, useMemo } from 'react'\nimport { connect } from 'react-redux'\n\nimport Box from '@mui/material/Box'\nimport Grid from '@mui/material/Grid'\nimport Dialog from '@mui/material/Dialog'\nimport Button from '@mui/material/Button'\nimport Divider from '@mui/material/Divider'\nimport IconButton from '@mui/material/IconButton'\nimport Typography from '@mui/material/Typography'\nimport DialogContent from '@mui/material/DialogContent'\nimport { fireDialogToast } from '../../../helpers/sweetAlert'\n// import DialogActions from '@mui/material/DialogActions'\nimport OrderList from '../../ui/OrderList'\n\nimport Cancel from '@mui/icons-material/Cancel'\nimport { fetchSales, transferSaleArrear } from '../../../slices/salesSlice'\nimport { fetchPaymentMethods } from '../../../slices/paymentMethodsSlice'\n\nconst DialogRepay = ({\n  open,\n  sales,\n  fetchSales,\n  transferSaleArrear,\n  fetchPaymentMethods,\n  handleClose,\n}) => {\n  const [inputAmount, setInputAmount] = useState(0)\n  const [currentOrderId, setCurrentOrderId] = useState('')\n  const [isRepaying, setIsRepaying] = useState(false)\n\n  const currentPaidOrder = useMemo(() => {\n    return (sales.list && sales.list.find(order => order.id === currentOrderId)) || {}\n  }, [sales, currentOrderId])\n\n  const currentArrearInfo = useMemo(() => {\n    return (\n      currentPaidOrder?.salesPayments && currentPaidOrder.salesPayments.find(payment => (\n        payment.SalePointPayment && payment.SalePointPayment.salePointPaymentsTypeId === '6'\n      ))\n    ) || {}\n  }, [currentPaidOrder])\n\n  useEffect(() => {\n    fetchPaymentMethods()\n  }, [fetchPaymentMethods])\n\n  useEffect(() => {\n    fetchSales({\n      isReturn: 0,\n      isOwePayment: 1,\n    })\n  }, [fetchSales])\n\n  useEffect(() => {\n    if (sales.list && sales.list[0] && !isRepaying) setCurrentOrderId(sales.list[0].id);\n  }, [sales, isRepaying])\n\n  const onFillInClick = () => {\n    if (currentArrearInfo && currentArrearInfo.value > 0) {\n      setInputAmount(currentArrearInfo.value)\n    } else {\n      setInputAmount(0)\n    }\n  }\n\n  const onInputAmountChange = (e) => {\n    if (Number.isNaN(Number(e.target.value))) return\n    if (Number(e.target.value) > currentArrearInfo.value) {\n      fireDialogToast('警告: 金額超過欠款')\n      return\n    }\n    setInputAmount(Number(e.target.value))\n  }\n\n\n  const onPaymentClick = e => {\n    if (!inputAmount) {\n      fireDialogToast('警告: 請輸入金額')\n      return\n    }\n    setIsRepaying(true)\n    setInputAmount(0)\n    const paymentId = e.target.dataset.paymentId\n    console.log({\n      saleId: currentOrderId,\n      arrearId: currentArrearInfo.id,\n      paymentId: paymentId,\n      value: inputAmount,\n    })\n    transferSaleArrear({\n      saleId: currentOrderId,\n      arrearId: currentArrearInfo.id,\n      paymentId: paymentId,\n      value: inputAmount,\n    })\n  }\n\n  const onItemClick = e => {\n    setInputAmount(0)\n    setIsRepaying(false)\n  }\n\n\n  const renderPayments = payments => {\n    const restPayments = payments.map(payment => {\n      const paymentType = payment.SalePointPayment || {}\n      return (paymentType && paymentType.salePointPaymentsTypeId === '6')\n        ? null\n        : (\n          <div key={payment.id} className=\"payment-span\">\n            <span className=\"received-method\">{paymentType.paymentName} :&nbsp;</span>\n            <span className=\"received-content\">{payment.value}</span>\n          </div>\n        )\n    })\n\n    return (\n      <Grid container alignItems=\"center\" sx={{\n        px: '0.5rem',\n        mb: '0.75rem',\n        borderRadius: 1,\n        bgcolor: 'background.darkPaper',\n      }}>\n        <Grid item xs=\"auto\" sx={{\n          pr: '2rem',\n          fontSize: '1.5rem',\n          fontWeight: 'bold',\n        }}>\n          <span>\n            欠餘 :&nbsp;\n          </span>\n          <span>\n            {currentArrearInfo.value || '- - -'}\n          </span>\n        </Grid>\n\n        <Grid item xs sx={{\n          '& > div': {\n            pr: '0.75rem',\n            display: 'inline-block',\n          }\n        }}>\n          {restPayments}\n        </Grid>\n      </Grid>\n    )\n  }\n\n  return (\n    <Dialog\n      id=\"dialog-repay\"\n      aria-labelledby=\"dialog-repay\"\n      fullWidth\n      maxWidth=\"md\"\n      open={open}\n      onClose={handleClose}\n    >\n      <Box\n        sx={{\n          flex: '0 0 auto',\n          margin: 0,\n          padding: '0.375em 1.25em 0.25em',\n          lineHeight: 1.6,\n          letterSpacing: '0.0075rem',\n          bgcolor: 'background.default',\n          '& h6': {\n            color: 'secondary.main',\n            fontSize: '1.375rem',\n            fontWeight: 'bold',\n            letterSpacing: '0.05em',\n          }\n        }}\n      >\n        <Typography variant=\"h6\">訂單還款</Typography>\n        {handleClose ? (\n          <IconButton aria-label=\"close\" onClick={handleClose} sx={{\n            position: 'absolute',\n            right: '0.5em',\n            top: '0.25em',\n            color: '#cb5c5c',\n            padding: 0,\n          }}>\n            <Cancel sx={{ width: '1.25em', height: '1.25em' }} />\n          </IconButton>\n        ) : null}\n      </Box>\n\n      <DialogContent\n        sx={{\n          padding: '0.25em 1.75em 0',\n          backgroundColor: '#fafafa',\n          '& .search-result': {\n            overflowY: 'auto',\n          },\n        }}\n      >\n\n        <Grid container alignItems=\"center\" justifyContent=\"center\">\n          <Grid item container alignItems=\"center\" justifyContent=\"space-between\"\n            sx={{\n              pt: '1.25rem',\n              pb: '1rem',\n              flex: '0 0 95%',\n            }}\n          >\n\n            <Grid\n              item\n              xs={6}\n              display=\"inline-flex\"\n              className=\"received-amount-input\"\n              sx={{\n                '& input': {\n                  flex: '0 0 80%',\n                  width: '100%',\n                  lineHeight: 2,\n                  textAlign: 'center',\n                  fontSize: '1.25rem',\n                  fontWeight: 'bold',\n                  letterSpacing: '0.02em',\n                  border: '1px solid #aaaaaa',\n                  borderRight: 'none',\n                  borderTopLeftRadius: '0.25em',\n                  borderBottomLeftRadius: '0.25em',\n                  color: (theme) => theme.palette.primary.main,\n                  outlineColor: (theme) => theme.palette.primary.main,\n                  backgroundColor: 'background.paper',\n                  '&::placeholder': {\n                    color: '#c4c4c4',\n                  },\n                },\n                '& button': {\n                  flex: '0 0 20%',\n                  textAlign: 'center',\n                  fontSize: '1rem',\n                  fontWeight: 'bold',\n                  letterSpacing: '0.025em',\n                  border: (theme) => `1px solid ${theme.palette.primary.main}`,\n                  borderLeft: 'none',\n                  borderTopLeftRadius: 0,\n                  borderBottomLeftRadius: 0,\n                  color: 'background.default',\n                  backgroundColor: (theme) => theme.palette.primary.main,\n                  '&:hover': {\n                    backgroundColor: 'primary.light',\n                  },\n                  '&:disabled': {\n                    borderColor: '#aaaaaa',\n                  }\n                },\n              }}\n            >\n              <input\n                value={inputAmount || ''}\n                onChange={onInputAmountChange}\n                placeholder=\"輸入還款金額\"\n              />\n              <Button\n                variant=\"contained\"\n                disableElevation\n                onClick={onFillInClick}\n              >\n                填入\n              </Button>\n            </Grid>\n\n            <Grid\n              item\n              xs={6}\n              className=\"main-payment-method\"\n              display=\"inline-flex\"\n              sx={{\n                pl: '2rem',\n                '& button': {\n                  flex: '0 0 47.5%',\n                  fontSize: '1.125rem',\n                  fontWeight: 'bold',\n                  color: 'background.paper',\n                  backgroundColor: 'secondary.matte',\n                  '&:first-of-type': {\n                    mr: '5%',\n                  },\n                  '&:hover': {\n                    backgroundColor: '#606c9a',\n                  },\n                },\n              }}\n            >\n              <Button variant=\"contained\" data-payment-id=\"1\" onClick={onPaymentClick}>\n                現金\n              </Button>\n              <Button variant=\"contained\" data-payment-id=\"4\" onClick={onPaymentClick}>\n                匯款\n              </Button>\n            </Grid>\n\n          </Grid>\n        </Grid>\n\n        {renderPayments((currentPaidOrder && currentPaidOrder.salesPayments) || [])}\n\n        <Divider sx={{ mb: '1.25rem' }} />\n\n\n        <OrderList\n          sales={sales}\n          fetchSales={fetchSales}\n          currentOrderId={currentOrderId}\n          setCurrentOrderId={setCurrentOrderId}\n          currentPaidOrder={currentPaidOrder}\n          searchParams={{ isOwePayment: 1 }}\n          handleItemClick={onItemClick}\n        />\n\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    sales: state.sales,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  {\n    fetchSales,\n    transferSaleArrear,\n    fetchPaymentMethods,\n  }\n)(DialogRepay)","import React, { useState, useEffect, useCallback } from 'react'\nimport { connect } from 'react-redux'\nimport { useTheme, alpha } from '@mui/system'\nimport { Box, Button, SvgIcon } from '@mui/material'\nimport SwapVerticalCircle from '@mui/icons-material/SwapVerticalCircle'\nimport PointOfSale from '@mui/icons-material/PointOfSale'\nimport PlayForWork from '@mui/icons-material/PlayForWork'\nimport { getNewStrip } from '../../helpers/checkout'\nimport { commRequest } from '../../apis'\nimport { addPosStrip, clearPosStrips } from '../../slices/posStripsSlice'\nimport { replaceCreditCardResponse } from '../../slices/creditCardResponseSlice'\nimport { Toast } from '../../helpers/sweetAlert'\nimport useBarcode from '../../hooks/useBarcode'\nimport DialogCheckout from './Dialog/DialogCheckout'\nimport DialogReturn from './Dialog/DialogReturn'\nimport DialogRepay from './Dialog/DialogRepay'\nimport Toggle from '../Toggle'\n\nconst SettlementBar = ({\n  auth,\n  posStrips,\n  addPosStrip,\n  clearPosStrips,\n  setSelectedIds,\n  receivedAmounts,\n  setUniformContent,\n  replaceCreditCardResponse,\n}) => {\n  const theme = useTheme()\n  const [isPartialClear, setIsPartialClear] = useState(false)\n  const [checkoutOpen, setCheckoutOpen] = useState(false)\n  const [returnOpen, setReturnOpen] = useState(false)\n  const [repayOpen, setRepayOpen] = useState(false)\n  const [barcode, clearBarcode] = useBarcode()\n\n  const onBarcodeScanned = useCallback(async (barcode) => {\n    const response = await commRequest.get('', {\n      headers: { 'Authorization': 'Bearer ' + auth.authenticated },\n      params: {\n        sort: 'sale_start_date desc',\n        internationalBarcode: barcode,\n      },\n    })\n\n    if (response?.data?.list[0]) {\n      const newStrip = getNewStrip(response.data.list[0])\n      addPosStrip(newStrip)\n    }\n  }, [auth, addPosStrip])\n\n  useEffect(() => {\n    if (!barcode || checkoutOpen) return\n    console.log(barcode)\n    onBarcodeScanned(barcode)\n    clearBarcode()\n\n  }, [barcode, clearBarcode, checkoutOpen, onBarcodeScanned])\n\n  const onClearStripsClick = () => {\n    clearPosStrips()\n    setUniformContent('')\n    setSelectedIds([])\n  }\n\n  const onReturnClick = () => {\n    setReturnOpen(true)\n  }\n\n  const onReturnClose = () => {\n    setReturnOpen(false)\n  }\n\n  const onRepayClick = () => {\n    setRepayOpen(true)\n  }\n\n  const onRepayClose = () => {\n    setRepayOpen(false)\n  }\n\n  const onMoneyClick = () => {\n    // 在這裡打開**收銀機**\n\n    // 以下為測試用\n    // console.log('window.configBridge.getConfig()?.printer', window.configBridge.getConfig()?.printer)\n    // window.configBridge.setConfig('edc', { path: 'COM3' })\n    // console.log('window.configBridge.getConfig()?.edc', window.configBridge.getConfig()?.edc)\n    // console.log('----------')\n\n    // console.log('信用卡:')\n    // console.log(\n    //   'window.edcBridge.send({ amount: 11, edc: window.configBridge.getConfig()?.edc })',\n    //   window.edcBridge.send({ amount: 11, edc: window.configBridge.getConfig()?.edc })\n    // )\n\n    // console.log('收銀機:')\n    // console.log(\n    //   'window.printerBridge.openCashRegister()',\n    //   window.printerBridge.openCashRegister()\n    // )\n\n    window.printerBridge.openCashRegister()\n  }\n\n  const onCheckoutClick = () => {\n    if (posStrips.length < 1) return Toast.fire({\n      title: \"提醒: 未有能結帳的商品\",\n      target: document.querySelector(\".right-platform\"),\n    })\n    setCheckoutOpen(true)\n  }\n\n  const handleCheckoutClose = () => {\n    setIsPartialClear(false)\n    setCheckoutOpen(false)\n    replaceCreditCardResponse({})\n  }\n\n  const handleValidateAndClose = () => {\n    if (!validateReceived()) return\n    handleCheckoutClose()\n  }\n\n  const validateReceived = () => {\n    if (Boolean(Object.keys(receivedAmounts).length)) {\n      Toast.fire({\n        title: `請先「結帳」或「清除付款」`,\n        target: document.querySelector('.MuiDialog-root')\n      })\n      return false\n    }\n    return true\n  }\n\n  return (\n    <Box component=\"section\" id=\"settlement-bar\"\n      sx={{\n        flex: '0 0 9.125%',\n        display: 'flex',\n        alignItems: 'flex-start',\n        justifyContent: 'space-between',\n        '& .btn-smooth': {\n          borderRadius: '0.5em',\n          color: 'background.paper',\n          fontWeight: 'bold',\n          fontSize: '1.25rem',\n        },\n        '& .btn-clear': {\n          backgroundColor: '#cb5c5c',\n          '&:hover': {\n            bgcolor: alpha('#cb5c5c', 0.8),\n          },\n        },\n        '& .btn-return': {\n          backgroundColor: '#52483b',\n          marginLeft: '1em',\n          '&:hover': {\n            bgcolor: alpha('#52483b', 0.8),\n          },\n        },\n        '& .btn-repay': {\n          backgroundColor: '#2b3f5e',\n          marginLeft: '1em',\n          '&:hover': {\n            bgcolor: alpha('#2b3f5e', 0.8),\n          },\n        },\n        '& .btn-money': {\n          backgroundColor: 'secondary.main',\n          marginLeft: '1em',\n          '&:hover': {\n            bgcolor: theme => alpha(theme.palette.secondary.main, 0.8),\n          },\n          '& svg': {\n            color: theme.palette.primary.main,\n          },\n        },\n        '& .btn-settlement': {\n          backgroundColor: theme.palette.primary.main,\n          marginLeft: '1em',\n          '&:hover': {\n            bgcolor: alpha(theme.palette.primary.main, 0.8),\n          },\n        },\n      }}\n    >\n      <div>\n        <Button\n          variant=\"contained\"\n          className=\"btn-smooth btn-clear\"\n          startIcon={<CrossIcon />}\n          onClick={onClearStripsClick}\n        >\n          整筆清除\n        </Button>\n\n      </div>\n      <div>\n        <Button\n          onClick={onReturnClick}\n          variant=\"contained\"\n          className=\"btn-smooth btn-return\"\n          startIcon={<SwapVerticalCircle />}\n        >\n          退貨\n        </Button>\n        <Button\n          onClick={onRepayClick}\n          variant=\"contained\"\n          className=\"btn-smooth btn-repay\"\n          startIcon={<PlayForWork />}\n        >\n          還款\n        </Button>\n        {/* <Button\n          onClick={onReceiptClick}\n          variant=\"contained\"\n          className=\"btn-smooth btn-return\"\n          startIcon={<SwapVerticalCircle />}\n        >\n          收據\n        </Button> */}\n        <Toggle determineParam={repayOpen}>\n          <DialogRepay\n            open={repayOpen}\n            handleClose={onRepayClose}\n          />\n        </Toggle>\n        <Toggle determineParam={returnOpen}>\n          <DialogReturn\n            open={returnOpen}\n            handleClose={onReturnClose}\n          />\n        </Toggle>\n        <Button\n          variant=\"contained\"\n          className=\"btn-smooth btn-money\"\n          onClick={onMoneyClick}\n          startIcon={<PointOfSale />}>\n          錢櫃\n        </Button>\n        <Button\n          onClick={onCheckoutClick}\n          variant=\"contained\"\n          className=\"btn-smooth btn-settlement\"\n          startIcon={<CalcIcon />}>\n          小計\n        </Button>\n        <DialogCheckout\n          open={checkoutOpen}\n          isPartialClear={isPartialClear}\n          handleCheckoutClose={handleCheckoutClose}\n          handleValidateAndClose={handleValidateAndClose}\n          setIsPartialClear={setIsPartialClear}\n        />\n        {/* <Toggle determineParam={checkoutOpen}>\n            <DialogCheckout\n              open={checkoutOpen}\n              handleClose={() => setCheckoutOpen(false)}\n            />\n          </Toggle> */}\n\n      </div>\n    </Box>\n  )\n}\n\nconst CrossIcon = () => {\n  return (\n    <SvgIcon>\n      <path d=\"M11.381 0C5.09391 0 0 5.41092 0 12.0893C0 18.7676 5.09391 24.1785 11.381 24.1785C17.6681 24.1785 22.762 18.7676 22.762 12.0893C22.762 5.41092 17.6681 0 11.381 0ZM16.9613 15.2627C17.177 15.4918 17.177 15.8623 16.9613 16.0914L15.144 18.0169C14.9284 18.246 14.5796 18.246 14.3639 18.0169L11.381 14.8191L8.39347 18.0169C8.17779 18.246 7.82901 18.246 7.61333 18.0169L5.80063 16.0865C5.58494 15.8574 5.58494 15.4869 5.80063 15.2578L8.81108 12.0893L5.80063 8.91583C5.58494 8.68672 5.58494 8.31624 5.80063 8.08713L7.61792 6.15675C7.8336 5.92764 8.18237 5.92764 8.39806 6.15675L11.381 9.35943L14.3685 6.16162C14.5842 5.93251 14.9329 5.93251 15.1486 6.16162L16.9659 8.09201C17.1816 8.32112 17.1816 8.6916 16.9659 8.92071L13.9509 12.0893L16.9613 15.2627Z\" fill=\"#FAFAFA\" />\n    </SvgIcon>\n  )\n}\n\nconst CalcIcon = () => {\n  return (\n    <SvgIcon>\n      <path d=\"M15.4794 0H2.12221C1.15078 0 0.300781 0.929458 0.300781 1.9917V19.2531C0.300781 20.3153 1.15078 21.2448 2.12221 21.2448H15.4794C16.4508 21.2448 17.3008 20.3153 17.3008 19.2531V1.9917C17.3008 0.929458 16.4508 0 15.4794 0ZM5.15792 18.058C5.15792 18.3236 4.91507 18.5892 4.67221 18.5892H3.21507C2.97221 18.5892 2.72935 18.3236 2.72935 18.058V16.4647C2.72935 16.1991 2.97221 15.9336 3.21507 15.9336H4.67221C4.91507 15.9336 5.15792 16.1991 5.15792 16.4647V18.058ZM5.15792 12.7469C5.15792 13.0124 4.91507 13.278 4.67221 13.278H3.21507C2.97221 13.278 2.72935 13.0124 2.72935 12.7469V11.1535C2.72935 10.8879 2.97221 10.6224 3.21507 10.6224H4.67221C4.91507 10.6224 5.15792 10.8879 5.15792 11.1535V12.7469ZM10.0151 18.058C10.0151 18.3236 9.77221 18.5892 9.52935 18.5892H8.07221C7.82935 18.5892 7.5865 18.3236 7.5865 18.058V16.4647C7.5865 16.1991 7.82935 15.9336 8.07221 15.9336H9.52935C9.77221 15.9336 10.0151 16.1991 10.0151 16.4647V18.058ZM10.0151 12.7469C10.0151 13.0124 9.77221 13.278 9.52935 13.278H8.07221C7.82935 13.278 7.5865 13.0124 7.5865 12.7469V11.1535C7.5865 10.8879 7.82935 10.6224 8.07221 10.6224H9.52935C9.77221 10.6224 10.0151 10.8879 10.0151 11.1535V12.7469ZM14.8722 18.058C14.8722 18.3236 14.6294 18.5892 14.3865 18.5892H12.9294C12.6865 18.5892 12.4436 18.3236 12.4436 18.058V11.1535C12.4436 10.8879 12.6865 10.6224 12.9294 10.6224H14.3865C14.6294 10.6224 14.8722 10.8879 14.8722 11.1535V18.058ZM14.8722 7.43566C14.8722 7.70122 14.6294 7.96678 14.3865 7.96678H3.21507C2.97221 7.96678 2.72935 7.70122 2.72935 7.43566V3.18671C2.72935 2.92115 2.97221 2.65559 3.21507 2.65559H14.3865C14.6294 2.65559 14.8722 2.92115 14.8722 3.18671V7.43566Z\" fill=\"#FAFAFA\" />\n    </SvgIcon>\n  )\n}\n\nconst mapStateToProps = state => {\n  return {\n    auth: state.auth,\n    posStrips: state.posStrips,\n    receivedAmounts: state.receivedAmounts,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { addPosStrip, clearPosStrips, replaceCreditCardResponse },\n)(SettlementBar)\n","import React, { useState, useEffect, useMemo } from 'react'\nimport { connect } from 'react-redux'\nimport { Box, Typography } from '@mui/material'\nimport { getNewStrip } from '../../helpers/checkout'\nimport { addPosStrip } from '../../slices/posStripsSlice'\nimport { fetchPriceMapping } from '../../slices/priceMappingSlice'\nimport { fetchPosLayouts } from '../../slices/posLayoutsSlice'\n\nconst CommGrid = ({\n  listRef,\n  addPosStrip,\n  fetchPriceMapping,\n  fetchPosLayouts,\n  setActiveCommId,\n  setUniformContent,\n  posLayouts,\n  priceMapping,\n  posLayoutsStatus,\n}) => {\n  const [currentLayoutIndex, setCurrentLayoutIndex] = useState(0)\n\n  useEffect(() => {\n    fetchPosLayouts()\n  }, [fetchPosLayouts])\n\n  const posLayout = useMemo(() => {\n    return posLayouts[currentLayoutIndex]\n  }, [currentLayoutIndex, posLayouts])\n\n  useEffect(() => {\n    if (posLayoutsStatus !== 'idle') return\n    fetchPriceMapping(posLayout.stockList)\n  }, [posLayout, posLayoutsStatus, fetchPriceMapping])\n\n  const onCommClick = async (comm) => {\n    if (!comm.stockName) return\n    const newStrip = getNewStrip(comm, priceMapping)\n    await addPosStrip(newStrip)\n    setUniformContent('')\n    setActiveCommId(newStrip.id)\n    scrollToBottom(listRef.current)\n  }\n\n  const onTagClick = index => {\n    setCurrentLayoutIndex(index)\n  }\n\n  const scrollToBottom = el => {\n    el.scrollTo(0, el.scrollHeight)\n  }\n\n  const renderedGridCards = cards => {\n    return cards.map((card, index) => {\n      const stockPrice = priceMapping[card.stockId]\n      return (\n        <div\n          key={index}\n          className=\"comm-grid-card\"\n          style={{ backgroundColor: card.backgroundColor }}\n          onClick={() => onCommClick(card)}>\n          <div className=\"name-field\">\n            <span>{card.stockName}</span>\n          </div>\n          <div className=\"price-field\">\n            <Typography>\n              {(stockPrice ? '$' + stockPrice : ' ')}\n            </Typography>\n          </div>\n        </div>\n      )\n    })\n  }\n\n  const renderedTags = tags => {\n    return tags.map((tag, index) => {\n      const active = currentLayoutIndex === index ? 'active' : '';\n      return (\n        <div\n          className={`template-tag ${active}`}\n          onClick={() => onTagClick(index)}\n          key={tag.id}>\n          {tag.categoryName}\n        </div>\n      )\n    })\n  }\n\n  return (\n    <React.Fragment>\n      <Box component=\"section\" id=\"comm-grid\" sx={styles.commGrid}>\n        <div className=\"grid-container\">\n          {renderedGridCards(posLayout.stockList)}\n        </div>\n      </Box>\n      <Box component=\"section\" id=\"template-tag-list\" sx={styles.templateTagList}>\n        {renderedTags(posLayouts)}\n      </Box>\n    </React.Fragment>\n  )\n}\n\nconst styles = {\n  commGrid: {\n    flex: '0 0 90.5%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    '& .grid-container': {\n      flex: '0 0 95%',\n      display: 'flex',\n      justifyContent: 'space-around',\n      flexWrap: 'wrap',\n      width: '87.5%',\n      margin: '0 auto',\n      minHeight: 0,\n    },\n    '& .comm-grid-card': {\n      flex: '0 0 31.33333%',\n      display: 'inline-flex',\n      flexDirection: 'column',\n      color: '#666666',\n      backgroundColor: '#fcfcfc',\n      borderRadius: '0.3em',\n      fontWeight: 'bold',\n      width: '31.33333%',\n      margin: '1% 0',\n      padding: '0 0.5em',\n      cursor: 'pointer',\n      userSelect: 'none',\n    },\n    '& .name-field': {\n      flex: '0 0 75%',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      textAlign: 'center',\n      fontSize: '0.875rem',\n      overflow: 'auto',\n      '& span': {\n        display: 'inline-flex',\n        justifyContent: 'center',\n        textOverflow: 'ellipsis',\n        maxHeight: '3em',\n        textShadow: theme => `0px 0px 3px ${theme.palette.background.paper}`,\n      },\n      '&::-webkit-scrollbar': {\n        width: '1px',\n        height: '1px',\n      },\n      '&::-webkit-scrollbar-track': {\n        background: 'rgba(100, 100, 100, 0)',\n      },\n      '&::-webkit-scrollbar-thumb': {\n        background: 'rgba(100, 100, 100, 0.04)',\n      },\n    },\n    '& .price-field': {\n      flex: '0 0 25%',\n      display: 'flex',\n      alignItems: 'center',\n      textAlign: 'center',\n      wordBreak: 'break-all',\n      letterSpacing: '0.03em',\n      fontSize: '1rem',\n      fontWeight: 'normal',\n      color: '#707070',\n      padding: '0 0.5em',\n      borderTop: '1px solid #eeeeee',\n      '& .MuiTypography-root': {\n        minHeight: '1.5em',\n      },\n    },\n  },\n  templateTagList: {\n    flex: '0 0 7.5%',\n    display: 'flex',\n    backgroundColor: '#fcfcfc',\n    overflow: 'auto',\n    minHeight: 0,\n    '& .template-tag': {\n      flex: '0 0 20%',\n      position: 'relative',\n      display: 'inline-flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      textAlign: 'center',\n      fontWeight: 'bold',\n      color: '#777777',\n      cursor: 'pointer',\n      userSelect: 'none',\n      padding: '0 0.5em',\n      '&::before': {\n        content: '\"\"',\n        position: 'absolute',\n        height: '1em',\n        width: '1px',\n        left: 0,\n        borderLeft: '2px solid #eeeeee',\n      },\n      '&.active': {\n        color: 'background.default',\n        background: (theme) => theme.palette.primary.light,\n      },\n      '&:first-of-type::before': {\n        content: 'none',\n      },\n      '&.active::before': {\n        content: 'none',\n      },\n      '&.active + .template-tag::before': {\n        content: 'none',\n      }\n    },\n  },\n}\n\nconst mapStateToProps = state => {\n  return {\n    priceMapping: state.priceMapping.content,\n    posLayouts: state.posLayouts.content,\n    posLayoutsStatus: state.posLayouts.loading,\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { addPosStrip, fetchPriceMapping, fetchPosLayouts }\n)(CommGrid)","import React, { useState, useRef } from 'react'\nimport { Box, Container } from '@mui/material'\nimport InfoHeader from './InfoHeader'\nimport ControlBar from './ControlBar'\nimport CommStripList from './CommStripList'\nimport SearchComm from './SearchComm'\nimport NumberPanel from './NumberPanel'\nimport SettlementBar from './SettlementBar'\nimport CommGrid from './CommGrid'\nimport withAuth from '../Auth/withAuth'\n\nimport { INITIAL_KEYBOARD_MODE } from '../../publicVariable'\n\nconst PosPlatform = () => {\n  const [uniformContent, setUniformContent] = useState('')\n  const [activeCommId, setActiveCommId] = useState('')\n  const [selectedIds, setSelectedIds] = useState([])\n  const [keyboardMode, setKeyboardMode] = useState(INITIAL_KEYBOARD_MODE)\n  const listRef = useRef()\n\n  return (\n    <Box id=\"pos-platform\" sx={styles.root}>\n      <Container className=\"pos-platform-container\" maxWidth={false} sx={styles.container}>\n        <Box className=\"left-platform\" sx={styles.leftPlatform}>\n          <InfoHeader />\n          <div className=\"left-container\">\n            <ControlBar setSelectedIds={setSelectedIds} />\n            <CommStripList\n              listRef={listRef}\n              activeCommId={activeCommId}\n              selectedIds={selectedIds}\n              setUniformContent={setUniformContent}\n              setActiveCommId={setActiveCommId}\n              setSelectedIds={setSelectedIds}\n              setKeyboardMode={setKeyboardMode}\n            />\n\n            <Box className=\"panel-container\" sx={styles.panelContainer}>\n              <SearchComm\n                listRef={listRef}\n                setActiveCommId={setActiveCommId}\n                setUniformContent={setUniformContent}\n              />\n              <NumberPanel\n                uniformContent={uniformContent}\n                activeCommId={activeCommId}\n                selectedIds={selectedIds}\n                keyboardMode={keyboardMode}\n                setKeyboardMode={setKeyboardMode}\n                setUniformContent={setUniformContent}\n              />\n            </Box>\n            <SettlementBar\n              setUniformContent={setUniformContent}\n              setSelectedIds={setSelectedIds}\n            />\n          </div>\n        </Box>\n\n        <Box className=\"right-platform\" sx={styles.rightPlatform}>\n          <CommGrid\n            listRef={listRef}\n            setActiveCommId={setActiveCommId}\n            setUniformContent={setUniformContent}\n          />\n        </Box>\n      </Container>\n    </Box>\n  )\n}\n\nconst styles = {\n  root: {\n    color: '#333333',\n    backgroundColor: 'background.paper',\n  },\n  container: {\n    '&.pos-platform-container': {\n      maxWidth: 1800,\n      display: 'flex',\n      flexWrap: 'wrap',\n      minHeight: 620,\n      px: 0,\n    },\n  },\n  leftPlatform: {\n    // height: 'calc(100vh - 0.75rem)',\n    height: 'calc(100vh - 2.5rem)',\n    display: 'flex',\n    flex: '0 0 100%',\n    flexDirection: 'column',\n    backgroundColor: 'background.paper',\n    boxShadow: 'inset -10px 0px 15px -10px #aaaaaa',\n    minWidth: 0,\n    '& .left-container': {\n      flex: '0 1 95%',\n      display: 'flex',\n      flexDirection: 'column',\n      width: '90%',\n      margin: '0 auto',\n      minHeight: 0,\n      minWidth: 0,\n    },\n    '@media (min-width: 960px)': {\n      flex: '0 0 60%',\n    },\n  },\n  rightPlatform: {\n    height: '100vh',\n    position: 'relative',\n    display: 'flex',\n    flex: '0 0 100%',\n    flexDirection: 'column',\n    bgcolor: 'secondary.main',\n    '@media (min-width: 960px)': {\n      flex: '0 0 40%',\n      height: 'calc(100vh - 2.5rem)',\n    },\n  },\n  panelContainer: {\n    flex: '0 1 40.875%',\n    display: 'flex',\n    minHeight: 0,\n  },\n}\n\nexport default withAuth()(PosPlatform)\n"],"sourceRoot":""}