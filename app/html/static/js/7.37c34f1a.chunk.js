(this["webpackJsonpbonvies-pos"]=this["webpackJsonpbonvies-pos"]||[]).push([[7],{253:function(e,t,a){"use strict";var n=a(5),c=a(0),r=a(54),i=a(2),s={shop:5,company:10,enterprise:15};t.a=function(e){return function(t){return Object(r.b)((function(e){return{auth:e.auth.authenticated,level:e.auth.level}}))((function(a){var r=a.auth,l=a.level,o=a.history;return Object(c.useEffect)((function(){r?e&&(!l||s[e]>s[l])&&o.push("/"):o.push("/signin")}),[r,l,o]),Object(i.jsx)(t,Object(n.a)({},a))}))}}},255:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return c}));var n=function(e,t){var a=new Date(e).getTime();return c("previous"===t?a-864e5:a+864e5)},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",a=new Date(e),n=a.getMonth()+1,c=n.toString().padStart(2,"0"),r=a.getDate(),i=r.toString().padStart(2,"0");return a.getFullYear().toString()+t+c+t+i}},260:function(e,t,a){"use strict";var n=a(7),c=a(10),r=a(3),i=a(5),s=a(16),l=a(0),o=a(54),d=a(102),m=a(11),b=a(248),u=a.n(b),p=a(45),j=a(268),f=a(313),x=a(355),h=a(244),O=a(245),g=a(356),v=a(2),y={display:"flex",padding:"0.5em 0 0.75em","& .input-field":{flex:"0 0 85%",color:"secondary.main",paddingRight:"0.5em",display:"flex",flexWrap:"wrap"},"& .input-wrapper":{flex:"0 0 50%",py:"0.375em",pr:"0.5em",display:"flex",alignItems:"center",flexWrap:"wrap",position:"relative","& span":{color:"error.light",fontSize:"0.75rem",position:"absolute",bottom:"0",transform:"translateY(50%)"}},"& label":{fontWeight:"bold",fontSize:"1.125rem"},"& input":{flexGrow:1,lineHeight:1.25,padding:"0 0.25em","&::placeholder":{fontSize:"0.875rem",letterSpacing:"0.04em"},"&.error::placeholder":{color:"error.light"}},"& input.input-md":{width:"calc(100% - 4em)"},"& input.input-sm":{width:"calc(100% - 6.5em)"},"& .submit-field":{flex:"0 0 15%",display:"flex",flexWrap:"wrap",justifyContent:"center","& .submitBtn":{flex:"0 0 100%",color:"background.paper",fontWeight:"bold",fontSize:"1.125rem",display:"inline-flex",justifyContent:"center",bgcolor:function(e){return e.palette.primary.main},borderRadius:"0.5em",borderBottomLeftRadius:0,borderBottomRightRadius:0,border:"none","&:hover":{bgcolor:function(e){return e.palette.primary.light}}},"& .newBtn":{flex:"0 0 100%",lineHeight:1.5,color:"background.paper",fontWeight:"bold",borderRadius:"0.5em",borderTopLeftRadius:0,borderTopRightRadius:0,bgcolor:"#6aabc3","&:hover":{bgcolor:"#72b9d3"}}}};t.a=Object(o.b)((function(e){return{auth:e.auth,members:e.members}}),{fetchMembers:d.b})((function(e){var t=e.auth,a=e.open,o=e.members,d=e.handleClose,b=e.fetchMembers,C=e.onSelectClick,k=Object(l.useState)({}),N=Object(s.a)(k,2),S=N[0],w=N[1],I=Object(l.useState)({}),P=Object(s.a)(I,2),W=P[0],z=P[1];Object(l.useEffect)((function(){a&&b()}),[a,b]);var R,M=function(e){var t=e.target,a=t.name,n=t.value,c=Object(i.a)(Object(i.a)({},S),{},Object(r.a)({},a,n));w(c)},L=function(){var e=Object(c.a)(Object(n.a)().mark((function e(a){var c,r,i,s;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!H()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,c={memberName:S.name,phone:S.phone},e.next=7,m.e.post("",c,{headers:{Authorization:"Bearer "+t.authenticated}});case 7:r=e.sent,console.log(r),b(),w({}),Object(p.c)("\u65b0\u589e\u6703\u54e1\u6210\u529f","success"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),Object(p.c)("\u932f\u8aa4: ".concat((null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.error)||"\u65b0\u589e\u6703\u54e1\u5931\u6557"),"error");case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e={};return S.phone?"0"!==S.phone[0]&&(e.phone="\u96fb\u8a71\u683c\u5f0f\u932f\u8aa4"):e.phone="\u96fb\u8a71\u70ba\u5fc5\u586b",S.name||(e.name="\u59d3\u540d\u70ba\u5fc5\u586b"),z(e),Object.keys(e).length>0};return Object(v.jsxs)(x.a,{id:"dialog-member",open:a,onClose:d,"aria-labelledby":"dialog-member",fullWidth:!0,maxWidth:"sm",PaperProps:{sx:{maxWidth:700}},children:[Object(v.jsxs)(h.a,{sx:{margin:0,padding:"0.375em 1.75em 0.25em",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.25rem",fontWeight:"bold"}},children:[Object(v.jsx)(j.a,{variant:"h6",children:"\u6703\u54e1\u9078\u53d6"}),d?Object(v.jsx)(O.a,{"aria-label":"close",onClick:d,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"#cb5c5c",padding:0},children:Object(v.jsx)(u.a,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(v.jsxs)(g.a,{sx:{padding:"0.25em 1.75em 2em",bgcolor:"background.paper"},children:[Object(v.jsxs)(h.a,{component:"form",sx:y,children:[Object(v.jsxs)("div",{className:"input-field",children:[Object(v.jsxs)("div",{className:"input-wrapper",children:[Object(v.jsx)("label",{children:"\u59d3\u540d : \xa0"}),Object(v.jsx)("input",{className:"input-md ".concat(W.name?"error":""),type:"text",name:"name",value:S.name||"",onChange:M,autoComplete:"off"}),W.name&&Object(v.jsx)("span",{children:W.name})]}),Object(v.jsxs)("div",{className:"input-wrapper",children:[Object(v.jsx)("label",{children:"\u96fb\u8a71 : \xa0"}),Object(v.jsx)("input",{className:"input-md ".concat(W.phone?"error":""),type:"text",name:"phone",value:S.phone||"",onChange:M,autoComplete:"off"}),W.phone&&Object(v.jsx)("span",{children:W.phone})]}),Object(v.jsxs)("div",{className:"input-wrapper",children:[Object(v.jsx)("label",{children:"\u5bf5\u7269 : \xa0"}),Object(v.jsx)("input",{className:"input-sm ".concat(W.petName?"error":""),type:"text",name:"petName",value:S.petName||"",onChange:M,autoComplete:"off"})]})]}),Object(v.jsxs)("div",{className:"submit-field",children:[Object(v.jsx)(f.a,{className:"submitBtn",type:"submit",onClick:function(e){e.preventDefault(),b(S),z({})},children:"\u641c\u5c0b"}),Object(v.jsx)(f.a,{className:"newBtn",variant:"contained",color:"primary",disableElevation:!0,onClick:L,children:"\u65b0\u589e"})]})]}),Object(v.jsxs)("div",{children:[Object(v.jsxs)(h.a,{sx:{display:"flex",bgcolor:"secondary.main","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},color:"background.paper",height:"1.75em"},"& .id-sec":{flex:"0 0 17.5%"},"& .name-sec":{flex:"0 0 17.5%"},"& .mobile-sec":{flex:"0 0 25%"},"& .tel-sec":{flex:"0 0 25%"},"& .select-sec":{flex:"0 0 15%",borderRight:"none"}},children:[Object(v.jsx)("div",{className:"id-sec",children:"\u4ee3\u78bc"}),Object(v.jsx)("div",{className:"name-sec",children:"\u6703\u54e1\u540d\u7a31"}),Object(v.jsx)("div",{className:"mobile-sec",children:"\u624b\u6a5f\u865f\u78bc"}),Object(v.jsx)("div",{className:"tel-sec",children:"\u4f4f\u5bb6\u865f\u78bc"}),Object(v.jsx)("div",{className:"select-sec"})]}),Object(v.jsx)(h.a,{sx:{maxHeight:"14rem",overflow:"overlay","& .list-item":{display:"flex","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},color:"secondary.main",height:"2em",overflow:"hidden",padding:"0 0.5em"},"&:nth-of-type(2n + 1)":{bgcolor:"#ececec"},"& .id-sec":{flex:"0 0 17.5%"},"& .name-sec":{flex:"0 0 17.5%"},"& .mobile-sec":{flex:"0 0 25%"},"& .tel-sec":{flex:"0 0 25%"},"& .select-sec":{flex:"0 0 15%",borderRight:"none",overflow:"hidden"}}},children:(R=o,R.map((function(e){return Object(v.jsxs)("div",{className:"list-item",children:[Object(v.jsx)("div",{className:"id-sec",children:Object(v.jsx)(j.a,{variant:"body1",noWrap:!0,children:e.memberCode||"-"})}),Object(v.jsx)("div",{className:"name-sec",children:Object(v.jsx)(j.a,{variant:"body1",noWrap:!0,title:e.memberName,children:e.memberName})}),Object(v.jsx)("div",{className:"mobile-sec",children:Object(v.jsx)(j.a,{variant:"body1",noWrap:!0,children:e.phone||"-"})}),Object(v.jsx)("div",{className:"tel-sec",children:Object(v.jsx)(j.a,{variant:"body1",noWrap:!0,children:e.homePhone||"-"})}),Object(v.jsx)("div",{className:"select-sec",onClick:function(){return C(e)},children:Object(v.jsx)(f.a,{sx:{minWidth:"3.5em",height:"1.75em",padding:"0",color:"background.paper",bgcolor:function(e){return e.palette.primary.main},"&:hover":{bgcolor:"#fabd5e"}},children:"\u9078\u53d6"})})]},e.id)})))})]})]})]})}))},261:function(e,t,a){"use strict";a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return d}));a(0);var n=a(244),c=a(277),r=a(314),i=a(2),s=function(e){return new Date(e).toLocaleString()},l=function(e){return e.map((function(e){var t;return Object(i.jsxs)("div",{className:"received-sec",children:[Object(i.jsx)("span",{children:"".concat(null===(t=e.SalePointPayment)||void 0===t?void 0:t.paymentName," : ")}),Object(i.jsx)("span",{className:"main-value",children:e.value})]},e.id)}))},o=function(e){var t=e.list;return Object(i.jsxs)(n.a,{className:"order-table",children:[Object(i.jsxs)("div",{className:"table-header",children:[Object(i.jsx)("div",{className:"serial-sec",children:"\u9805\u6b21"}),Object(i.jsx)("div",{className:"name-sec",children:"\u5546\u54c1\u540d\u7a31"}),Object(i.jsx)("div",{className:"clerk-sec",children:"\u670d\u52d9\u54e1"}),Object(i.jsx)("div",{className:"price-sec",children:"\u5b9a\u50f9"}),Object(i.jsx)("div",{className:"quantity-sec",children:"\u6578\u91cf"}),Object(i.jsx)("div",{className:"discount-sec",children:"\u6298\u6578"}),Object(i.jsx)("div",{className:"total-sec",children:"\u5408\u8a08"})]}),Object(i.jsx)("div",{className:"table-list",children:t.map((function(e,t){return Object(i.jsxs)("div",{className:"table-item",children:[Object(i.jsx)("div",{className:"serial-sec",children:t+1}),Object(i.jsx)("div",{className:"name-sec",children:e.stockMaster&&e.stockMaster.description||e.stockDescription}),Object(i.jsx)("div",{className:"clerk-sec",children:e.user}),Object(i.jsx)("div",{className:"price-sec",children:e.price}),Object(i.jsx)("div",{className:"quantity-sec",children:e.quantity}),Object(i.jsx)("div",{className:"discount-sec",children:e.price*e.quantity-e.subTotal||""}),Object(i.jsx)("div",{className:"total-sec",children:e.subTotal})]},e.id)}))})]})},d={"& .table-header":{display:"flex",color:"background.paper",backgroundColor:"#a4a4a4","& > div":{display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"0.25em 0.5em",wordBreak:"break-all",borderRight:function(e){return"1px solid ".concat(e.palette.background.paper)}},"& > div:last-child":{borderRight:"none"},"& .name-sec":{justifyContent:"flex-start",paddingLeft:"1.5em",paddingRight:"1.5em"}},"& .table-item":{display:"flex",color:"text.primary",backgroundColor:"background.darkPaper","&:nth-of-type(2n)":{backgroundColor:"background.paper"},"& > div":{display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"0.5em 0.5em",wordBreak:"break-all",borderRight:function(e){return"1px solid ".concat(e.palette.background.paper)}},"& > div:last-of-type":{borderRight:"none"},"& .name-sec":{justifyContent:"flex-start",paddingLeft:"1.5em",paddingRight:"1.5em"}},"& .serial-sec":{flex:"0 0 5%",minWidth:"2rem"},"& .name-sec":{flex:"1 0 auto"},"& .clerk-sec":{flex:"0 0 10%"},"& .price-sec":{flex:"0 0 10%"},"& .quantity-sec":{flex:"0 0 10%"},"& .discount-sec":{flex:"0 0 10%"},"& .total-sec":{flex:"0 0 10%"}};t.b=function(e){var t,a,m,b,u=e.order,p=(null===u||void 0===u||null===(t=u.salesPayments)||void 0===t||null===(a=t.find((function(e){return Boolean(e.creditCard)})))||void 0===a?void 0:a.creditCard)||{};return Object(i.jsxs)(r.a,{sx:{width:"100%",minHeight:"100%",overflow:"hidden","& .order-table":d},children:[Object(i.jsxs)(c.a,{container:!0,alignItems:"center",sx:{px:"0.5rem",py:"0.25rem",bgcolor:function(e){return e.palette.background.default}},children:[Object(i.jsxs)(c.a,{item:!0,xs:!0,children:[Object(i.jsxs)(c.a,{container:!0,children:[Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u65e5\u671f :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:s(u.date)})]}),Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u6703\u54e1 :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:u.memberInfo?"".concat(u.memberInfo.memberName," | ").concat(u.memberInfo.phone):"---"})]}),Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u92b7\u552e\u54e1 :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:u.salesman&&u.salesman.realName})]})]}),Object(i.jsxs)(c.a,{container:!0,children:[Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u9580\u5e02 :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:(null===u||void 0===u||null===(m=u.cashRegister)||void 0===m||null===(b=m.salePoint)||void 0===b?void 0:b.salePointName)||"-"})]}),Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u767c\u7968 :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:u.invoicePage?u.invoicePage.no:"\u7121\u767c\u7968\u8cc7\u8a0a"})]}),Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u670d\u52d9\u54e1 :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:u.user&&u.user.realName})]})]})]}),Object(i.jsx)(c.a,{item:!0,xs:"auto",children:u.no})]}),Object(i.jsx)(o,{list:u.salesDetails||[]}),Object(i.jsxs)(c.a,{container:!0,justifyContent:"space-between",alignItems:"center",sx:{p:"0.25rem",borderTop:function(e){return"1px solid ".concat(e.palette.divider)}},children:[Object(i.jsxs)(c.a,{item:!0,xs:"auto",container:!0,flexDirection:"column",children:[Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u4fe1\u7528\u5361\u865f\u672b\u56db\u78bc :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:p.cardNo?p.cardNo.replaceAll(" ","").slice(-4):"- - - -"})]}),Object(i.jsxs)(c.a,{item:!0,xs:!0,container:!0,children:[Object(i.jsx)(c.a,{item:!0,xs:"auto",children:"\u6388\u6b0a\u78bc :\xa0"}),Object(i.jsx)(c.a,{item:!0,xs:!0,className:"bold",children:p.approvalCode||"- - - -"})]})]}),Object(i.jsxs)(c.a,{item:!0,xs:"auto",children:[Object(i.jsx)(n.a,{className:"received-list",display:"inline-flex",sx:{"& > div":{pr:"1rem"},"& .main-value":{fontWeight:"bold"}},children:l(u.salesPayments||[])}),Object(i.jsxs)(n.a,{className:"total-sum",display:"inline-flex",sx:{fontSize:"1.25rem"},children:[Object(i.jsx)("span",{children:"\u7e3d\u91d1\u984d :\xa0"}),Object(i.jsx)("span",{className:"bold",children:"".concat(u?u.actualTotal:"- - -","\u5143")})]})]})]})]})}},269:function(e,t,a){"use strict";var n=a(12),c=a(7),r=a(10),i=a(16),s=a(0),l=a(54),o=a(248),d=a.n(o),m=a(266),b=a.n(m),u=a(277),p=a(314),j=a(268),f=a(355),x=a(244),h=a(245),O=a(356),g=a(362),v=a(313),y=a(315),C=a(351),k=a(2);var N=function(e){var t=e.salePoint,a=e.selectedSalePoints,n=e.handleSelectSalePoint;return Object(k.jsx)(y.a,{onClick:function(){return n(t)},children:Object(k.jsxs)(u.a,{container:!0,wrap:"nowrap",spacing:2,children:[Object(k.jsx)(u.a,{item:!0,container:!0,xs:"auto",alignItems:"center",children:Object(k.jsx)(C.a,{readOnly:!0,checked:a.some((function(e){return e.id===t.id}))})}),Object(k.jsx)(u.a,{item:!0,container:!0,xs:!0,alignItems:"center",zeroMinWidth:!0,children:Object(k.jsx)(j.a,{className:"salePoint-name",variant:"subtitle1",noWrap:!0,title:t.salePointName,children:t.salePointName})})]})})},S=a(11);var w={display:"flex",p:"1.5em 0 0rem",alignItems:"center",justifyContent:"flex-end","& .input-field":{flex:"0 0 30%",color:"secondary.main",paddingRight:"0.5em"},"& .input-wrapper":{padding:"0.375em 0"},"& label":{fontWeight:"bold",fontSize:"1.125rem"},"& input":{width:"calc(100% - 4em)",lineHeight:1.25,padding:"0 0.25em","&::placeholder":{fontSize:"0.875rem",letterSpacing:"0.04em"},"&.error::placeholder":{color:"error.light"}},"& .submit-field":{flex:"0 0 18%",display:"flex",flexWrap:"wrap",justifyContent:"center","& .submitBtn":{flex:"0 0 100%",fontWeight:"bold",fontSize:"1.125rem",display:"inline-flex",justifyContent:"center"},"& .primaryBtn":{color:"background.paper",bgcolor:function(e){return e.palette.primary.main},"&:hover":{bgcolor:function(e){return e.palette.primary.light}}}}};t.a=Object(l.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.auth,a=e.open,l=e.handleClose,o=e.onSalePointSelectClick,m=Object(s.useState)([]),y=Object(i.a)(m,2),C=y[0],I=y[1],P=Object(s.useState)([]),W=Object(i.a)(P,2),z=W[0],R=W[1];Object(s.useEffect)((function(){var e=function(){var e=Object(r.a)(Object(c.a)().mark((function e(){var a,n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.f.get("",{headers:{Authorization:"Bearer "+t.authenticated}});case 2:a=e.sent,n=a.data,I(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e(),function(){I([])}}),[t.authenticated]);var M=function(e){var t=z.some((function(t){return t.id===e.id}))?z.filter((function(t){return t.id!==e.id})):[].concat(Object(n.a)(z),[e]);R(t)};return Object(k.jsxs)(f.a,{id:"dialog-member",open:a,onClose:function(){R([]),l()},fullWidth:!0,maxWidth:"sm","aria-labelledby":"dialog-member",PaperProps:{sx:{maxWidth:800}},children:[Object(k.jsxs)(x.a,{sx:{margin:0,padding:"0.375em 1.75em 0.25em",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.25rem",fontWeight:"bold"}},children:[Object(k.jsx)(j.a,{variant:"h6",children:"\u9580\u5e02\u9078\u53d6"}),l?Object(k.jsx)(h.a,{"aria-label":"close",onClick:l,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"error.main",padding:0},children:Object(k.jsx)(d.a,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(k.jsxs)(O.a,{sx:{padding:"0.25em 1.75em 2em",bgcolor:"background.paper"},children:[Object(k.jsxs)(u.a,{container:!0,alignItems:"flex-start",sx:{mt:"1.5rem",p:"0.5rem 0.25rem",bgcolor:"#eeeeee",borderRadius:2,"& hr":{height:"unset"}},children:[Object(k.jsxs)(u.a,{xs:12,md:!0,item:!0,children:[Object(k.jsx)(j.a,{variant:"subtitle1",sx:{p:"0.25rem 0.5rem",fontWeight:"bold"},children:"\u9580\u5e02\u5217\u8868"}),Object(k.jsx)(u.a,{container:!0,sx:{px:"0.5rem",pb:"2rem",maxHeight:400,overflowY:"auto",display:"flex",gap:"1rem","& .MuiCard-root":{p:"1.5rem 1rem"},"& .salePoint-name":{flex:"0 0 100%"},"& .card-grid":{flex:"0 0 calc(50% - 0.5rem)",maxWidth:"calc(50% - 0.5rem)","& .MuiPaper-root":{bgcolor:"background.default"}}},children:function(e,t){return e.map((function(e){return Object(k.jsx)("div",{className:"card-grid",children:Object(k.jsx)(N,{salePoint:e,selectedSalePoints:z,handleSelectSalePoint:M})},e.id)}))}(C)})]}),Object(k.jsx)(g.a,{orientation:"vertical",variant:"middle",flexItem:!0,sx:{mx:"1rem"}}),Object(k.jsxs)(u.a,{xs:12,md:3,item:!0,children:[Object(k.jsx)(j.a,{variant:"subtitle1",sx:{p:"0.25rem 0.5rem",fontWeight:"bold"},children:"\u5df2\u9078\u53d6"}),Object(k.jsx)(u.a,{container:!0,direction:"column",wrap:"nowrap",sx:{pl:"0.25rem",pr:"0.5rem",maxHeight:400,overflowY:"auto","& .MuiPaper-root":{p:"1.5rem 2rem",mb:"1rem"},"& .salePoint-id":{pt:"0.25rem",color:"text.secondary"}},children:function(e){return e.map((function(e){return Object(k.jsx)(u.a,{item:!0,xs:12,children:Object(k.jsx)(p.a,{elevation:0,square:!0,children:Object(k.jsx)(j.a,{variant:"subtitle2",children:e.salePointName})})},e.id)}))}(z)})]})]}),Object(k.jsx)(x.a,{component:"form",sx:w,children:Object(k.jsx)("div",{className:"submit-field",children:Object(k.jsx)(v.a,{size:"large",className:"submitBtn primaryBtn",onClick:function(){o(z)},endIcon:Object(k.jsx)(b.a,{}),children:"\u78ba\u8a8d"})})})]})]})}))},275:function(e,t,a){"use strict";var n=a(90);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(a(91)),r=a(2),i=(0,c.default)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM6.5 9 10 5.5 13.5 9H11v4H9V9H6.5zm11 6L14 18.5 10.5 15H13v-4h2v4h2.5z"}),"SwapVerticalCircle");t.default=i},293:function(e,t,a){"use strict";var n=a(90);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(a(91)),r=a(2),i=(0,c.default)((0,r.jsx)("path",{d:"m14 7-5 5 5 5V7z"}),"ArrowLeft");t.default=i},294:function(e,t,a){"use strict";var n=a(90);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(a(91)),r=a(2),i=(0,c.default)((0,r.jsx)("path",{d:"m10 17 5-5-5-5v10z"}),"ArrowRight");t.default=i},295:function(e,t,a){"use strict";var n=a(90);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(a(91)),r=a(2),i=(0,c.default)((0,r.jsx)("path",{d:"M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5h-2zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4H6z"}),"PlayForWork");t.default=i},296:function(e,t,a){"use strict";var n=a(90);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=n(a(91)),r=a(2),i=(0,c.default)((0,r.jsx)("path",{d:"M17 2H7c-1.1 0-2 .9-2 2v2c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 4H7V4h10v2zm3 16H4c-1.1 0-2-.9-2-2v-1h20v1c0 1.1-.9 2-2 2zm-1.47-11.81C18.21 9.47 17.49 9 16.7 9H7.3c-.79 0-1.51.47-1.83 1.19L2 18h20l-3.47-7.81zM9.5 16h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm3 4h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5zm0-2h-1c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h1c.28 0 .5.22.5.5s-.22.5-.5.5z"}),"PointOfSale");t.default=i},346:function(e,t,a){"use strict";a.r(t);var n=a(16),c=a(0),r=a.n(c),i=a(244),s=a(357),l=a(54),o=a(47),d=a(2),m=Object(l.b)((function(e){return{currentMember:e.currentMember,visits:e.visits}}),{initialVisits:o.c,renewVisits:o.d})((function(e){var t=Object(c.useState)(""),a=Object(n.a)(t,2),r=a[0],s=a[1],l=Object(c.useState)(""),o=Object(n.a)(l,2),m=o[0],b=o[1],u=e.initialVisits,p=e.renewVisits,j=e.visits;Object(c.useEffect)((function(){f();var e=setInterval((function(){p(),f(),console.log("30s Passed.")}),3e4);return function(){clearInterval(e)}}),[p]),Object(c.useEffect)((function(){u()}),[u]);var f=function(){var e=new Date,t=e.toLocaleDateString(),a="\u661f\u671f"+e.getDay().toLocaleString("zh-Hant-TW-u-nu-hanidec"),n=e.toLocaleTimeString().slice(0,-3).replace("\u5348","\u5348 ");s(t+" "+a),b(n)},x=Object.keys(e.currentMember).length>0?"active":"";return Object(d.jsxs)(i.a,{component:"section",id:"info-header",sx:{flex:"0 1 5 %",display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"background.darkPaper",boxShadow:"inset -10px 0px 15px -10px #aaaaaa",padding:"0 2%","& .consumer-serial":{display:"inline-block",fontWeight:"bold",paddingRight:"2em"},"& .member-name":{display:"inline-block",fontWeight:"bold",color:"#c4c4c4"},"& .member-name.active span":{color:"#91bbcb",textShadow:function(e){return"1px 0px 1px ".concat(e.palette.background.default)}},"& .time-field":{fontSize:"0.875rem",display:"inline-block",fontWeight:"bold",textAlign:"right",color:"secondary.main"}},children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"consumer-serial",children:Object(d.jsxs)("span",{children:["\u5ba2\u6b21\xa0:\xa0",j.visitsNum]})}),Object(d.jsx)("div",{className:"member-name ".concat(x),children:Object(d.jsxs)("span",{children:["\u6703\u54e1\xa0:\xa0",e.currentMember.memberName]})})]}),Object(d.jsxs)("div",{className:"time-field",children:[Object(d.jsx)("div",{children:r}),Object(d.jsx)("div",{children:m})]})]})})),b=a(7),u=a(10),p=a(44),j=a(93),f=a(96),x=a(60),h=a(46),O=a(45),g=a(11),v=a(105),y=a(106),C=a(111),k=a(115),N=function(e){Object(C.a)(a,e);var t=Object(k.a)(a);function a(){return Object(v.a)(this,a),t.apply(this,arguments)}return Object(y.a)(a,[{key:"render",value:function(){return this.props.determineParam?this.props.children:null}}]),a}(r.a.Component),S=N,w=a(260),I=a(92),P=Object(I.a)(Object(d.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel"),W=Object(I.a)(Object(d.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore"),z=a(355),R=a(268),M=a(245),L=a(356),H=a(8),E=a(1),A=a(13),D=a(236),T=a(24),q=a(27),B=a(206),V=a(237);function F(e){return Object(B.a)("MuiDialogActions",e)}Object(V.a)("MuiDialogActions",["root","spacing"]);var Z=["className","disableSpacing"],G=Object(T.a)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:function(e,t){var a=e.ownerState;return[t.root,!a.disableSpacing&&t.spacing]}})((function(e){var t=e.ownerState;return Object(E.a)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})})),U=c.forwardRef((function(e,t){var a=Object(q.a)({props:e,name:"MuiDialogActions"}),n=a.className,c=a.disableSpacing,r=void 0!==c&&c,i=Object(H.a)(a,Z),s=Object(E.a)({},a,{disableSpacing:r}),l=function(e){var t=e.classes,a={root:["root",!e.disableSpacing&&"spacing"]};return Object(D.a)(a,F,t)}(s);return Object(d.jsx)(G,Object(E.a)({className:Object(A.a)(l.root,n),ownerState:s,ref:t},i))})),_=a(313),K=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],Y={display:"flex",color:"background.darkPaper",bgcolor:"secondary.main","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},paddingTop:"0.125em",paddingBottom:"0.125em"},"& .serial-sec":{flex:"0 0 5%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .time-sec":{flex:"0 0 30%"},"& .total-amount-sec":{flex:"0 0 12.5%"},"& .total-quantity-sec":{flex:"0 0 12.5%"},"& .member-name-sec":{flex:"0 0 17.5%"},"& .member-phone-sec":{flex:"0 0 17.5%"},"& .delete-sec":{flex:"0 0 5%",borderRight:"none"}},$={maxHeight:"8rem",overflow:"overlay","& .temp-item":{display:"flex",cursor:"pointer",userSelect:"none",bgcolor:"background.darkPaper","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",color:"secondary.main",height:"2em",padding:"0.25em",borderRight:"1px solid #f0f0f0",overflow:"overlay"},"&:nth-of-type(2n + 1)":{bgcolor:"#e6e6e6"},"& .serial-sec":{flex:"0 0 5%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .time-sec":{flex:"0 0 30%"},"& .total-amount-sec":{flex:"0 0 12.5%"},"& .total-quantity-sec":{flex:"0 0 12.5%"},"& .member-name-sec":{flex:"0 0 17.5%"},"& .member-phone-sec":{flex:"0 0 17.5%"},"& .delete-sec":{flex:"0 0 5%",borderRight:"none"},"&.active":{bgcolor:"active.main"},"& .delete-icon":{color:"#c4c4c4",fontSize:"1.125em"}}},J={display:"flex",color:"background.darkPaper",bgcolor:"secondary.main","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},paddingTop:"0.5em",paddingBottom:"0.5em"},"& .comm-name-sec":{flex:"0 0 45%",paddingLeft:"0.5em",paddingRight:"0.5em"},"& .serial-sec":{flex:"0 0 5%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .price-sec":{flex:"0 0 12.5%"},"& .quantity-sec":{flex:"0 0 12.5%"},"& .discount-sec":{flex:"0 0 12.5%"},"& .total-sec":{flex:"0 0 12.5%",borderRight:"none"}},Q={minHeight:"10rem",maxHeight:"10.5rem",overflow:"overlay","& .detail-item":{display:"flex",bgcolor:"background.darkPaper","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",color:"secondary.main",paddingTop:"0.5em",paddingBottom:"0.5em",borderRight:"1px solid #f0f0f0"},"&:nth-of-type(2n + 1)":{bgcolor:"#e6e6e6"},"& .serial-sec":{flex:"0 0 5%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .comm-name-sec":{flex:"0 0 45%",paddingLeft:"0.5em",paddingRight:"0.5em"},"& .price-sec":{flex:"0 0 12.5%"},"& .quantity-sec":{flex:"0 0 12.5%"},"& .discount-sec":{flex:"0 0 12.5%"},"& .total-sec":{flex:"0 0 12.5%",borderRight:"none"}}},X=Object(l.b)((function(e){return{tempOrders:e.tempOrders}}),{replacePosStrips:j.e,getTempOrderWithLocal:x.d,deleteTempOrderWithLocal:x.c,replaceCurrentTempOrderId:h.f,replaceCurrentMember:f.b})((function(e){var t=e.open,a=e.handleClose,r=e.replacePosStrips,s=e.tempOrders,l=e.getTempOrderWithLocal,o=e.deleteTempOrderWithLocal,m=e.replaceCurrentTempOrderId,b=e.replaceCurrentMember,u=Object(c.useState)(""),p=Object(n.a)(u,2),j=p[0],f=p[1];Object(c.useEffect)((function(){l()}),[l]),Object(c.useEffect)((function(){s[0]&&f(s[0].id)}),[s]);var x,h=function(e){var t=new Date(e),a=t.getFullYear().toString(),n=t.getMonth()+1,c=n>9?n.toString():"0"+n.toString(),r=t.getDate(),i=r>9?r.toString():"0"+r.toString(),s=K[t.getDay()],l=t.toLocaleTimeString().replace("\u5348","\u5348 0").slice(0,-3);return a+"/"+c+"/"+i+" ("+s+") "+(l.length>8?l.replace(" 01"," 1"):l)},O=s.find((function(e){return e.id===j}));return Object(d.jsxs)(z.a,{id:"dialog-temp-order",open:t,onClose:a,"aria-labelledby":"dialog-temp-order",fullWidth:!0,maxWidth:"md",children:[Object(d.jsxs)(i.a,{sx:{flex:"0 0 auto",margin:0,padding:"0.375em 1.75em 0.25em",lineHeight:1.6,letterSpacing:"0.0075rem",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"}},children:[Object(d.jsx)(R.a,{variant:"h6",children:"\u8a02\u55ae\u66ab\u5b58"}),a?Object(d.jsx)(M.a,{"aria-label":"close",onClick:a,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"error.main",padding:0},children:Object(d.jsx)(P,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(d.jsxs)(L.a,{sx:{padding:"0.5em 1.75em 0",bgcolor:"background.paper"},children:[Object(d.jsx)(R.a,{variant:"h6",sx:{color:function(e){return e.palette.primary.main},fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u66ab\u5b58\u6e05\u55ae"}),Object(d.jsxs)(i.a,{sx:Y,children:[Object(d.jsx)("div",{className:"serial-sec",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"time-sec",children:"\u66ab\u5b58\u6642\u9593"}),Object(d.jsx)("div",{className:"total-amount-sec",children:"\u7e3d\u91d1\u984d"}),Object(d.jsx)("div",{className:"total-quantity-sec",children:"\u7e3d\u6578\u91cf"}),Object(d.jsx)("div",{className:"member-name-sec",children:"\u6703\u54e1\u59d3\u540d"}),Object(d.jsx)("div",{className:"member-phone-sec",children:"\u6703\u54e1\u96fb\u8a71"}),Object(d.jsx)("div",{className:"delete-sec"})]}),Object(d.jsx)(i.a,{sx:$,children:function(e){return e.map((function(e,t){var a=j===e.id?" active":"";return Object(d.jsxs)("div",{className:"temp-item ".concat(a),onClick:function(){return t=e.id,void f(t);var t},children:[Object(d.jsx)("div",{className:"serial-sec",children:t+1}),Object(d.jsx)("div",{className:"time-sec",children:h(e.timestamp)}),Object(d.jsx)("div",{className:"total-amount-sec",children:e.totalAmount}),Object(d.jsx)("div",{className:"total-quantity-sec",children:e.totalQuantity}),Object(d.jsx)("div",{className:"member-name-sec",children:e.member.memberName}),Object(d.jsx)("div",{className:"member-phone-sec",children:e.member.phone}),Object(d.jsx)("div",{className:"delete-sec",onClick:function(){return o(e.id)},children:Object(d.jsx)(P,{className:"delete-icon"})})]},e.id)}))}(s)}),Object(d.jsx)("hr",{}),Object(d.jsx)(R.a,{variant:"h6",sx:{color:function(e){return e.palette.primary.main},fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u6e05\u55ae\u660e\u7d30"}),Object(d.jsxs)(i.a,{sx:J,children:[Object(d.jsx)("div",{className:"serial-sec",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"comm-name-sec",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"discount-sec",children:"\u6298\u6578"}),Object(d.jsx)("div",{className:"total-sec",children:"\u5408\u8a08"})]}),Object(d.jsx)(i.a,{sx:Q,children:O?(x=O.content,x.map((function(e,t){return Object(d.jsxs)("div",{className:"detail-item",children:[Object(d.jsx)("div",{className:"serial-sec",children:t+1}),Object(d.jsx)("div",{className:"comm-name-sec",children:e.stockName}),Object(d.jsx)("div",{className:"price-sec",children:e.price}),Object(d.jsx)("div",{className:"quantity-sec",children:e.quantity}),Object(d.jsx)("div",{className:"discount-sec",children:e.discount||" - "}),Object(d.jsx)("div",{className:"total-sec",children:e.total})]},e.id)}))):"\u7121\u8cc7\u6599"})]}),Object(d.jsx)(U,{sx:{padding:"1em 1.75em",bgcolor:"background.paper"},children:Object(d.jsx)(_.a,{onClick:function(){r(O.content),b(O.member||{}),m(j),a()},startIcon:Object(d.jsx)(W,{sx:{"&:first-of-type":{fontSize:"1.25em"}}}),sx:{display:"inline-flex",justifyContent:"center",fontSize:"1.375rem",fontWeight:"bold",borderRadius:"0.5em",border:"none",color:"background.paper",bgcolor:function(e){return e.palette.primary.main},minWidth:105,"&:hover":{bgcolor:"#fabd5e"}},children:"\u53d6\u56de"})})]})})),ee=a(5),te=a(3),ae=a(12),ne=a(42),ce=a(234),re=a(246),ie=Object(I.a)(Object(d.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),se=Object(I.a)(Object(d.jsx)("path",{d:"M7 8V5l-7 7 7 7v-3l-4-4 4-4zm6 1V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"}),"ReplyAll"),le=a(337),oe=a(351),de=a(102),me=a(69),be=a(255),ue={paddingTop:"1em","& .table-header":{display:"flex",height:"2em",color:"background.paper",fontSize:"1rem",bgcolor:"secondary.main"},"& .table-list":{maxHeight:"10rem",overflow:"overlay"},"& .no-data":{height:"10rem",display:"flex",alignItems:"center",justifyContent:"center",color:"text.disabled",bgcolor:"background.light",fontSize:"1.5rem",fontWeight:"bold"},"& .table-item":{display:"flex",color:"secondary.main",fontSize:"1rem",bgcolor:"background.light",cursor:"pointer"},"& .table-item:nth-of-type(2n + 1)":{bgcolor:"#ebebeb"},"& .table-item.active":{bgcolor:"active.main"},"& .sec-item":{display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25em"},"& .serial-sec":{flex:"0 0 20%",borderRight:"1px solid #eeeeee"},"& .member-sec":{flex:"0 0 80%"}},pe={display:"inline-block",paddingTop:"1em",width:"100%","& .table-header":{display:"flex",height:"2em",color:"background.paper",fontSize:"1rem",bgcolor:"secondary.main"},"& .table-list":{maxHeight:"10rem",overflow:"overlay"},"& .no-data":{height:"10rem",display:"flex",alignItems:"center",justifyContent:"center",color:"text.disabled",bgcolor:"background.light",fontSize:"1.5rem",fontWeight:"bold"},"& .table-item":{display:"flex",height:"3.33333em",color:"secondary.main",fontSize:"1rem",bgcolor:"background.light",cursor:"pointer",userSelect:"none"},"& .table-item:nth-of-type(2n + 1)":{bgcolor:"#ebebeb"},"& .table-item.active":{bgcolor:"active.main"},"& .sec-item":{py:"0.25em",px:"0.5em",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",borderRight:"1px solid #eeeeee",minWidth:0},"& .checkbox-sec":{flex:"0 0 6%"},"& .serial-sec":{flex:"0 0 7%"},"& .id-sec":{flex:"1 0 16%",wordBreak:"break-all",flexDirection:"column"},"& .id-sec > div":{width:"100%"},"& .member-sec":{flex:"1 0 16%",wordBreak:"break-all",flexDirection:"column"},"& .member-sec > div":{width:"100%"},"& .pet-sec":{flex:"0 0 13%"},"& .clerk-sec":{flex:"0 0 13%"},"& .total-sec":{flex:"0 0 13%"},"& .actual-total-sec":{flex:"0 0 13%"},"& .checkbox-color":{color:"#c4c4c4"}},je={pt:"0.25rem",pb:"0.5rem","& .table-header":{display:"flex",height:"2em",color:"background.paper",fontSize:"1rem",bgcolor:"secondary.main"},"& .table-list":{maxHeight:"11.5rem",overflow:"overlay","&.consistent":{minHeight:"11.5rem"}},"& .no-data":{height:"11.5rem",display:"flex",alignItems:"center",justifyContent:"center",color:"text.disabled",bgcolor:"#fffcf7",fontSize:"1.5rem",fontWeight:"bold"},"& .table-item":{display:"flex",color:"secondary.main",fontSize:"1rem",bgcolor:"#ffffff",userSelect:"none"},"& .table-item:nth-of-type(2n + 1)":{bgcolor:"#fffcf7"},"& .table-item.active":{bgcolor:"active.main"},"& .sec-item":{display:"flex",alignItems:"center",justifyContent:"center",padding:"0.5em 0",borderRight:"1px solid #eeeeee"},"& .serial-sec":{flex:"0 0 5%"},"& .comm-name-sec":{flex:"0 0 32.5%",padding:"0.5em"},"& .price-sec":{flex:"0 0 10%"},"& .quantity-sec":{flex:"0 0 10%"},"& .discount-sec":{flex:"0 0 10%"},"& .total-sec":{flex:"0 0 12.5%"}},fe=Object(l.b)((function(e){return{members:e.members,externalOrders:e.externalOrders,activeExternalOrder:e.activeExternalOrder,selectedExternalOrders:e.selectedExternalOrders}}),{replacePosStrips:j.e,replaceExternalOrders:me.i,replaceActiveExternalOrder:me.h,fetchExternalOrders:me.f,fetchActiveExternalOrder:me.e,addSelectedExternalOrder:me.b,removeSelectedExternalOrder:me.g,clearSelectedExternalOrders:me.c,selectAllExternalOrders:me.j,replaceCurrentExternalOrderId:h.d,replaceCurrentMember:f.b,fetchMembers:de.b})((function(e){var t=e.open,a=e.members,s=e.externalOrders,l=e.activeExternalOrder,o=e.selectedExternalOrders,m=e.replacePosStrips,b=e.fetchExternalOrders,u=e.fetchActiveExternalOrder,p=e.addSelectedExternalOrder,j=e.removeSelectedExternalOrder,f=e.clearSelectedExternalOrders,x=e.selectAllExternalOrders,h=e.replaceExternalOrders,g=e.replaceActiveExternalOrder,v=e.replaceCurrentExternalOrderId,y=e.replaceCurrentMember,C=e.fetchMembers,k=e.handleClose,N=Object(ne.a)(),S=Object(c.useState)(""),w=Object(n.a)(S,2),I=w[0],W=w[1],H=Object(c.useState)(""),E=Object(n.a)(H,2),A=E[0],D=E[1],T=Object(c.useState)(!1),q=Object(n.a)(T,2),B=q[0],V=q[1],F=Object(c.useState)(""),Z=Object(n.a)(F,2),G=Z[0],U=Z[1];Object(c.useEffect)((function(){return function(){g({})}}),[g]),Object(c.useEffect)((function(){return function(){f()}}),[f]),Object(c.useEffect)((function(){C()}),[C]),Object(c.useEffect)((function(){a[0]?(U(a[0].id),b({isSales:!1,memberId:a[0].id})):(h([]),g({}))}),[a,b,h,g]),Object(c.useEffect)((function(){s[0]?u({id:s[0].id}):g({}),V(!1),f()}),[s,u,g,f]);var K,Y=Object(c.useMemo)((function(){return o.reduce((function(e,t){return t.tempSalesDetails?[].concat(Object(ae.a)(e),Object(ae.a)(t.tempSalesDetails)):e}),[])}),[o]),$=function(e){U(e),b({isSales:!1,memberId:e})},J=function(e){var t=e.currentTarget.dataset.changeType;I&&W(Object(be.a)(I,t))},Q=function(e){u({id:e})},X=function(e){return e.map((function(e){return Object(ee.a)(Object(ee.a)({},e),{},{tempSalesDetailsId:e.id,stockName:e.stockName||e.stockDescription,price:e.price||e.salePrice,originalTotal:e.price?e.price*e.quantity:e.salePrice*e.quantity,discount:((e.price-e.salePrice)*e.quantity).toString(),total:e.subTotal})}))},de=function(e){return function(t){t.target.checked?p(e):j(e.id)}},me=function(e){return e.map((function(e,t){return Object(d.jsx)(le.a,{direction:"left",children:Object(d.jsxs)("div",{className:"table-item",tabIndex:0,children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:t+1}),Object(d.jsx)("div",{className:"comm-name-sec sec-item",children:e.stockName||e.stockDescription}),Object(d.jsx)("div",{className:"price-sec sec-item",children:e.price}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:e.quantity}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:e.price*e.quantity-e.subTotal}),Object(d.jsx)("div",{className:"total-sec sec-item",children:e.subTotal})]})},e.id)}))};return Object(d.jsxs)(z.a,{id:"dialog-info-import",open:t,onClose:k,"aria-labelledby":"dialog-info-import",fullWidth:!0,PaperProps:{sx:{maxWidth:1300}},children:[Object(d.jsxs)(i.a,{sx:{flex:"0 0 auto",margin:0,padding:"0.375em 1.75em 0.25em",lineHeight:1.6,letterSpacing:"0.0075rem",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.25rem",fontWeight:"bold"}},children:[Object(d.jsx)(R.a,{variant:"h6",children:"\u8cc7\u6599\u532f\u5165"}),k?Object(d.jsx)(M.a,{"aria-label":"close",onClick:k,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"#cb5c5c",padding:0},children:Object(d.jsx)(P,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(d.jsxs)(L.a,{sx:{padding:"0.5em 1.75em 2em",bgcolor:"background.darkPaper"},children:[Object(d.jsxs)(i.a,{className:"top-content",sx:{display:"flex",paddingBottom:"1.5em",borderBottom:"1px solid #c4c4c4",overflow:"auto"},children:[Object(d.jsxs)(i.a,{className:"member-field",sx:{flex:"0 0 30%",minWidth:0,"& label":{color:"secondary.main"}},children:[Object(d.jsx)(R.a,{variant:"h6",sx:{color:function(e){return e.palette.primary.main},fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u6703\u54e1\u641c\u5c0b"}),Object(d.jsx)("label",{children:"\u96fb\u8a71/\u59d3\u540d\xa0:"}),Object(d.jsxs)(i.a,{className:"member-input-wrapper",component:"form",onSubmit:function(e){return e.preventDefault()},sx:{display:"flex",alignItems:"center","& .member-input":{flexGrow:1,border:"0.5px solid #c4c4c4",minWidth:0},"& .submit-btn":{py:0,px:"1rem",ml:"0.5rem",borderRadius:1,fontSize:"1rem",bgcolor:"primary.light",color:"background.paper",minWidth:"unset","&:hover":{bgcolor:Object(ce.a)(N.palette.primary.main,.8)}}},children:[Object(d.jsx)("input",{className:"member-input",type:"text",value:A,onChange:function(e){D(e.target.value)}}),Object(d.jsx)(_.a,{className:"submit-btn",onClick:function(){var e=A&&" "!==A[1]&&!Number.isNaN(Number(A[1]))?"phone":"name";C(Object(te.a)({},e,A))},type:"submit",children:"\u641c\u5c0b"})]}),Object(d.jsxs)(i.a,{className:"member-table",sx:ue,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"member-sec sec-item",children:"\u6703\u54e1"})]}),Object(d.jsx)("div",{className:"table-list",children:a.length>0?function(e){return e.map((function(e,t){var a=e.id===G?"active":"";return Object(d.jsxs)("div",{onClick:function(){return $(e.id)},onKeyUp:function(t){return function(e,t){"Enter"===e.code&&$(t)}(t,e.id)},className:"table-item ".concat(a),tabIndex:0,children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:t+1}),Object(d.jsx)("div",{className:"member-sec sec-item",children:e.memberName+" | "+e.phone})]},e.id)}))}(a):Object(d.jsx)("div",{className:"no-data",children:"\u7121\u6703\u54e1\u8cc7\u6599"})})]})]}),Object(d.jsxs)(i.a,{className:"order-field",sx:{flex:"0 0 70%",paddingLeft:"2em",minWidth:0},children:[Object(d.jsxs)(i.a,{sx:{display:"inline-flex",justifyContent:"space-between",width:"100%"},children:[Object(d.jsxs)(i.a,{className:"info-input-container",sx:{flex:"1 0 40%","& label":{color:"secondary.main"}},children:[Object(d.jsx)(R.a,{variant:"h6",sx:{color:function(e){return e.palette.primary.main},fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u8cc7\u6599\u6e05\u55ae"}),Object(d.jsx)("label",{children:"\u65e5\u671f\xa0:"}),Object(d.jsxs)(i.a,{component:"form",onSubmit:function(e){return e.preventDefault()},className:"date-input-wrapper",sx:{display:"flex",alignItems:"center","& .date-input":{flexGrow:1,border:"0.5px solid #c4c4c4",minWidth:0,maxWidth:"15rem"},"& .submit-btn":{py:0,px:"1rem",mr:"0.5rem",borderRadius:1,fontSize:"1rem",bgcolor:"primary.light",color:"background.paper",minWidth:"unset","&:hover":{bgcolor:Object(ce.a)(N.palette.primary.main,.8)}}},children:[Object(d.jsx)("input",{type:"date",name:"startDate",className:"date-input",value:I||"",onChange:function(e){W(e.target.value)}}),Object(d.jsx)(M.a,{size:"small",onClick:J,"data-change-type":"previous",children:Object(d.jsx)(ie,{fontSize:"small",className:"previous-btn",sx:{color:"#767676",transform:"rotateZ(180deg)",cursor:"pointer","&:active":{color:"#333333"}}})}),Object(d.jsx)(M.a,{size:"small",onClick:J,"data-change-type":"next",children:Object(d.jsx)(ie,{fontSize:"small",className:"next-btn",sx:{color:"#767676",cursor:"pointer","&:active":{color:"#333333"}}})}),Object(d.jsx)(_.a,{type:"submit",className:"submit-btn",onClick:function(){if(I)return G?void b(Object(ee.a)({isSales:!1,memberId:G},I&&{startDate:I,endDate:I})):O.b.fire({title:"\u63d0\u9192: \u672a\u9078\u64c7\u6703\u54e1",target:document.querySelector(".MuiDialog-root")})},children:"\u641c\u5c0b"}),Object(d.jsx)(_.a,{type:"submit",className:"submit-btn",onClick:function(){I&&b(Object(ee.a)({isSales:!1},I&&{startDate:I,endDate:I}))},children:"\u65e5\u671f\u641c\u5c0b"})]})]}),Object(d.jsx)(i.a,{className:"import-submit-container",sx:{flex:"0 0 30%",display:"flex",alignItems:"flex-end",justifyContent:"flex-end"},children:Object(d.jsx)(_.a,{tabIndex:1,onClick:function(){if(o.length>0)y(o[0].memberInfo||{}),m(X(Y)),v(o.map((function(e){return e.id})).join(","));else{if(!(Object.keys(l).length>0))return O.b.fire({title:"\u63d0\u9192: \u7121\u9078\u64c7\u7684\u8a02\u55ae",target:document.querySelector(".MuiDialog-root")});y(l.memberInfo||{}),m(X(l.tempSalesDetails)),v(l.id)}k()},startIcon:Object(d.jsx)(se,{sx:{"&:first-of-type":{fontSize:"1.25em",transform:"rotateY(180deg)"}}}),sx:{display:"inline-flex",justifyContent:"center",fontSize:"1.375rem",fontWeight:"bold",borderRadius:"0.5em",border:"none",color:"background.paper",bgcolor:N.palette.primary.main,minWidth:"105px","&:hover":{bgcolor:Object(ce.a)(N.palette.primary.main,.8)}},children:"\u532f\u5165"})})]}),Object(d.jsxs)(i.a,{className:"order-table",sx:pe,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"checkbox-sec sec-item",children:Object(d.jsx)(oe.a,{className:"checkbox-color",checked:B,onChange:function(){B?(f(),V(!1)):(x(s),V(!0))},color:"default",size:"small"})}),Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"id-sec sec-item",children:"\u65e5\u671f - \u55ae\u865f"}),Object(d.jsx)("div",{className:"member-sec sec-item",children:"\u6703\u54e1 - \u96fb\u8a71"}),Object(d.jsx)("div",{className:"pet-sec sec-item",children:"\u5bf5\u7269"}),Object(d.jsx)("div",{className:"clerk-sec sec-item",children:"\u670d\u52d9\u4eba\u54e1"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:"\u7e3d\u548c"}),Object(d.jsx)("div",{className:"actual-total-sec sec-item bold",children:"\u7e3d\u91d1\u984d"})]}),Object(d.jsx)(i.a,{className:"table-list",children:s.length>0?Object(d.jsx)(re.a,{children:(K=s,K.map((function(e,t){var a=e.id===l.id?"active":"";return console.log("order.pet",e.pet),console.log("order.memberInfo",e.memberInfo),Object(d.jsx)(le.a,{direction:"left",children:Object(d.jsxs)("div",{tabIndex:0,className:"table-item ".concat(a),onClick:function(){return Q(e.id)},onKeyUp:function(t){return function(e,t){"Enter"===e.code&&Q(t)}(t,e.id)},children:[Object(d.jsx)("div",{className:"checkbox-sec sec-item",children:Object(d.jsx)(oe.a,{className:"checkbox-color",checked:o.some((function(t){return t.id===e.id})),onChange:de(e),onClick:function(e){return e.stopPropagation()},onKeyUp:function(e){return e.stopPropagation()},color:"default",size:"small"})}),Object(d.jsx)("div",{className:"serial-sec sec-item",children:t+1}),Object(d.jsxs)("div",{className:"id-sec sec-item",children:[Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"body1",noWrap:!0,children:new Date(e.date).toLocaleDateString()})}),Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"body1",noWrap:!0,title:e.no,children:e.no})})]}),Object(d.jsx)("div",{className:"member-sec sec-item",children:e.memberInfo?Object(d.jsxs)(c.Fragment,{children:[Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"body1",noWrap:!0,children:e.memberInfo.memberName})}),Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"body1",noWrap:!0,title:e.memberInfo.phone,children:e.memberInfo.phone})})]}):"-"}),Object(d.jsx)("div",{className:"pet-sec sec-item",children:e.pet?e.pet.petName:"-"}),Object(d.jsx)("div",{className:"clerk-sec sec-item",children:e.user?e.user.realName:"-"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:e.total}),Object(d.jsx)("div",{className:"actual-total-sec sec-item bold",children:e.actualTotal})]})},e.id)})))}):Object(d.jsx)(le.a,{in:s.length<=0,direction:"left",children:Object(d.jsx)("div",{className:"no-data",children:"\u7121\u6e05\u55ae\u8cc7\u6599"})})})]})]})]}),Object(d.jsxs)(i.a,{className:"bottom-content",sx:{paddingTop:"0.5em"},children:[Object(d.jsx)(R.a,{variant:"h6",sx:{color:N.palette.primary.main,fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u8cc7\u6599\u660e\u7d30"}),Object(d.jsxs)(i.a,{className:"detail-table",sx:je,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"comm-name-sec sec-item",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec sec-item",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:"\u6298\u6263"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:"\u5408\u8a08"})]}),Object(d.jsx)("div",{className:"table-list consistent",children:Object.keys(l).length>0&&l.tempSalesDetails?Object(d.jsx)(re.a,{children:me(l.tempSalesDetails)}):Object(d.jsx)(le.a,{in:Object.keys(l).length<=0||!l.tempSalesDetails,direction:"left",children:Object(d.jsx)("div",{className:"no-data",children:"\u7121\u6e05\u55ae\u8cc7\u6599"})})})]}),Object.keys(o).length>0&&Object(d.jsxs)(r.a.Fragment,{children:[Object(d.jsx)(R.a,{variant:"h6",sx:{color:N.palette.primary.main,fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u5df2\u9078\u53d6\u660e\u7d30"}),Object(d.jsxs)(i.a,{className:"detail-table",sx:je,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"comm-name-sec sec-item",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec sec-item",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:"\u5408\u8a08"})]}),Object(d.jsx)("div",{className:"table-list",children:Object(d.jsx)(re.a,{children:me(Y)})})]})]})]})]})]})})),xe=Object(l.b)((function(e){return{auth:e.auth,posStrips:e.posStrips,posStripsSum:e.posStripsSum,currentMember:e.currentMember,currentSalesmanId:e.currentSalesmanId,currentTempOrderId:e.currentTempOrderId,currentExternalOrderId:e.currentExternalOrderId}}),{addTempOrderWithLocal:x.a,replacePosStrips:j.e,replaceCurrentTempOrderId:h.f,replaceCurrentMember:f.b,replaceCurrentExternalOrderId:h.d,replaceCurrentSalesmanId:h.e})((function(e){var t=e.auth,a=e.setSelectedIds,r=e.posStrips,s=e.posStripsSum,l=e.currentMember,o=e.currentTempOrderId,m=e.currentExternalOrderId,j=e.currentSalesmanId,f=e.addTempOrderWithLocal,x=e.replacePosStrips,h=e.replaceCurrentTempOrderId,v=e.replaceCurrentMember,y=e.replaceCurrentExternalOrderId,C=e.replaceCurrentSalesmanId,k=Object(c.useState)(!1),N=Object(n.a)(k,2),I=N[0],P=N[1],W=Object(c.useState)(!1),z=Object(n.a)(W,2),R=z[0],M=z[1],L=Object(c.useState)(!1),H=Object(n.a)(L,2),E=H[0],A=H[1],D=Object(c.useState)([]),T=Object(n.a)(D,2),q=T[0],B=T[1];Object(c.useEffect)((function(){var e=function(){var e=Object(u.a)(Object(b.a)().mark((function e(){var a,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.h.get("",{headers:{Authorization:"Bearer "+t.authenticated},params:{limit:"zero"}});case 2:a=e.sent,n=a.data,B(n.list);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t.authenticated]);var V=function(){return!m||(O.b.fire({title:"\u8acb\u5148\u53d6\u6d88\u532f\u5165",target:document.querySelector(".right-platform")}),!1)},F=q.map((function(e){return Object(d.jsx)("option",{value:e.userId,children:e.realName},e.userId)}));return Object(d.jsxs)(i.a,{component:"section",id:"control-bar",sx:{flex:"0 0 6.125 %",display:"flex",alignItems:"center",justifyContent:"space-between",bgcolor:"background.paper",padding:"0.5em 0 0.25em","& .salesperson-field":{display:"flex",flexWrap:"wrap"},"& select":{fontSize:"1rem",width:"5.5em",height:"1.5em",padding:"0 0.25em",outline:"none",appearance:"none",backgroundPosition:"right 0.25em top 50%",backgroundSize:"contain",backgroundRepeat:"no-repeat",marginTop:"0.25em",marginBottom:"0.25em"},"& select.salesperson-selector":{color:"primary.main",bgcolor:"background.paper",borderRadius:"0.125rem",textAlign:"center",textOverflow:"ellipsis",border:function(e){return"1px solid ".concat(e.palette.primary.main)}},"& select.split-account-selector":{color:"#626262",border:"1px solid #aaaaaa",borderRadius:"0.125rem",backgroundImage:'url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%23aaaaaa%22%20d%3D%22M7%2010l5%205%205-5z%22%2F%3E%3C%2Fsvg%3E")'},"& input":{fontSize:"1rem",lineHeight:1.5,textAlign:"center",verticalAlign:"middle",backgroundColor:"transparent",border:"1px solid transparent",userSelect:"none",padding:"0.05em 0.5em",margin:"0.25em 0",transition:"all 0.2s ease-out","&:hover":{bgcolor:"#f2f2f2"}},"& input.smooth-btn":{color:"#aaaaaa",border:"1px solid #aaaaaa",marginRight:"0.75em",borderRadius:"0.25rem","&.active":{color:"background.paper",backgroundColor:"#6aa1da",border:function(e){return"1px solid ".concat(e.palette.background.paper)}},"&.block":{color:"background.paper",backgroundColor:"#ebebeb",border:function(e){return"1px solid ".concat(e.palette.background.paper)}},"&:last-of-type":{mr:0}}},children:[Object(d.jsx)("div",{className:"salesperson-field",children:Object(d.jsxs)("select",{className:"salesperson-selector",value:j,onChange:function(e){C(e.target.value)},children:[Object(d.jsx)("option",{value:"",disabled:!0,children:"\u92b7\u552e\u54e1"}),F]})}),Object(d.jsxs)("div",{children:[m?Object(d.jsx)("input",{className:"smooth-btn active",type:"button",value:"\u53d6\u6d88\u532f\u5165",onClick:function(){x([]),v({}),y("")}}):Object(d.jsx)("input",{className:"smooth-btn ".concat(o?"block":""),type:"button",value:"\u8cc7\u6599\u532f\u5165",onClick:function(){if(o)return O.b.fire({title:"\u8acb\u5148\u53d6\u6d88\u66ab\u5b58",target:document.querySelector(".right-platform")});A(!0)}}),Object(d.jsx)(S,{determineParam:E,children:Object(d.jsx)(fe,{open:E,handleClose:function(){return A(!1)}})}),Object.keys(l).length>1?Object(d.jsx)("input",{className:"smooth-btn ".concat(m?"block":"active"),type:"button",value:"\u53d6\u6d88\u6703\u54e1",onClick:function(){V()&&v({})}}):Object(d.jsx)("input",{className:"smooth-btn ".concat(m?"block":""),type:"button",value:"\u2003\u6703\u54e1\u2003",onClick:function(){V()&&P(!0)}}),Object(d.jsx)(S,{determineParam:I,children:Object(d.jsx)(w.a,{open:I,onSelectClick:function(e){v(e),P(!1)},handleClose:function(){return P(!1)}})}),o?Object(d.jsx)("input",{className:"smooth-btn active",type:"button",value:"\u53d6\u6d88\u66ab\u5b58",onClick:function(){x([]),v({}),h("")}}):Object(d.jsx)("input",{className:"smooth-btn ".concat(m?"block":""),type:"button",value:"\u9078\u53d6\u66ab\u5b58",onClick:function(){V()&&M(!0)}}),Object(d.jsx)(S,{determineParam:R,children:Object(d.jsx)(X,{open:R,handleClose:function(){return M(!1)}})}),Object(d.jsx)("input",{className:"smooth-btn ".concat(m?"block":""),type:"button",value:"\u52a0\u5165\u66ab\u5b58",onClick:function(){if(V()){if(r.length<1)return O.b.fire({title:"\u8acb\u81f3\u5c11\u6709\u4e00\u9805\u5546\u54c1",target:document.querySelector(".right-platform")});var e={id:Object(p.a)(),timestamp:Date.now(),totalQuantity:s.quantity,totalAmount:s.total,member:l,content:r};f(e),a([]),x([]),v({}),h(""),O.b.fire({icon:"success",title:"\u5df2\u52a0\u5165\u66ab\u5b58",target:document.querySelector(".right-platform")})}}})]})]})})),he=a(147),Oe=a(248),ge=a.n(Oe),ve=a(109),ye=a(32),Ce=function(e){var t=new RegExp("^%\\d{0,2}$").test(e),a=new RegExp("^\\d*\\d$").test(e);return t?"percentage":a?"constant":""},ke=function(e,t,a){var n=0;if("percentage"===t){var c=a.replace("%","."),r=Number(c);Number.isNaN(r)||(n=(1-r)*e.price)}return"constant"===t&&(n=Number(a)),n},Ne=function(e){var t=e.price*e.quantity;if(e.discount){var a=Ce(e.discount),n=ke(e,a,e.discount),c="percentage"===a||"single"===ye.b?e.quantity:1;t=Math.ceil(t-n*c)}return Object(ee.a)(Object(ee.a)({},e),{},{originalTotal:e.price*e.quantity,salePrice:t/e.quantity,total:t})},Se=function(){return Object(d.jsx)(he.a,{viewBox:"0 0 22 19",children:Object(d.jsx)("path",{d:"M0.78125 4.02008H21.0938C21.5252 4.02008 21.875 3.70175 21.875 3.30902V1.53137C21.875 1.13864 21.5252 0.820312 21.0938 0.820312H0.78125C0.349756 0.820312 0 1.13864 0 1.53137V3.30902C0 3.70175 0.349756 4.02008 0.78125 4.02008ZM0.78125 11.1307H21.0938C21.5252 11.1307 21.875 10.8123 21.875 10.4196V8.64197C21.875 8.24924 21.5252 7.93091 21.0938 7.93091H0.78125C0.349756 7.93091 0 8.24924 0 8.64197V10.4196C0 10.8123 0.349756 11.1307 0.78125 11.1307ZM0.78125 18.2413H21.0938C21.5252 18.2413 21.875 17.9229 21.875 17.5302V15.7526C21.875 15.3598 21.5252 15.0415 21.0938 15.0415H0.78125C0.349756 15.0415 0 15.3598 0 15.7526V17.5302C0 17.9229 0.349756 18.2413 0.78125 18.2413Z",fill:"#FAFAFA"})})},we=function(){return Object(d.jsx)(he.a,{viewBox:"0 0 15 23",children:Object(d.jsx)("path",{d:"M10.2131 10.3726L4.93964 8.96824C4.32929 8.80825 3.90448 8.28829 3.90448 7.71055C3.90448 6.98616 4.54901 6.39954 5.34491 6.39954H8.58222C9.17793 6.39954 9.76387 6.56397 10.2521 6.86617C10.55 7.04838 10.9504 7.00394 11.2043 6.77729L12.9035 5.26628C13.2502 4.95964 13.2014 4.44857 12.8156 4.17747C11.6193 3.3242 10.1252 2.84868 8.59199 2.84424V0.71106C8.59199 0.319977 8.24043 0 7.81074 0L6.24823 0C5.81855 0 5.46698 0.319977 5.46698 0.71106V2.84424H5.34491C2.23455 2.84424 -0.265451 5.27517 0.0226352 8.15941C0.227714 10.2081 1.94647 11.8747 4.11444 12.4524L9.11933 13.7857C9.72969 13.9501 10.1545 14.4656 10.1545 15.0434C10.1545 15.7677 9.50996 16.3544 8.71406 16.3544H5.47675C4.88104 16.3544 4.29511 16.1899 3.80682 15.8877C3.50897 15.7055 3.10858 15.75 2.85467 15.9766L1.15545 17.4876C0.80877 17.7943 0.857598 18.3053 1.24334 18.5764C2.43963 19.4297 3.93378 19.9052 5.46698 19.9097V22.0428C5.46698 22.4339 5.81855 22.7539 6.24823 22.7539H7.81074C8.24043 22.7539 8.59199 22.4339 8.59199 22.0428V19.9008C10.8674 19.8608 13.0012 18.6298 13.7531 16.6699C14.8029 13.9323 13.0402 11.1236 10.2131 10.3726Z",fill:"#FAFAFA"})})},Ie=function(){return Object(d.jsx)(he.a,{children:Object(d.jsx)("path",{d:"M8.48629 0C13.2778 0 17 3.69819 17 8.5C17 13.5452 12.9385 17 8.48629 17C3.87641 17 0 13.2024 0 8.5C0 3.94496 3.58851 0 8.48629 0ZM1.9125 6.20706C1.65887 6.90625 1.53206 7.67056 1.53206 8.5C1.53206 12.301 4.68871 15.4371 8.51371 15.4371C12.7089 15.4371 14.5871 11.948 14.6317 11.8692L11.4304 10.4433C11.1665 11.7149 10.0183 12.2599 9.09294 12.3421V13.648H8.10585V12.3387C7.16331 12.3284 6.30302 11.9891 5.525 11.3208L6.69375 10.1383C7.78024 11.146 9.65504 11.2282 9.65504 10.0629C9.65504 9.8504 9.57964 9.67903 9.42883 9.54536C8.94214 9.33972 9.36714 9.54194 1.9125 6.20706ZM8.51371 1.51835C7.19758 1.51835 4.66129 1.81653 2.66996 4.70585L5.91915 6.1625C6.2619 5.08972 7.30383 4.69214 8.10585 4.64415V3.33831H9.09294V4.64415C9.87097 4.68528 10.5804 4.94919 11.2179 5.43246L10.1109 6.57036C8.64738 5.54556 7.24899 6.29617 7.71169 6.95081C9.54194 7.77681 9.2129 7.62944 10.8992 8.37661L15.2554 10.32C15.396 9.72359 15.4679 9.11694 15.4679 8.5C15.4679 6.54637 14.7893 4.90121 13.4355 3.56794C12.0885 2.2004 10.4468 1.51835 8.51371 1.51835Z",fill:"#C4C4C4"})})},Pe={stripHeader:{flex:"0 0 3em",display:"flex",color:"background.darkPaper",bgcolor:"secondary.main","& > div":{display:"inline-flex",alignItems:"center",justifyContent:"center",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& > div:last-of-type":{borderRight:"none"},"& > div.checkbox-sec":{flex:"1 0 3.75%",minWidth:"35.5px"},"& > div.serial-sec":{flex:"0 2 7.5%"},"& > div.name-sec":{flex:"2 1 35%",flexWrap:"wrap",justifyContent:"flex-start",paddingLeft:"0.75em"},"& > div.price-sec":{flex:"1 0 7.5%"},"& > div.quantity-sec":{flex:"0 0 10%"},"& > div.discount-sec":{flex:"0 0 10%"},"& > div.total-sec":{flex:"1 0 7.5%"},"& > div.delete-sec":{flex:"1 0 2.5%"}},stripList:{flex:"1 0 50%",display:"flex",flexDirection:"column",overflow:"overlay","& .strip-item":{flex:"0 0 25%",display:"flex",color:"secondary.main",userSelect:"none",backgroundColor:"background.paper","@media (min-width: 1600px)":{flex:"0 0 20%"},"&:last-of-type":{boxShadow:"0px 8px 15px -14px #d3d3d3"},"&:nth-of-type(2n + 1)":{backgroundColor:"#eeeeee"},"&.active":{bgcolor:"active.main"},"& input.strip-input":{textAlign:"left",width:"3em",borderRadius:"0.2em",border:"0.5px solid #c4c4c4",backgroundColor:"transparent",outlineColor:"#aaaaaa"},"& > div":{fontSize:"0.9rem",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.25em 0",borderRight:"1px solid #f7f7f7"},"& > div:last-of-type":{borderRight:"none"},"& > div.checkbox-sec":{flex:"1 0 3.75%",minWidth:"35.5px"},"& > div.serial-sec":{flex:"0 2 7.5%"},"& > div.name-sec":{flex:"2 1 35%",flexWrap:"wrap",justifyContent:"flex-start",paddingLeft:"0.75em"},"& > div.name-sec svg":{width:"0.9em",height:"0.9em",paddingTop:"0.15em",marginLeft:"0.05em"},"& > div.name-sec > div":{flex:"0 0 100%"},"& > div.name-sec .MuiTypography-root":{fontWeight:"bold"},"& > div.name-sec .sub":{color:"text.disabled"},"& > div.price-sec":{flex:"1 0 7.5%"},"& > div.quantity-sec":{flex:"0 0 10%"},"& > div.discount-sec":{flex:"0 0 10%"},"& > div.total-sec":{flex:"1 0 7.5%"},"& > div.delete-sec":{flex:"1 0 2.5%"},"& > div.delete-sec .MuiSvgIcon-root":{color:"#c4c4c4",fontSize:"1.125rem",cursor:"pointer"}}}},We=Object(l.b)((function(e){return{posStrips:e.posStrips,posStripsSum:e.posStripsSum}}),{replacePosStrips:j.e,deletePosStrip:j.d,replacePosStripsSum:ve.c})((function(e){var t=e.posStrips,a=e.setUniformContent,r=e.setKeyboardMode,s=e.activeCommId,l=e.setActiveCommId,o=e.selectedIds,m=e.setSelectedIds,b=e.posStripsSum,u=e.replacePosStripsSum,p=Object(ne.a)(),j=Object(c.useState)(!1),f=Object(n.a)(j,2),x=f[0],h=f[1];Object(c.useEffect)((function(){var e=0,a=0,n=0;t.forEach((function(t){e+=t.originalTotal,a+=t.quantity,n+=t.total})),u({primitiveTotal:e,quantity:a,total:n})}),[t,u]);var g,v=function(e){a(""),r(e.target.dataset.keyboardMode)},y=function(a,n,c){var r=t.map((function(e){return e.id===n?Ne(Object(ee.a)(Object(ee.a)({},e),{},Object(te.a)({},a.target.name,c?Number(a.target.value):a.target.value))):e}));e.replacePosStrips(r)};return Object(d.jsxs)(i.a,{component:"section",id:"comm-strip-list",sx:{flex:"0 0 43.875%",display:"flex",flexDirection:"column",backgroundColor:"background.darkPaper",minHeight:"1px","& .MuiCheckbox-root":{color:p.palette.primary.main},"& .Mui-checked":{color:p.palette.primary.main}},children:[Object(d.jsxs)(i.a,{className:"strip-header",sx:Pe.stripHeader,children:[Object(d.jsx)("div",{className:"checkbox-sec",children:Object(d.jsx)(oe.a,{name:"select-all",color:"default",size:"small",checked:x,onChange:function(){if(x)m([]),h(!1);else{var e=t.map((function(e){return e.id}));m(e),h(!0)}},inputProps:{"aria-label":"select-all-strips"}})}),Object(d.jsx)("div",{className:"serial-sec",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"name-sec",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"discount-sec",children:"\u6298\u6578"}),Object(d.jsx)("div",{className:"total-sec",children:"\u5408\u8a08"}),Object(d.jsx)("div",{className:"delete-sec"})]}),Object(d.jsx)(i.a,{className:"strip-list",ref:e.listRef,sx:Pe.stripList,children:(g=t,g.map((function(t,n){var c=t.id===s?"active":"";return Object(d.jsxs)("div",{className:"strip-item ".concat(c),onClick:function(){return e=t.id,l(e),void a("");var e},children:[Object(d.jsx)("div",{className:"checkbox-sec",children:Object(d.jsx)(oe.a,{color:"default",size:"small",checked:o.includes(t.id),onChange:function(e){return function(e,t){e.target.checked?m([].concat(Object(ae.a)(o),[t])):m(o.filter((function(e){return e!==t}))),a("")}(e,t.id)}})}),Object(d.jsx)("div",{className:"serial-sec",children:n+1}),Object(d.jsxs)("div",{className:"name-sec",children:[Object(d.jsx)("div",{children:Object(d.jsxs)(R.a,{children:[t.stockName,t.undiscountable?Object(d.jsx)(Ie,{}):null]})}),Object(d.jsx)("div",{children:Object(d.jsxs)(R.a,{className:"sub",variant:"body2",children:["\u5546\u54c1\u7de8\u865f : ",t.stockId]})})]}),Object(d.jsx)("div",{className:"price-sec",children:t.price}),Object(d.jsx)("div",{className:"quantity-sec",children:Object(d.jsx)("input",{className:"strip-input",type:"number",name:"quantity","data-keyboard-mode":"quantityMode",value:t.quantity,onClick:v,onChange:function(e){return function(e,t){Number(e.target.value)<1||y(e,t,!0)}(e,t.id)}})}),Object(d.jsx)("div",{className:"discount-sec",children:Object(d.jsx)("input",{className:"strip-input",type:"text",name:"discount","data-keyboard-mode":"discountMode",value:t.discount,onClick:v,onChange:function(e){return function(e,t){if(t.undiscountable)return O.b.fire({title:"\u8b66\u544a: \u6b64\u70ba\u4e0d\u53ef\u6298\u6263\u7684\u5546\u54c1",target:document.querySelector(".right-platform")});var a=Ce(e.target.value);if(a||""===e.target.value){var n=ke(t,a,e.target.value);t.price*t.quantity>=n?y(e,t.id):O.b.fire({title:"\u8b66\u544a: \u6298\u6263\u984d\u5ea6\u5927\u65bc\u5546\u54c1\u50f9\u683c",target:document.querySelector(".right-platform")})}}(e,t)},autoComplete:"off"})}),Object(d.jsx)("div",{className:"total-sec",children:t.total}),Object(d.jsx)("div",{className:"delete-sec",children:Object(d.jsx)(ge.a,{onClick:function(){return e.deletePosStrip(t.id)}})})]},t.id)})))}),Object(d.jsxs)(i.a,{className:"strip-footer",sx:{flex:"0 0 2.25em",display:"flex",alignItems:"center",justifyContent:"space-between",fontWeight:"bold",fontSize:"1.125rem",color:"background.paper",bgcolor:"primary.main",padding:"0 1em","& .clear-selected-btn":{fontSize:"0.95rem",lineHeight:1.5,textAlign:"center",verticalAlign:"middle",bgcolor:Object(ce.a)(p.palette.text.secondary,.05),padding:"0.125em 0.75em",userSelect:"none",color:"background.darkPaper",border:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},transition:"all 0.2s ease-out","&:hover":{bgcolor:"primary.main"}},"& .total-wrapper":{display:"flex","& svg":{width:"0.75em",height:"0.75em"}},"& .total-sum":{display:"inline-flex",alignItems:"center",padding:"0 0.75em"},"& .quantity-sum":{display:"inline-flex",alignItems:"center",padding:"0 0.75em","& span":{paddingLeft:"0.25em"}}},children:[Object(d.jsx)("input",{className:"clear-selected-btn",type:"button",value:"\u6e05\u9664\u9078\u53d6",onClick:function(){m([]),l(""),a("")}}),Object(d.jsxs)("div",{className:"total-wrapper",children:[Object(d.jsxs)("div",{className:"quantity-sum",children:[Object(d.jsx)(Se,{}),Object(d.jsxs)("span",{children:["\u7e3d\u6578\u91cf\xa0:\xa0",b.quantity]})]}),Object(d.jsxs)("div",{className:"total-sum",children:[Object(d.jsx)(we,{}),Object(d.jsxs)("span",{children:["\u7e3d\u91d1\u984d\xa0:\xa0",b.total,"\u5143"]})]})]})]})]})})),ze=function(e,t){var a=t?t[e.stockId]||e.price:e.price?e.price.price:0;return{id:Object(p.a)(),stockId:e.stockId,stockName:e.stockName||e.description,undiscountable:e.undiscountable,quantity:1,discount:"",price:a,total:a,salePrice:a,originalTotal:a}},Re=function(e){var t,a=(null===e||void 0===e||null===(t=e.cashRegister)||void 0===t?void 0:t.salePoint)||{},n=(null===e||void 0===e?void 0:e.salesDetails)||[],c=null===e||void 0===e?void 0:e.actualTotal;window.printerBridge.printReceipt({headTime:a.headTime,invoiceHead1:a.invoiceHead1||"",invoiceHead2:a.invoiceHead2||"",invoiceHead3:a.invoiceHead3||"",invoiceHead4:a.invoiceHead4||"",invoiceHead5:a.invoiceHead5||"",invoiceHead6:a.invoiceHead6||"",salePointInvoiceName:a.salePointInvoiceName||""},n.map((function(e){return{item:e.stockDescription||e.stockMaster.description,qty:e.quantity,salePrice:e.salePrice,subTotal:e.subTotal}})),c)},Me=a(101),Le={root:{flex:"0 0 50%",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",minWidth:0,"& .search-comm-container":{position:"relative",flex:"0 0 85%",display:"flex",flexDirection:"column",alignItems:"flex-start",alignContent:"flex-start",width:"100%",paddingRight:"1em",minHeight:0}},searchList:{flexGrow:1,width:"100%",display:"flex",flexDirection:"column",overflow:"auto",minHeight:0,"& .search-item":{flex:"0 0 20%",display:"inline-flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",backgroundColor:"background.light",borderBottom:"1px solid #dddddd",padding:"0 0.5em",minHeight:0,"&:focus":{zIndex:2,bgcolor:"active.main",outline:"none"},"&:last-of-type":{borderBottom:"none"}},"& .comm-name":{display:"flex",fontWeight:"bold",letterSpacing:"0.04em",paddingRight:"0.5em",color:"#585a63",overflow:"overlay","& p":{display:"inline-block"},"& small":{fontSize:"0.75em",color:"#585a63"}},"& .comm-price":{letterSpacing:"0.02em"}}},He=Object(l.b)((function(e){return{comms:e.comms}}),{addPosStrip:j.a,fetchComms:Me.b,replaceComms:Me.c})((function(e){var t=e.comms,a=e.fetchComms,r=e.replaceComms,s=e.addPosStrip,l=e.setActiveCommId,o=e.setUniformContent,m=e.listRef,p=Object(ne.a)(),j=Object(c.useState)(""),f=Object(n.a)(j,2),x=f[0],h=f[1],O=Object(c.useState)(0),g=Object(n.a)(O,2),v=g[0],y=g[1],C=Object(c.useRef)(null),k=Object(c.useRef)(null),N=Object(c.useRef)(null),S=function(){var e=Object(u.a)(Object(b.a)().mark((function e(t){var a;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stockId){e.next=2;break}return e.abrupt("return");case 2:return a=ze(t),e.next=5,s(a);case 5:o(""),l(a.id),w(m.current);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e){e.scrollTo(0,e.scrollHeight)},I=Object(c.useCallback)((function(e){C.current&&C.current.contains(e.target)||(r([]),y(0),document.body.removeEventListener("click",I,{capture:!0}))}),[r]);Object(c.useEffect)((function(){return C.current&&Object.keys(t).length>0&&document.body.addEventListener("click",I,{capture:!0}),function(){document.body.removeEventListener("click",I,{capture:!0})}}),[I,t]);return Object(d.jsx)(i.a,{component:"section",id:"search-comm",sx:Le.root,children:Object(d.jsxs)("div",{className:"search-comm-container",ref:C,children:[Object(d.jsxs)(i.a,{component:"form",className:"search-bar",sx:{display:"flex",width:"100%","& .comm-input":{width:"calc(100% - 4.5rem)",border:"1px solid ".concat(p.palette.primary.main),paddingLeft:"0.5em",outlineColor:p.palette.primary.main,"&::placeholder":{color:"#c4c4c4"}},"& .submit-btn":{width:"4.5rem",fontSize:"1rem",borderRadius:0,padding:"0.25em 1em",color:"background.paper",backgroundColor:p.palette.primary.main,"&:hover":{bgcolor:Object(ce.a)(p.palette.primary.main,.8)}}},children:[Object(d.jsx)("input",{type:"text",className:"comm-input",value:x,onChange:function(e){return h(e.target.value)},placeholder:"\u5728\u6b64\u8f38\u5165\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)(_.a,{onClick:function(e){e.preventDefault(),a(x?{name:x}:{}),document.body.addEventListener("click",I,{capture:!0})},className:"submit-btn",variant:"contained",disableElevation:!0,type:"submit",children:"\u641c\u5c0b"})]}),Object(d.jsx)(i.a,{className:"search-list",ref:N,sx:Le.searchList,children:t.map((function(e,t){var a=t===v?"active":"",n=t===v?k:null,c=e.description+" - "+e.stockId;return Object(d.jsxs)("div",{onClick:function(){return S(e)},onKeyUp:function(t){return function(e,t){"Enter"===e.code&&S(t)}(t,e)},className:"search-item ".concat(a),"data-id":e.stockId,tabIndex:"0",ref:n,children:[Object(d.jsx)("div",{className:"comm-name micro-scroll",children:Object(d.jsx)(R.a,{noWrap:!0,variant:"body1",title:c,children:c})}),Object(d.jsx)("small",{className:"comm-price",children:e.price?e.price.price:0})]},t)}))})]})})})),Ee=Object(l.b)((function(e){return{posStrips:e.posStrips}}),{replacePosStrips:j.e})((function(e){var t=e.posStrips,a=e.replacePosStrips,n=e.uniformContent,c=e.setUniformContent,r=e.keyboardMode,s=e.setKeyboardMode,l=e.activeCommId,o=e.selectedIds,m=Object(ne.a)(),b=function(e){p(n+e.target.dataset.text,r)},u=function(e){s(e.target.dataset.keyboardMode),c("")},p=function(e,n){if(o.length<=0&&!l)return O.b.fire({title:"\u63d0\u9192: \u8acb\u5148\u9078\u64c7\u5546\u54c1",target:document.querySelector(".right-platform")});var r=o.length>0,i=[];switch(n){case"discountMode":i=r?j(e):f(e);break;case"quantityMode":if(g(e))return;c(e),i=r?x(e):h(e);break;default:i=Object(ae.a)(t)}a(i)},j=function(e){var a=Ce(e);if(!a&&""!==e)return t;var n=[],r=!1,i=!1;return t.findIndex((function(t){if(o.includes(t.id)){var c=ke(t,a,e);return t.undiscountable?(i=!0,O.b.fire({title:"\u8b66\u544a: \u5305\u542b\u7121\u6cd5\u6298\u6263\u7684\u5546\u54c1",target:document.querySelector(".right-platform")}),!0):t.price*t.quantity<c?(r=!0,O.b.fire({title:"\u8b66\u544a: \u6298\u6263\u984d\u5ea6\u5927\u65bc\u90e8\u5206\u5546\u54c1",target:document.querySelector(".right-platform")}),!0):(n.push(Ne(Object(ee.a)(Object(ee.a)({},t),{},{discount:e}))),!1)}return n.push(t),!1})),i||r?t:(c(e),n)},f=function(e){var a=Ce(e);return a||""===e?t.map((function(t){if(t.id===l){if(t.undiscountable)return O.b.fire({title:"\u8b66\u544a: \u6b64\u70ba\u4e0d\u53ef\u6298\u6263\u7684\u5546\u54c1",target:document.querySelector(".right-platform")}),t;var n=ke(t,a,e);return t.price*t.quantity>=n?(c(e),Ne(Object(ee.a)(Object(ee.a)({},t),{},{discount:e}))):(O.b.fire({title:"\u8b66\u544a: \u6298\u6263\u984d\u5ea6\u5927\u65bc\u90e8\u5206\u5546\u54c1",target:document.querySelector(".right-platform")}),t)}return t})):t},x=function(e){return t.map((function(t){return o.includes(t.id)?Ne(Object(ee.a)(Object(ee.a)({},t),{},{quantity:Number(e)||1})):t}))},h=function(e){return t.map((function(t){return t.id===l?Ne(Object(ee.a)(Object(ee.a)({},t),{},{quantity:Number(e)||1})):t}))},g=function(e){return""!==e&&(isNaN(e)||Number(e)<=0)};return Object(d.jsx)(i.a,{component:"section",id:"number-panel",sx:{flex:"0 0 50%",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column","& .number-panel-container":{flex:"0 0 85%",display:"flex",width:"100%"}},children:Object(d.jsxs)("div",{className:"number-panel-container",children:[Object(d.jsxs)(i.a,{className:"left-panel",sx:{flex:"0 0 90%",display:"flex",flexDirection:"column",borderRight:function(e){return"1px solid ".concat(e.palette.background.paper)},"& .current-input":{flex:"0 0 17.5%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",fontWeight:"bold",userSelect:"none",color:"#cccccc",bgcolor:function(e){return Object(ce.a)(e.palette.secondary.main,.86)}}},children:[Object(d.jsx)("div",{className:"current-input",children:n||"\u9ede\u64ca\u6578\u5b57\u9762\u677f"}),Object(d.jsxs)(i.a,{className:"panel-item-list",sx:{flex:"0 0 82.5%",display:"flex",flexWrap:"wrap","& .panel-item":{flex:"0 0 25%",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",fontWeight:"bold",color:"background.paper",cursor:"pointer",userSelect:"none",borderRight:function(e){return"1px solid ".concat(e.palette.background.paper)},borderTop:function(e){return"1px solid ".concat(e.palette.background.paper)},bgcolor:function(e){return Object(ce.a)(e.palette.secondary.main,.86)},"&.orange":{color:m.palette.primary.main},"&:nth-last-of-type(4n + 1)":{borderRight:"none"}}},children:[Object(d.jsx)("div",{className:"panel-item","data-text":"1",onClick:b,children:"1"}),Object(d.jsx)("div",{className:"panel-item","data-text":"2",onClick:b,children:"2"}),Object(d.jsx)("div",{className:"panel-item","data-text":"3",onClick:b,children:"3"}),Object(d.jsx)("div",{className:"panel-item orange","data-text":"-",onClick:function(){0!==n.length&&p(n.slice(0,-1),r)},children:"\u2190"}),Object(d.jsx)("div",{className:"panel-item","data-text":"4",onClick:b,children:"4"}),Object(d.jsx)("div",{className:"panel-item","data-text":"5",onClick:b,children:"5"}),Object(d.jsx)("div",{className:"panel-item","data-text":"6",onClick:b,children:"6"}),Object(d.jsx)("div",{className:"panel-item","data-text":"%",onClick:b,children:"%"}),Object(d.jsx)("div",{className:"panel-item","data-text":"7",onClick:b,children:"7"}),Object(d.jsx)("div",{className:"panel-item","data-text":"8",onClick:b,children:"8"}),Object(d.jsx)("div",{className:"panel-item","data-text":"9",onClick:b,children:"9"}),Object(d.jsx)("div",{className:"panel-item","data-text":"0",onClick:b,children:"0"})]})]}),Object(d.jsxs)(i.a,{className:"right-panel",sx:{flex:"0 0 10%",display:"flex",justifyContent:"flex-end",flexDirection:"column",borderLeft:"none","& .panel-type":{flex:" 0 0 50%",display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#c4c4c4",cursor:"pointer",userSelect:"none",border:"1px solid #c4c4c4",bgcolor:"background.paper",padding:"0 0.5em","&:hover":{bgcolor:Object(ce.a)(m.palette.text.secondary,.01)},"&:last-of-type":{borderTop:"none"},"&.active":{color:"background.paper",borderColor:m.palette.primary.main,bgcolor:m.palette.primary.main,"&:hover":{bgcolor:Object(ce.a)(m.palette.primary.main,.8)}}}},children:[Object(d.jsx)("div",{className:"panel-type ".concat("quantityMode"===r?"active":""),"data-keyboard-mode":"quantityMode",onClick:u,children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"panel-type ".concat("discountMode"===r?"active":""),"data-keyboard-mode":"discountMode",onClick:u,children:"\u6298\u6263"})]})]})})})),Ae=a(275),De=a.n(Ae),Te=a(296),qe=a.n(Te),Be=a(295),Ve=a.n(Be),Fe=a(110),Ze=function(){var e=Object(c.useState)(""),t=Object(n.a)(e,2),a=t[0],r=t[1];return Object(c.useEffect)((function(){var e="",t=0,a=function(a){var n=a.key||String.fromCharCode(a.keyCode),c=a.target.localName;n&&1===n.length&&"input"!==c&&(t&&clearTimeout(t),e+=n,t=setTimeout((function(){e.length>=8&&r(e),e=""}),20))};return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}}),[]),[a,function(){r("")}]},Ge=a(233),Ue=a(344),_e=Object(I.a)(Object(d.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle"),Ke=Object(I.a)(Object(d.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Ye=a(277),$e=a(261),Je=a(133),Qe=new RegExp("^\\d{8}$"),Xe=new RegExp("^\\/{1}[0-9A-Z.+-]{7}$"),et=new RegExp("^\\d{3,7}$"),tt=new RegExp("^[A-Z]{2}\\d{14}$");var at={receivedAmountInput:{display:"flex",padding:"0.5em 0","& input":{flex:"0 0 80%",width:"100%",lineHeight:2,textAlign:"center",fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.02em",border:"1px solid #aaaaaa",borderRight:"none",borderTopLeftRadius:"0.25em",borderBottomLeftRadius:"0.25em",color:function(e){return e.palette.primary.main},outlineColor:function(e){return e.palette.primary.main},backgroundColor:"background.paper","&::placeholder":{color:"#c4c4c4"}},"& button":{flex:"0 0 20%",textAlign:"center",fontSize:"1rem",fontWeight:"bold",letterSpacing:"0.025em",border:function(e){return"1px solid ".concat(e.palette.primary.main)},borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,color:"background.default",backgroundColor:function(e){return e.palette.primary.main},"&:hover":{backgroundColor:"#fabd5e"},"&:disabled":{borderColor:"#aaaaaa"}}},receivedAmountList:{display:"flex",flexWrap:"wrap",alignItems:"center",alignContent:"center",fontSize:"0.95rem",fontWeight:"bold",color:"#5a658e",padding:"0.125em 0","& > div":{display:"inline-block"},"& span":{paddingRight:"0.675em"},"&.credit-info":{px:"0.5rem",borderRadius:"0.25rem",color:"text.primary",bgcolor:"active.light",textShadow:function(e){return"1px 1px 1px ".concat(e.palette.background.paper)}}},mainPaymentMethod:{padding:"0.5em 0 1em","& button":{fontSize:"1.125rem",fontWeight:"bold",color:"background.paper",backgroundColor:"secondary.matte",width:"47.5%","&:first-of-type":{marginRight:"5%"},"&:hover":{backgroundColor:"#606c9a"}},"&.clearing button":{backgroundColor:"#f26c44","&:hover":{backgroundColor:"#ff6d41"}}},minorPaymentMethod:{padding:"0.25em 0 1em","& button":{fontSize:"0.9rem",width:"22%",paddingLeft:0,paddingRight:0,marginLeft:"4%",backgroundColor:"#f6f6f6",letterSpacing:"0.08em","&:first-of-type":{marginLeft:0},"&:hover":{backgroundColor:"#f0f0f0"}},"&.clearing button":{color:"#666666",borderColor:"#ffe1d9",backgroundColor:"#fff1ed","&:hover":{backgroundColor:"#fff6f4"}}},paymentStatus:{lineHeight:2,flex:"0 0 80%",maxWidth:"80%",justifyContent:"space-around",borderRadius:"0.3em",borderTop:"1px dashed #dddddd",borderBottom:"1px dashed #dddddd",backgroundColor:"#ecf4f7",margin:"0.5em 0","&.clearing":{backgroundColor:"#fffdf5"},"& span":{fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.025em"},"& .unreceived":{color:"#88a6e3"}},checkoutBtnWrapper:{flex:"0 0 20%",maxWidth:"20%",display:"flex",justifyContent:"flex-end","& button":{width:"90%",fontWeight:"bold",fontSize:"1.5rem",color:"background.paper",backgroundColor:function(e){return e.palette.primary.main},borderRadius:"0.5em","&:hover":{backgroundColor:"#fabd5e"}}},invoiceInfo:{padding:"1em 0",justifyContent:"space-between",borderBottom:"1px solid #c4c4c4","& .input-wrapper":{position:"relative",flex:"0 0 32%","& span":{display:"inline-block",width:"5em",color:"#3c3c3c"},"& input":{width:"calc(100% - 5em)",border:"1px solid #aaaaaa",borderRadius:"0.125em",outlineColor:function(e){return e.palette.primary.main},backgroundColor:"background.paper",letterSpacing:"0.0375em",padding:"0 0.375em",height:"1.75em"},"& select":{width:"calc(100% - 5em)",border:"1px solid #aaaaaa",borderRadius:"0.125em",backgroundColor:"background.paper",letterSpacing:"0.0375em",padding:"0 0.25em",height:"1.75em",textAlign:"center"},"& svg":{fontSize:"1rem",position:"absolute",right:function(e){return e.spacing(.5)},top:"50%",transform:"translate(0, -50%)",color:"rgb(119 171 63 / 50%)"}}},orderDetail:{"& .table-header":{display:"flex",height:"2em",color:"background.paper",fontSize:"1rem",backgroundColor:"#a4a4a4"},"& .table-body":{maxHeight:"10.5rem",overflow:"auto"},"& .table-item":{display:"flex",color:"secondary.main",fontSize:"1rem",backgroundColor:"#eaeaea",cursor:"pointer"},"& .table-item:nth-of-type(2n + 1)":{backgroundColor:"background.light"},"& .sec-item":{display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25em",borderRight:"1px solid #eeeeee",minWidth:0},"& .serial-sec":{flex:"0 0 10%"},"& .comm-name-sec":{flex:"0 0 45%",padding:"0.5em"},"& .price-sec":{flex:"0 0 10%"},"& .quantity-sec":{flex:"0 0 10%"},"& .discount-sec":{flex:"0 0 12.5%"},"& .total-sec":{flex:"0 0 12.5%",borderRight:"none"}},clearMethod:{paddingBottom:"1.5em","& button":{backgroundColor:"#fefefe","&:first-of-type":{marginRight:"1em"},"&.all-clear":{color:function(e){return Object(ce.a)(e.palette.error.light,.8)},borderColor:function(e){return Object(ce.a)(e.palette.error.light,.5)},bgcolor:function(e){return e.palette.background.default}},"&.partial-clear":{color:function(e){return Object(ce.a)(e.palette.text.primary,.6)},borderColor:function(e){return Object(ce.a)(e.palette.text.primary,.3)},bgcolor:function(e){return e.palette.background.default}},"&.clearing":{color:"background.paper",backgroundColor:"#666666"}}}},nt=Object(l.b)((function(e){return{user:e.user,posStrips:e.posStrips,posStripsSum:e.posStripsSum,paymentMethods:e.paymentMethods.content,receivedAmounts:e.receivedAmounts,invoiceInfo:e.invoiceInfo,creditCardResponse:e.creditCardResponse,currentMember:e.currentMember}}),{updateReceivedAmounts:Je.c,replaceReceivedAmounts:Je.b,replaceCreditCardResponse:Fe.b,checkout:ve.a})((function(e){var t,a,r,s,l=e.handleCheckoutClose,o=e.isPartialClear,m=e.setIsPartialClear,p=e.user,j=e.posStrips,f=e.posStripsSum,x=e.currentMember,h=e.paymentMethods,g=e.receivedAmounts,v=e.creditCardResponse,y=e.replaceCreditCardResponse,C=e.updateReceivedAmounts,k=e.replaceReceivedAmounts,N=e.checkout,S=Object(c.useRef)(null),w=Object(c.useState)(0),I=Object(n.a)(w,2),P=I[0],W=I[1],z=Object(c.useState)(0),R=Object(n.a)(z,2),M=R[0],H=R[1],E=Object(c.useState)(0),A=Object(n.a)(E,2),D=A[0],T=A[1],q=Object(c.useState)(!1),B=Object(n.a)(q,2),V=B[0],F=B[1],Z=Object(c.useState)(""),G=Object(n.a)(Z,2),U=G[0],K=G[1],Y=Object(c.useState)(""),$=Object(n.a)(Y,2),J=$[0],Q=$[1],X=Object(c.useState)(""),ae=Object(n.a)(X,2),ne=ae[0],ce=ae[1],re=Object(c.useState)(null),ie=Object(n.a)(re,2),se=ie[0],le=ie[1],oe=Object(c.useMemo)((function(){return window.localStorage.getItem("receiptMode/".concat(p.salePointId))}),[p]),de=Ze(),me=Object(n.a)(de,2),be=me[0],ue=me[1];Object(c.useEffect)((function(){be&&(ce(be),Ce(be),ue())}),[be,ue]);var pe=function(){var e=Object(u.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(je()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,N(Object(ee.a)(Object(ee.a)({giveChangeAmount:D},V&&{taxId:U}),J&&{invoiceCarrier:ne}));case 4:(t=e.sent)&&("\u6536\u64da\u6a5f"===oe?Re(t):"\u5370\u8868\u6a5f"===oe&&le(t),l());case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){if(se){var e=S.current,t=document.querySelector("#print-iframe");t.innerHTML=e.innerHTML,window.print(),t.innerHTML=null,le(null)}}),[se]);var je=function(){return M>0?(Object(O.c)("\u63d0\u9192: \u6b3e\u9805\u5c1a\u672a\u6536\u9f4a"),!1):U&&!V?(Object(O.c)("\u63d0\u9192: \u7d71\u4e00\u7de8\u865f\u4e0d\u7b26\u5408"),!1):!(ne&&!J)||(Object(O.c)("\u63d0\u9192: \u8f09\u5177\u865f\u78bc\u4e0d\u7b26\u5408"),!1)},fe=Object(c.useMemo)((function(){return Object.values(g).reduce((function(e,t){return e+t}),0)}),[g]);Object(c.useEffect)((function(){var e=f.total-fe;e>0?(T(0),H(e)):(T(-e),H(0))}),[f,fe]);var xe,he=function(e){return o?ye(e):P||0!==M?P?void("cash"===e.target.dataset.name?Oe(e):"credit"===e.target.dataset.name?ge(e):ve(e)):Object(O.c)("\u63d0\u9192: \u8acb\u8f38\u5165\u91d1\u984d"):Object(O.c)("\u63d0\u9192: \u5df2\u53ef\u7d50\u5e33")},Oe=function(e){ve(e)},ge=function(){var e=Object(u.a)(Object(b.a)().mark((function e(t){var a,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(v).length>0)){e.next=3;break}return Object(O.c)("\u63d0\u9192: \u5df2\u6709\u4fe1\u7528\u5361\u4ed8\u6b3e\u8cc7\u6599"),e.abrupt("return");case 3:return e.next=5,window.edcBridge.send({amount:P,edc:null===(a=window.configBridge.getConfig())||void 0===a?void 0:a.edc});case 5:if((n=e.sent).success){e.next=9;break}return Object(O.c)("\u8b66\u544a: \u4ed8\u6b3e\u5931\u6557","error"),e.abrupt("return");case 9:y(n),Object(O.c)("\u4fe1\u7528\u5361\u4ed8\u6b3e\u6210\u529f","success"),ve(t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(e){var t=e.target.dataset.paymentId;if("1"!==t&&P>M)return alert("\u8f38\u5165\u91d1\u984d\u4e0d\u80fd\u8d85\u904e\u672a\u6536\u91d1\u984d");var a=g[t]||0;C(Object(te.a)({},t,a+P)),W(0)},ye=function(e){var t=e.target.dataset.paymentId,a=g[t];a&&(P&&a!==P?a>P&&(C(Object(te.a)({},t,a-P)),W(0)):k(Object(Ue.a)(g,[t])))},Ce=function(e){Xe.test(e)?Q("barCode"):et.test(e)?Q("loveCode"):tt.test(e)?Q("certificate"):Q("")},ke=o?"clearing":"";return Object(d.jsxs)(L.a,{sx:{padding:"0.5em 1.75em 0",backgroundColor:"background.paper"},children:[Object(d.jsx)(i.a,{className:"member-info",sx:{"& > div":{display:"inline-block",fontSize:"0.9rem",color:"secondary.matte",paddingRight:"1em"},"& .content":{fontWeight:"bold"}},children:x.memberName&&Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"label",children:"\u6703\u54e1\u540d\u7a31 : "}),Object(d.jsx)("span",{className:"content",children:x.memberName||""})]})}),Object(d.jsxs)(Ye.a,{container:!0,children:[Object(d.jsxs)(Ye.a,{item:!0,xs:5,sx:{display:"flex",flexDirection:"column"},children:[Object(d.jsxs)(i.a,{className:"received-amount-input ".concat(ke),sx:at.receivedAmountInput,children:[Object(d.jsx)("input",{value:P||"",onChange:function(e){Number.isNaN(Number(e.target.value))||W(Number(e.target.value))},placeholder:"\u8f38\u5165\u6536\u6b3e\u91d1\u984d"}),Object(d.jsx)(_.a,{variant:"contained",disableElevation:!0,disabled:o||M<=0,onClick:function(){M>0&&W(M)},children:"\u586b\u5165"})]}),Object(d.jsx)(i.a,{className:"received-amount-list",sx:at.receivedAmountList,children:function(e){return Object.keys(e).map((function(t){return Object(d.jsxs)("div",{children:[Object(d.jsxs)("span",{children:[h[t].paymentName," :"]}),Object(d.jsx)("span",{children:e[t]})]},t)}))}(g)}),v.success&&Object(d.jsxs)(i.a,{className:"received-amount-list credit-info",sx:at.receivedAmountList,children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{children:"\u6388\u6b0a\u78bc :"}),Object(d.jsx)("span",{children:null===(t=v.response)||void 0===t||null===(a=t.approvalNo)||void 0===a?void 0:a.replaceAll(" ","")})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{children:"\u672b\u56db\u78bc :"}),Object(d.jsx)("span",{children:null===(r=v.response)||void 0===r||null===(s=r.cardNo)||void 0===s?void 0:s.slice(-4)})]})]})]}),Object(d.jsxs)(Ye.a,{item:!0,xs:7,sx:{paddingLeft:"2em"},children:[Object(d.jsxs)(i.a,{className:"main-payment-method ".concat(ke),sx:at.mainPaymentMethod,children:[Object(d.jsx)(_.a,{"data-payment-id":"1","data-name":"cash",onClick:he,children:"\u73fe\u91d1"}),Object(d.jsx)(_.a,{"data-payment-id":"2","data-name":"credit",onClick:he,children:"\u4fe1\u7528\u5361"})]}),Object(d.jsx)(i.a,{className:"minor-payment-method ".concat(ke),sx:at.minorPaymentMethod,children:function(e){var t=[];return Object.keys(e).forEach((function(a){var n=e[a].salePointPaymentsTypeId;"1"!==n&&"2"!==n&&t.push(Object(d.jsx)(_.a,{color:"secondary",variant:"outlined",onClick:he,"data-payment-id":a,children:e[a].paymentName},a))})),t}(h)})]})]}),Object(d.jsxs)(Ye.a,{container:!0,children:[Object(d.jsxs)(Ye.a,{item:!0,container:!0,className:"payment-status ".concat(ke),sx:at.paymentStatus,children:[Object(d.jsxs)(Ye.a,{item:!0,children:["\u672a\u6536\u91d1\u984d : ",Object(d.jsx)("span",{className:"unreceived",children:M})]}),Object(d.jsxs)(Ye.a,{item:!0,children:["\u627e\u96f6\u91d1\u984d : ",Object(d.jsx)("span",{children:D})]}),Object(d.jsxs)(Ye.a,{item:!0,children:["\u5df2\u6536\u91d1\u984d : ",Object(d.jsx)("span",{children:fe})]}),Object(d.jsxs)(Ye.a,{item:!0,children:["\u61c9\u6536\u91d1\u984d : ",Object(d.jsx)("span",{children:f.total})]})]}),Object(d.jsx)(Ye.a,{item:!0,className:"checkout-btn-wrapper",sx:at.checkoutBtnWrapper,children:Object(d.jsx)(_.a,{variant:"contained",disableElevation:!0,disabled:M>0,onClick:pe,startIcon:Object(d.jsx)(_e,{sx:{"&:first-of-type":{fontSize:"1.25em"}}}),children:"\u7d50\u5e33"})})]}),Object(d.jsxs)(Ye.a,{container:!0,className:"invoice-info",sx:at.invoiceInfo,children:[Object(d.jsxs)("div",{className:"input-wrapper",children:[Object(d.jsx)("span",{children:"\u7d71\u4e00\u7de8\u865f"}),Object(d.jsx)("input",{type:"text",value:U,onChange:function(e){K(e.target.value),Qe.test(e.target.value)?F(!0):F(!1)}}),V&&Object(d.jsx)(Ke,{})]}),Object(d.jsxs)("div",{className:"input-wrapper",children:[Object(d.jsx)("span",{children:"\u8f09\u5177\u865f\u78bc"}),Object(d.jsx)("input",{type:"text",value:ne,onChange:function(e){var t=e.target.value;ce(t),Ce(t)}}),J&&Object(d.jsx)(Ke,{})]}),Object(d.jsxs)("div",{className:"input-wrapper",children:[Object(d.jsx)("span",{children:"\u8f09\u5177\u985e\u578b"}),Object(d.jsxs)("select",{value:J,disabled:!0,children:[Object(d.jsx)("option",{value:"",children:"- \u5c07\u4f9d\u8f09\u5177\u865f\u78bc\u5224\u65b7 -"}),Object(d.jsx)("option",{value:"barCode",children:"\u624b\u6a5f\u689d\u78bc"}),Object(d.jsx)("option",{value:"loveCode",children:"\u611b\u5fc3\u78bc"}),Object(d.jsx)("option",{value:"certificate",children:"\u81ea\u7136\u4eba\u6191\u8b49"})]})]})]}),Object(d.jsx)(i.a,{sx:{padding:"1.5em 0"},children:Object(d.jsxs)(i.a,{className:"order-detail",sx:at.orderDetail,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"comm-name-sec sec-item",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec sec-item",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:"\u6298\u6578"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:"\u5408\u8a08"})]}),Object(d.jsx)("div",{className:"table-body",children:(xe=j,xe.map((function(e,t){return Object(d.jsxs)("div",{className:"table-item",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:t+1}),Object(d.jsx)("div",{className:"comm-name-sec sec-item",children:e.stockName}),Object(d.jsx)("div",{className:"price-sec sec-item",children:e.price}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:e.quantity}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:e.discount}),Object(d.jsx)("div",{className:"total-sec sec-item",children:e.total})]},t)})))})]})}),Object(d.jsxs)(i.a,{className:"clear-method",sx:at.clearMethod,children:[Object(d.jsx)(_.a,{className:"all-clear",variant:"outlined",color:"error",onClick:function(){k({}),y({})},children:"\u6e05\u9664\u4ed8\u6b3e"}),o?Object(d.jsx)(_.a,{className:"partial-clear clearing",variant:"outlined",color:"primary",onClick:function(){m(!1)},children:"\u7d50\u675f\u90e8\u5206\u6e05\u9664"}):Object(d.jsx)(_.a,{className:"partial-clear",variant:"outlined",color:"secondary",onClick:function(){m(!0)},children:"\u90e8\u5206\u6e05\u9664\u4ed8\u6b3e"})]}),Object(d.jsx)(i.a,{className:"print-content",ref:S,sx:{display:"none"},children:se&&Object(d.jsx)($e.b,{order:se})})]})})),ct=a(108),rt=r.a.forwardRef((function(e,t){return Object(d.jsx)(Ge.a,Object(ee.a)({direction:"up",ref:t},e))})),it={dialogTitle:{flex:"0 0 auto",margin:0,padding:"0.375em 1.75em 0.25em",lineHeight:1.6,letterSpacing:"0.0075rem",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.25rem",fontWeight:"bold"}},titleCloseBtn:{position:"absolute",right:"0.5em",top:"0.25em",color:function(e){return e.palette.error.main},padding:0}},st=function(e){var t=e.open,a=e.handleCheckoutClose,n=e.handleValidateAndClose,r=e.isPartialClear,s=e.setIsPartialClear,o=Object(l.c)();return Object(c.useEffect)((function(){o(Object(ct.b)())}),[o]),Object(d.jsxs)(z.a,{id:"dialog-checkout",open:t,TransitionComponent:rt,onClose:n,"aria-labelledby":"dialog-checkout",fullWidth:!0,PaperProps:{sx:{maxWidth:960}},sx:{"& .MuiBackdrop-root":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:[Object(d.jsxs)(i.a,{className:"dialog-title",sx:it.dialogTitle,children:[Object(d.jsx)(R.a,{variant:"h6",children:"\u7d50\u5e33\u756b\u9762"}),n?Object(d.jsx)(M.a,{"aria-label":"close",onClick:n,sx:it.titleCloseBtn,children:Object(d.jsx)(P,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(d.jsx)(nt,{handleCheckoutClose:a,isPartialClear:r,setIsPartialClear:s})]})},lt=a(362),ot=a(293),dt=a.n(ot),mt=a(294),bt=a.n(mt),ut=a(269),pt=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],jt={flex:"0 0 100%",maxWidth:"100%",display:"flex",justifyContent:"space-between","@media (min-width: 600px)":{flex:"0 0 49%",maxWidth:"49%"}},ft={display:"flex",color:"background.darkPaper",bgcolor:"secondary.main","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",borderRight:function(e){return"1px solid ".concat(e.palette.background.darkPaper)},paddingTop:"0.125em",paddingBottom:"0.125em"},"& .serial-sec":{flex:"0 0 7%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .time-sec":{flexGrow:1},"& .total-sec":{flex:"0 0 12.5%"},"& .actual-total-sec":{flex:"0 0 12.5%"},"& .member-name-sec":{flex:"0 0 15%"},"& .member-phone-sec":{flex:"0 0 17.5%"},"& .invoice-sec":{flex:"0 0 17.5%",justifyContent:"flex-start",borderRight:"none",padding:"0 1em"}},xt={maxHeight:"8rem",overflow:"overlay","& .order-item":{display:"flex",cursor:"pointer",userSelect:"none",bgcolor:"background.darkPaper","& > div":{display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1rem",color:"secondary.main",height:"2em",padding:"0.25em",borderRight:"1px solid #f0f0f0",overflow:"overlay"},"&:nth-of-type(2n + 1)":{bgcolor:"#e6e6e6"},"& .serial-sec":{flex:"0 0 7%",borderLeft:function(e){return"1px solid ".concat(e.palette.background.darkPaper)}},"& .time-sec":{flexGrow:1},"& .total-sec":{flex:"0 0 12.5%"},"& .actual-total-sec":{flex:"0 0 12.5%"},"& .member-name-sec":{flex:"0 0 15%"},"& .member-phone-sec":{flex:"0 0 17.5%"},"& .invoice-sec":{flex:"0 0 17.5%",justifyContent:"flex-start",borderRight:"none",padding:"0 1em"},"&.active":{bgcolor:"active.main"}}},ht={display:"inline-block",width:"100%","& .table-header":{display:"flex",height:"2em",color:"background.paper",fontSize:"1rem",bgcolor:"secondary.main"},"& .table-list":{display:"flex",flexDirection:"column",overflow:"overlay",height:"10rem"},"& .table-item":{flex:"0 0 25%",display:"flex",color:"secondary.main",fontSize:"1rem",bgcolor:"background.light",cursor:"pointer",userSelect:"none"},"& .table-item:nth-of-type(2n + 1)":{bgcolor:"#ebebeb"},"& .table-item.active":{bgcolor:"active.main"},"& .sec-item":{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",padding:"0.25em",borderRight:"1px solid #eeeeee",minWidth:0},"& .checkbox-sec":{flex:"0 0 6%"},"& .serial-sec":{flex:"0 0 7%"},"& .name-sec":{flex:"1 0 20%",wordBreak:"break-all"},"& .price-sec":{flex:"0 0 12.5%"},"& .quantity-sec":{flex:"0 0 10%"},"& .discount-sec":{flex:"0 0 10%"},"& .total-sec":{flex:"0 0 12.5%"},"& .checkbox-color":{color:function(e){return e.palette.primary.main},padding:"0.25em"}},Ot={pb:"0.5rem",minWidth:0,display:"flex",flexGrow:1,alignItems:"center",position:"relative","& label":{pr:"1rem"},"& input":{padding:"0 0.25em",flexGrow:1,"&:disabled":{color:"#000000",bgcolor:"#fbfbfb"}},"& button":{padding:"0 7px",minWidth:"41px",marginLeft:"0.25rem",marginTop:"0.125rem",marginBottom:"0.125rem",color:"background.paper",bgcolor:function(e){return e.palette.primary.main},"&:hover":{bgcolor:"primary.light"}}},gt=function(e){var t,a,r=e.sales,s=e.fetchSales,l=e.currentOrderId,o=e.setCurrentOrderId,m=e.currentPaidOrder,b=e.searchParams,u=e.handleItemClick,p=Object(c.useState)({}),j=Object(n.a)(p,2),f=j[0],x=j[1],h=Object(c.useState)(!1),O=Object(n.a)(h,2),g=O[0],v=O[1],y=Object(c.useState)(!1),C=Object(n.a)(y,2),k=C[0],N=C[1],S=function(e){x(Object(ee.a)(Object(ee.a)({},f),{},Object(te.a)({},e.target.name,e.target.value)))},I=function(e){var t=e.currentTarget.dataset.changeType,a=f.startDate,n=f.endDate;if(a||n){var c=Object(ee.a)(Object(ee.a)(Object(ee.a)({},f),a&&{startDate:Object(be.a)(a,t)}),n&&{endDate:Object(be.a)(n,t)});x(c)}},P=function(e){var t=new Date(e),a=t.getFullYear().toString(),n=t.getMonth()+1,c=n>9?n.toString():"0"+n.toString(),r=t.getDate(),i=r>9?r.toString():"0"+r.toString(),s=pt[t.getDay()],l=t.toLocaleTimeString().replace("\u5348","\u5348 0").slice(0,-3);return a+"/"+c+"/"+i+" ("+s+") "+(l.length>8?l.replace(" 01"," 1"):l)};return Object(d.jsxs)(c.Fragment,{children:[Object(d.jsxs)(i.a,{display:"flex",sx:{pb:"1.25rem"},children:[Object(d.jsxs)(Ye.a,{container:!0,className:"search-field-container",sx:{flexGrow:1,alignItems:"center",justifyContent:"space-between",fontWeight:"bold","& label":{flexShrink:0,fontSize:"1rem"},"& input":{border:"1px solid #c4c4c4",borderRadius:"0.25em",display:"inline-block",minWidth:0},"& select":{lineHeight:1.75,border:"1px solid #c4c4c4",borderRadius:"0.25em",display:"inline-block",minWidth:0},"& input.error::placeholder":{color:"#cb5c5c"}},children:[Object(d.jsx)(i.a,{sx:jt,children:Object(d.jsxs)(i.a,{sx:Ot,children:[Object(d.jsx)("label",{children:"\u6703\u54e1 :"}),Object(d.jsx)("input",{type:"text",value:f.memberName||"",readOnly:!0}),Object(d.jsx)(_.a,{disableElevation:!0,variant:"contained",onClick:function(){return v(!0)},children:"\u67e5\u8a62"}),Object(d.jsx)(_.a,{variant:"contained",disableElevation:!0,onClick:function(){x((function(e){return Object(Ue.a)(e,["memberId","memberName"])}))},children:"\u6e05\u9664"}),Object(d.jsx)(w.a,{open:g,onSelectClick:function(e){x((function(t){return Object(ee.a)(Object(ee.a)({},t),{},{memberId:e.id,memberName:e.memberName})})),v(!1)},handleClose:function(){return v(!1)}})]})}),Object(d.jsx)(i.a,{sx:jt,children:Object(d.jsxs)(i.a,{sx:Ot,children:[Object(d.jsx)("label",{children:"\u9580\u5e02 :"}),Object(d.jsx)("input",{type:"text",value:f.salePointNames||"",readOnly:!0}),Object(d.jsx)(_.a,{disableElevation:!0,variant:"contained",onClick:function(){return N(!0)},children:"\u67e5\u8a62"}),Object(d.jsx)(_.a,{variant:"contained",disableElevation:!0,onClick:function(){x((function(e){return Object(Ue.a)(e,["salePointIds","salePointNames"])}))},children:"\u6e05\u9664"}),Object(d.jsx)(ut.a,{open:k,onSalePointSelectClick:function(e){var t=e.map((function(e){return e.id})).join(","),a=e.map((function(e){return e.salePointName})).join(",");x((function(e){return Object(ee.a)(Object(ee.a)({},e),{},{salePointIds:t,salePointNames:a})})),N(!1)},handleClose:function(){return N(!1)}})]})}),Object(d.jsx)(i.a,{sx:{flexGrow:1,maxWidth:"100%",display:"flex",justifyContent:"space-between"},children:Object(d.jsxs)(i.a,{sx:{display:"flex",alignItems:"center",position:"relative",flexGrow:1,"& .date-input-wrapper":{pl:"1rem",display:"flex",flexGrow:1,minWidth:0,"& input":{width:"100%"}},"& .date-control":{flex:"0 0 auto",color:"#767676",cursor:"pointer"}},children:[Object(d.jsx)("label",{className:"label",children:"\u92b7\u552e\u65e5\u671f :"}),Object(d.jsx)("div",{className:"date-input-wrapper",children:Object(d.jsx)("input",{type:"date",name:"startDate",className:"date-input",onChange:S,max:f.endDate,value:f.startDate||""})}),Object(d.jsx)("div",{className:"date-input-wrapper",children:Object(d.jsx)("input",{type:"date",name:"endDate",className:"date-input",onChange:S,min:f.startDate,value:f.endDate||""})}),Object(d.jsxs)("div",{className:"date-control",children:[Object(d.jsx)(dt.a,{viewBox:"1 2.5 20 20","data-change-type":"previous",onClick:I}),Object(d.jsx)(bt.a,{viewBox:"4 2.5 20 20","data-change-type":"next",onClick:I})]})]})})]}),Object(d.jsx)(i.a,{sx:{pl:"1rem",display:"flex"},children:Object(d.jsx)(_.a,{onClick:function(){s(Object(ee.a)(Object(ee.a)({isReturn:0},b),Object(Ue.a)(f,["memberName","salePointNames"])))},sx:{color:"background.paper",fontSize:"0.875rem",bgcolor:function(e){return e.palette.primary.main},"&:hover":{bgcolor:"primary.light"}},children:"\u641c\u5c0b"})})]}),Object(d.jsxs)("div",{className:"search-result",children:[Object(d.jsxs)("div",{children:[Object(d.jsxs)(i.a,{sx:ft,children:[Object(d.jsx)("div",{className:"serial-sec",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"time-sec",children:"\u4ea4\u6613\u6642\u9593"}),Object(d.jsx)("div",{className:"total-sec",children:"\u7e3d\u548c"}),Object(d.jsx)("div",{className:"actual-total-sec",children:"\u7e3d\u91d1\u984d"}),Object(d.jsx)("div",{className:"member-name-sec",children:"\u6703\u54e1\u59d3\u540d"}),Object(d.jsx)("div",{className:"member-phone-sec",children:"\u6703\u54e1\u96fb\u8a71"})]}),Object(d.jsx)(i.a,{sx:xt,children:(a=r,a.list&&a.list.map((function(e,t){var a=l===e.id?" active":"";return Object(d.jsxs)("div",{className:"order-item ".concat(a),onClick:function(){return t=e.id,u&&u(),void o(t);var t},children:[Object(d.jsx)("div",{className:"serial-sec",children:t+1}),Object(d.jsx)("div",{className:"time-sec",children:P(e.date)}),Object(d.jsx)("div",{className:"total-sec",children:e.total}),Object(d.jsx)("div",{className:"actual-total-sec",children:e.actualTotal}),Object(d.jsx)("div",{className:"member-name-sec",children:e.memberInfo?e.memberInfo.memberName:""}),Object(d.jsx)("div",{className:"member-phone-sec",children:e.memberInfo?e.memberInfo.phone:""})]},e.id)})))})]}),Object(d.jsx)(lt.a,{sx:{mt:"1.5rem",mb:"0.75rem"}}),Object(d.jsx)(R.a,{variant:"h6",sx:{color:function(e){return e.palette.primary.main},fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.05em"},children:"\u4ea4\u6613\u660e\u7d30"}),Object(d.jsxs)(i.a,{sx:ht,children:[Object(d.jsxs)("div",{className:"table-header",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:"\u9805\u6b21"}),Object(d.jsx)("div",{className:"name-sec sec-item",children:"\u5546\u54c1\u540d\u7a31"}),Object(d.jsx)("div",{className:"price-sec sec-item",children:"\u5b9a\u50f9"}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:"\u6578\u91cf"}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:"\u6298\u6578"}),Object(d.jsx)("div",{className:"total-sec sec-item",children:"\u5408\u8a08"})]}),Object(d.jsx)(i.a,{className:"table-list",children:m&&m.salesDetails?(t=m.salesDetails,t.map((function(e,t){return Object(d.jsxs)("div",{className:"table-item",children:[Object(d.jsx)("div",{className:"serial-sec sec-item",children:t+1}),Object(d.jsx)("div",{className:"name-sec sec-item",children:e.stockDescription||e.stockMaster.description}),Object(d.jsx)("div",{className:"price-sec sec-item",children:e.price}),Object(d.jsx)("div",{className:"quantity-sec sec-item",children:e.quantity}),Object(d.jsx)("div",{className:"discount-sec sec-item",children:e.price*e.quantity-e.subTotal}),Object(d.jsx)("div",{className:"total-sec sec-item",children:e.subTotal})]},e.id)}))):null})]})]})]})},vt=a(103),yt={justifyContent:"space-between",padding:"1em 1.75em",bgcolor:"background.paper","& .order-info":{flexGrow:1,display:"flex",flexWrap:"wrap"},"& .received-field":{flex:"0 0 36%",display:"flex",flexWrap:"wrap",padding:"0 0.25em","& > div":{flex:"0 0 100%"}},"& .received-title":{display:"inline-block",borderRadius:"0.25em",bgcolor:"active.main",padding:"0 0.25em"},"& .received-pool":{display:"inline-flex",flexWrap:"wrap","& > div":{flex:"1 0 50%",display:"flex",fontSize:"0.875rem"}},"& .received-method":{minWidth:0},"& .received-content":{flexGrow:1,minWidth:0},"& .other-field":{flexGrow:1,flexShrink:1,padding:"0 0.25em","& > div":{flex:"0 0 100%"}},"& .other-title":{display:"inline-block",borderRadius:"0.25em",bgcolor:"active.main",padding:"0 0.25em"},"& .other-pool":{display:"flex",flexWrap:"wrap","& > div":{flex:"0 0 50%",display:"flex",fontSize:"0.875rem"}},"& .other-content":{flexGrow:1},"& .returnBtn-wrapper":{display:"flex",alignItems:"center"}},Ct=Object(l.b)((function(e){return{auth:e.auth,sales:e.sales}}),{fetchSales:vt.c,deleteSale:vt.b,replacePosStrips:j.e,replaceCurrentMember:f.b})((function(e){var t=e.auth,a=e.open,r=e.sales,s=e.deleteSale,l=e.fetchSales,o=e.handleClose,m=Object(c.useState)(""),p=Object(n.a)(m,2),j=p[0],f=p[1],x=Object(c.useMemo)((function(){return r.list&&r.list.find((function(e){return e.id===j}))||{}}),[r,j]),h=Object(c.useMemo)((function(){var e;return(null===x||void 0===x?void 0:x.salesPayments)&&(null===(e=x.salesPayments.find((function(e){return Boolean(e.creditCard)})))||void 0===e?void 0:e.creditCard)||{}}),[x]);Object(c.useEffect)((function(){l({isReturn:0})}),[l]),Object(c.useEffect)((function(){r.list&&r.list[0]&&f(r.list[0].id)}),[r]);var v,y=function(){var e=Object(u.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.g.post("/refund/".concat(j),null,{headers:{Authorization:"Bearer "+t.authenticated}});case 3:s(j),Object(O.c)("\u9000\u8ca8\u5b8c\u6210","success"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(O.c)("\u8b66\u544a: ".concat(e.t0),"error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)(z.a,{id:"dialog-temp-order",open:a,onClose:o,"aria-labelledby":"dialog-temp-order",maxWidth:"md",fullWidth:!0,children:[Object(d.jsxs)(i.a,{sx:{flex:"0 0 auto",margin:0,padding:"0.375em 1.25em 0.25em",lineHeight:1.6,letterSpacing:"0.0075rem",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.375rem",fontWeight:"bold",letterSpacing:"0.05em"}},children:[Object(d.jsx)(R.a,{variant:"h6",children:"\u8a02\u55ae\u9000\u8ca8"}),o?Object(d.jsx)(M.a,{"aria-label":"close",onClick:o,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"#cb5c5c",padding:0},children:Object(d.jsx)(ge.a,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(d.jsx)(L.a,{sx:{padding:"1.25em 1.75em 0",bgcolor:"background.paper"},children:Object(d.jsx)(gt,{sales:r,fetchSales:l,currentOrderId:j,setCurrentOrderId:f,currentPaidOrder:x})}),Object(d.jsxs)(U,{sx:yt,children:[Object(d.jsxs)("div",{className:"order-info",children:[Object(d.jsxs)("div",{className:"received-field",children:[Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"subtitle2",className:"received-title",children:"\u7576\u7b46\u4ed8\u6b3e\u65b9\u5f0f :"})}),Object(d.jsx)("div",{className:"received-pool",children:(v=x&&x.salesPayments||[],v.map((function(e){var t=e.SalePointPayment||{};return Object(d.jsxs)("div",{children:[Object(d.jsxs)("span",{className:"received-method",children:[t.paymentName,"\uff1a"]}),Object(d.jsx)("span",{className:"received-content",children:e.value})]},e.id)})))})]}),Object(d.jsxs)("div",{className:"other-field",children:[Object(d.jsx)("div",{children:Object(d.jsx)(R.a,{variant:"subtitle2",className:"other-title",children:"\u5176\u4ed6\u8a73\u7d30\u8cc7\u8a0a"})}),Object(d.jsxs)("div",{className:"other-pool",children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"other-method",children:"\u5361\u865f\u672b\u56db\u78bc\uff1a"}),Object(d.jsx)("span",{className:"other-content",children:h.cardNo?h.cardNo.replaceAll(" ","").slice(-4):"- - - -"})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"other-method",children:"\u6388\u6b0a\u78bc\uff1a"}),Object(d.jsx)("span",{className:"other-content",children:h.approvalCode||"- - - -"})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"other-method",children:"\u8f09\u5177\u865f\u78bc\uff1a"}),Object(d.jsx)("span",{className:"other-content",children:x.phoneBarcode||"- - - -"})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("span",{className:"other-method",children:"\u7d71\u4e00\u7de8\u865f\uff1a"}),Object(d.jsx)("span",{className:"other-content",children:x.uniformNumber||"- - - -"})]})]})]})]}),Object(d.jsx)("div",{className:"returnBtn-wrapper",children:Object(d.jsx)(_.a,{startIcon:Object(d.jsx)(De.a,{sx:{"&:first-of-type":{fontSize:"1.25em"}}}),onClick:y,sx:{display:"inline-flex",justifyContent:"center",fontSize:"1.375rem",fontWeight:"bold",borderRadius:"0.5em",border:"none",color:"background.paper",bgcolor:function(e){return e.palette.primary.main},minWidth:"105px","&:hover":{bgcolor:"#fabd5e"}},children:"\u9000\u8ca8"})})]})]})})),kt=Object(l.b)((function(e){return{sales:e.sales}}),{fetchSales:vt.c,transferSaleArrear:vt.d,fetchPaymentMethods:ct.b})((function(e){var t=e.open,a=e.sales,r=e.fetchSales,s=e.transferSaleArrear,l=e.fetchPaymentMethods,o=e.handleClose,m=Object(c.useState)(0),b=Object(n.a)(m,2),u=b[0],p=b[1],j=Object(c.useState)(""),f=Object(n.a)(j,2),x=f[0],h=f[1],g=Object(c.useState)(!1),v=Object(n.a)(g,2),y=v[0],C=v[1],k=Object(c.useMemo)((function(){return a.list&&a.list.find((function(e){return e.id===x}))||{}}),[a,x]),N=Object(c.useMemo)((function(){return(null===k||void 0===k?void 0:k.salesPayments)&&k.salesPayments.find((function(e){return e.SalePointPayment&&"6"===e.SalePointPayment.salePointPaymentsTypeId}))||{}}),[k]);Object(c.useEffect)((function(){l()}),[l]),Object(c.useEffect)((function(){r({isReturn:0,isOwePayment:1})}),[r]),Object(c.useEffect)((function(){a.list&&a.list[0]&&!y&&h(a.list[0].id)}),[a,y]);var S=function(e){if(u){C(!0),p(0);var t=e.target.dataset.paymentId;console.log({saleId:x,arrearId:N.id,paymentId:t,value:u}),s({saleId:x,arrearId:N.id,paymentId:t,value:u})}else Object(O.c)("\u8b66\u544a: \u8acb\u8f38\u5165\u91d1\u984d")};return Object(d.jsxs)(z.a,{id:"dialog-repay","aria-labelledby":"dialog-repay",fullWidth:!0,maxWidth:"md",open:t,onClose:o,children:[Object(d.jsxs)(i.a,{sx:{flex:"0 0 auto",margin:0,padding:"0.375em 1.25em 0.25em",lineHeight:1.6,letterSpacing:"0.0075rem",bgcolor:"background.default","& h6":{color:"secondary.main",fontSize:"1.375rem",fontWeight:"bold",letterSpacing:"0.05em"}},children:[Object(d.jsx)(R.a,{variant:"h6",children:"\u8a02\u55ae\u9084\u6b3e"}),o?Object(d.jsx)(M.a,{"aria-label":"close",onClick:o,sx:{position:"absolute",right:"0.5em",top:"0.25em",color:"#cb5c5c",padding:0},children:Object(d.jsx)(ge.a,{sx:{width:"1.25em",height:"1.25em"}})}):null]}),Object(d.jsxs)(L.a,{sx:{padding:"0.25em 1.75em 0",backgroundColor:"#fafafa","& .search-result":{overflowY:"auto"}},children:[Object(d.jsx)(Ye.a,{container:!0,alignItems:"center",justifyContent:"center",children:Object(d.jsxs)(Ye.a,{item:!0,container:!0,alignItems:"center",justifyContent:"space-between",sx:{pt:"1.25rem",pb:"1rem",flex:"0 0 95%"},children:[Object(d.jsxs)(Ye.a,{item:!0,xs:6,display:"inline-flex",className:"received-amount-input",sx:{"& input":{flex:"0 0 80%",width:"100%",lineHeight:2,textAlign:"center",fontSize:"1.25rem",fontWeight:"bold",letterSpacing:"0.02em",border:"1px solid #aaaaaa",borderRight:"none",borderTopLeftRadius:"0.25em",borderBottomLeftRadius:"0.25em",color:function(e){return e.palette.primary.main},outlineColor:function(e){return e.palette.primary.main},backgroundColor:"background.paper","&::placeholder":{color:"#c4c4c4"}},"& button":{flex:"0 0 20%",textAlign:"center",fontSize:"1rem",fontWeight:"bold",letterSpacing:"0.025em",border:function(e){return"1px solid ".concat(e.palette.primary.main)},borderLeft:"none",borderTopLeftRadius:0,borderBottomLeftRadius:0,color:"background.default",backgroundColor:function(e){return e.palette.primary.main},"&:hover":{backgroundColor:"primary.light"},"&:disabled":{borderColor:"#aaaaaa"}}},children:[Object(d.jsx)("input",{value:u||"",onChange:function(e){Number.isNaN(Number(e.target.value))||(Number(e.target.value)>N.value?Object(O.c)("\u8b66\u544a: \u91d1\u984d\u8d85\u904e\u6b20\u6b3e"):p(Number(e.target.value)))},placeholder:"\u8f38\u5165\u9084\u6b3e\u91d1\u984d"}),Object(d.jsx)(_.a,{variant:"contained",disableElevation:!0,onClick:function(){N&&N.value>0?p(N.value):p(0)},children:"\u586b\u5165"})]}),Object(d.jsxs)(Ye.a,{item:!0,xs:6,className:"main-payment-method",display:"inline-flex",sx:{pl:"2rem","& button":{flex:"0 0 47.5%",fontSize:"1.125rem",fontWeight:"bold",color:"background.paper",backgroundColor:"secondary.matte","&:first-of-type":{mr:"5%"},"&:hover":{backgroundColor:"#606c9a"}}},children:[Object(d.jsx)(_.a,{variant:"contained","data-payment-id":"1",onClick:S,children:"\u73fe\u91d1"}),Object(d.jsx)(_.a,{variant:"contained","data-payment-id":"4",onClick:S,children:"\u532f\u6b3e"})]})]})}),function(e){var t=e.map((function(e){var t=e.SalePointPayment||{};return t&&"6"===t.salePointPaymentsTypeId?null:Object(d.jsxs)("div",{className:"payment-span",children:[Object(d.jsxs)("span",{className:"received-method",children:[t.paymentName," :\xa0"]}),Object(d.jsx)("span",{className:"received-content",children:e.value})]},e.id)}));return Object(d.jsxs)(Ye.a,{container:!0,alignItems:"center",sx:{px:"0.5rem",mb:"0.75rem",borderRadius:1,bgcolor:"background.darkPaper"},children:[Object(d.jsxs)(Ye.a,{item:!0,xs:"auto",sx:{pr:"2rem",fontSize:"1.5rem",fontWeight:"bold"},children:[Object(d.jsx)("span",{children:"\u6b20\u9918 :\xa0"}),Object(d.jsx)("span",{children:N.value||"- - -"})]}),Object(d.jsx)(Ye.a,{item:!0,xs:!0,sx:{"& > div":{pr:"0.75rem",display:"inline-block"}},children:t})]})}(k&&k.salesPayments||[]),Object(d.jsx)(lt.a,{sx:{mb:"1.25rem"}}),Object(d.jsx)(gt,{sales:a,fetchSales:r,currentOrderId:x,setCurrentOrderId:h,currentPaidOrder:k,searchParams:{isOwePayment:1},handleItemClick:function(e){p(0),C(!1)}})]})]})})),Nt=function(){return Object(d.jsx)(he.a,{children:Object(d.jsx)("path",{d:"M11.381 0C5.09391 0 0 5.41092 0 12.0893C0 18.7676 5.09391 24.1785 11.381 24.1785C17.6681 24.1785 22.762 18.7676 22.762 12.0893C22.762 5.41092 17.6681 0 11.381 0ZM16.9613 15.2627C17.177 15.4918 17.177 15.8623 16.9613 16.0914L15.144 18.0169C14.9284 18.246 14.5796 18.246 14.3639 18.0169L11.381 14.8191L8.39347 18.0169C8.17779 18.246 7.82901 18.246 7.61333 18.0169L5.80063 16.0865C5.58494 15.8574 5.58494 15.4869 5.80063 15.2578L8.81108 12.0893L5.80063 8.91583C5.58494 8.68672 5.58494 8.31624 5.80063 8.08713L7.61792 6.15675C7.8336 5.92764 8.18237 5.92764 8.39806 6.15675L11.381 9.35943L14.3685 6.16162C14.5842 5.93251 14.9329 5.93251 15.1486 6.16162L16.9659 8.09201C17.1816 8.32112 17.1816 8.6916 16.9659 8.92071L13.9509 12.0893L16.9613 15.2627Z",fill:"#FAFAFA"})})},St=function(){return Object(d.jsx)(he.a,{children:Object(d.jsx)("path",{d:"M15.4794 0H2.12221C1.15078 0 0.300781 0.929458 0.300781 1.9917V19.2531C0.300781 20.3153 1.15078 21.2448 2.12221 21.2448H15.4794C16.4508 21.2448 17.3008 20.3153 17.3008 19.2531V1.9917C17.3008 0.929458 16.4508 0 15.4794 0ZM5.15792 18.058C5.15792 18.3236 4.91507 18.5892 4.67221 18.5892H3.21507C2.97221 18.5892 2.72935 18.3236 2.72935 18.058V16.4647C2.72935 16.1991 2.97221 15.9336 3.21507 15.9336H4.67221C4.91507 15.9336 5.15792 16.1991 5.15792 16.4647V18.058ZM5.15792 12.7469C5.15792 13.0124 4.91507 13.278 4.67221 13.278H3.21507C2.97221 13.278 2.72935 13.0124 2.72935 12.7469V11.1535C2.72935 10.8879 2.97221 10.6224 3.21507 10.6224H4.67221C4.91507 10.6224 5.15792 10.8879 5.15792 11.1535V12.7469ZM10.0151 18.058C10.0151 18.3236 9.77221 18.5892 9.52935 18.5892H8.07221C7.82935 18.5892 7.5865 18.3236 7.5865 18.058V16.4647C7.5865 16.1991 7.82935 15.9336 8.07221 15.9336H9.52935C9.77221 15.9336 10.0151 16.1991 10.0151 16.4647V18.058ZM10.0151 12.7469C10.0151 13.0124 9.77221 13.278 9.52935 13.278H8.07221C7.82935 13.278 7.5865 13.0124 7.5865 12.7469V11.1535C7.5865 10.8879 7.82935 10.6224 8.07221 10.6224H9.52935C9.77221 10.6224 10.0151 10.8879 10.0151 11.1535V12.7469ZM14.8722 18.058C14.8722 18.3236 14.6294 18.5892 14.3865 18.5892H12.9294C12.6865 18.5892 12.4436 18.3236 12.4436 18.058V11.1535C12.4436 10.8879 12.6865 10.6224 12.9294 10.6224H14.3865C14.6294 10.6224 14.8722 10.8879 14.8722 11.1535V18.058ZM14.8722 7.43566C14.8722 7.70122 14.6294 7.96678 14.3865 7.96678H3.21507C2.97221 7.96678 2.72935 7.70122 2.72935 7.43566V3.18671C2.72935 2.92115 2.97221 2.65559 3.21507 2.65559H14.3865C14.6294 2.65559 14.8722 2.92115 14.8722 3.18671V7.43566Z",fill:"#FAFAFA"})})},wt=Object(l.b)((function(e){return{auth:e.auth,posStrips:e.posStrips,receivedAmounts:e.receivedAmounts}}),{addPosStrip:j.a,clearPosStrips:j.b,replaceCreditCardResponse:Fe.b})((function(e){var t=e.auth,a=e.posStrips,r=e.addPosStrip,s=e.clearPosStrips,l=e.setSelectedIds,o=e.receivedAmounts,m=e.setUniformContent,p=e.replaceCreditCardResponse,j=Object(ne.a)(),f=Object(c.useState)(!1),x=Object(n.a)(f,2),h=x[0],v=x[1],y=Object(c.useState)(!1),C=Object(n.a)(y,2),k=C[0],N=C[1],w=Object(c.useState)(!1),I=Object(n.a)(w,2),P=I[0],W=I[1],z=Object(c.useState)(!1),R=Object(n.a)(z,2),M=R[0],L=R[1],H=Ze(),E=Object(n.a)(H,2),A=E[0],D=E[1],T=Object(c.useCallback)(function(){var e=Object(u.a)(Object(b.a)().mark((function e(a){var n,c,i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.b.get("",{headers:{Authorization:"Bearer "+t.authenticated},params:{sort:"sale_start_date desc",internationalBarcode:a}});case 2:null!==(c=e.sent)&&void 0!==c&&null!==(n=c.data)&&void 0!==n&&n.list[0]&&(i=ze(c.data.list[0]),r(i));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,r]);Object(c.useEffect)((function(){A&&!k&&(console.log(A),T(A),D())}),[A,D,k,T]);var q=function(){v(!1),N(!1),p({})},B=function(){return!Boolean(Object.keys(o).length)||(O.b.fire({title:"\u8acb\u5148\u300c\u7d50\u5e33\u300d\u6216\u300c\u6e05\u9664\u4ed8\u6b3e\u300d",target:document.querySelector(".MuiDialog-root")}),!1)};return Object(d.jsxs)(i.a,{component:"section",id:"settlement-bar",sx:{flex:"0 0 9.125%",display:"flex",alignItems:"flex-start",justifyContent:"space-between","& .btn-smooth":{borderRadius:"0.5em",color:"background.paper",fontWeight:"bold",fontSize:"1.25rem"},"& .btn-clear":{backgroundColor:"#cb5c5c","&:hover":{bgcolor:Object(ce.a)("#cb5c5c",.8)}},"& .btn-return":{backgroundColor:"#52483b",marginLeft:"1em","&:hover":{bgcolor:Object(ce.a)("#52483b",.8)}},"& .btn-repay":{backgroundColor:"#2b3f5e",marginLeft:"1em","&:hover":{bgcolor:Object(ce.a)("#2b3f5e",.8)}},"& .btn-money":{backgroundColor:"secondary.main",marginLeft:"1em","&:hover":{bgcolor:function(e){return Object(ce.a)(e.palette.secondary.main,.8)}},"& svg":{color:j.palette.primary.main}},"& .btn-settlement":{backgroundColor:j.palette.primary.main,marginLeft:"1em","&:hover":{bgcolor:Object(ce.a)(j.palette.primary.main,.8)}}},children:[Object(d.jsx)("div",{children:Object(d.jsx)(_.a,{variant:"contained",className:"btn-smooth btn-clear",startIcon:Object(d.jsx)(Nt,{}),onClick:function(){s(),m(""),l([])},children:"\u6574\u7b46\u6e05\u9664"})}),Object(d.jsxs)("div",{children:[Object(d.jsx)(_.a,{onClick:function(){W(!0)},variant:"contained",className:"btn-smooth btn-return",startIcon:Object(d.jsx)(De.a,{}),children:"\u9000\u8ca8"}),Object(d.jsx)(_.a,{onClick:function(){L(!0)},variant:"contained",className:"btn-smooth btn-repay",startIcon:Object(d.jsx)(Ve.a,{}),children:"\u9084\u6b3e"}),Object(d.jsx)(S,{determineParam:M,children:Object(d.jsx)(kt,{open:M,handleClose:function(){L(!1)}})}),Object(d.jsx)(S,{determineParam:P,children:Object(d.jsx)(Ct,{open:P,handleClose:function(){W(!1)}})}),Object(d.jsx)(_.a,{variant:"contained",className:"btn-smooth btn-money",onClick:function(){window.printerBridge.openCashRegister()},startIcon:Object(d.jsx)(qe.a,{}),children:"\u9322\u6ac3"}),Object(d.jsx)(_.a,{onClick:function(){if(a.length<1)return O.b.fire({title:"\u63d0\u9192: \u672a\u6709\u80fd\u7d50\u5e33\u7684\u5546\u54c1",target:document.querySelector(".right-platform")});N(!0)},variant:"contained",className:"btn-smooth btn-settlement",startIcon:Object(d.jsx)(St,{}),children:"\u5c0f\u8a08"}),Object(d.jsx)(st,{open:k,isPartialClear:h,handleCheckoutClose:q,handleValidateAndClose:function(){B()&&q()},setIsPartialClear:v})]})]})})),It=a(95),Pt=a(56),Wt={commGrid:{flex:"0 0 90.5%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column","& .grid-container":{flex:"0 0 95%",display:"flex",justifyContent:"space-around",flexWrap:"wrap",width:"87.5%",margin:"0 auto",minHeight:0},"& .comm-grid-card":{flex:"0 0 31.33333%",display:"inline-flex",flexDirection:"column",color:"#666666",backgroundColor:"#fcfcfc",borderRadius:"0.3em",fontWeight:"bold",width:"31.33333%",margin:"1% 0",padding:"0 0.5em",cursor:"pointer",userSelect:"none"},"& .name-field":{flex:"0 0 75%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"0.875rem",overflow:"auto","& span":{display:"inline-flex",justifyContent:"center",textOverflow:"ellipsis",maxHeight:"3em",textShadow:function(e){return"0px 0px 3px ".concat(e.palette.background.paper)}},"&::-webkit-scrollbar":{width:"1px",height:"1px"},"&::-webkit-scrollbar-track":{background:"rgba(100, 100, 100, 0)"},"&::-webkit-scrollbar-thumb":{background:"rgba(100, 100, 100, 0.04)"}},"& .price-field":{flex:"0 0 25%",display:"flex",alignItems:"center",textAlign:"center",wordBreak:"break-all",letterSpacing:"0.03em",fontSize:"1rem",fontWeight:"normal",color:"#707070",padding:"0 0.5em",borderTop:"1px solid #eeeeee","& .MuiTypography-root":{minHeight:"1.5em"}}},templateTagList:{flex:"0 0 7.5%",display:"flex",backgroundColor:"#fcfcfc",overflow:"auto",minHeight:0,"& .template-tag":{flex:"0 0 20%",position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:"bold",color:"#777777",cursor:"pointer",userSelect:"none",padding:"0 0.5em","&::before":{content:'""',position:"absolute",height:"1em",width:"1px",left:0,borderLeft:"2px solid #eeeeee"},"&.active":{color:"background.default",background:function(e){return e.palette.primary.light}},"&:first-of-type::before":{content:"none"},"&.active::before":{content:"none"},"&.active + .template-tag::before":{content:"none"}}}},zt=Object(l.b)((function(e){return{priceMapping:e.priceMapping.content,posLayouts:e.posLayouts.content,posLayoutsStatus:e.posLayouts.loading}}),{addPosStrip:j.a,fetchPriceMapping:It.b,fetchPosLayouts:Pt.b})((function(e){var t=e.listRef,a=e.addPosStrip,s=e.fetchPriceMapping,l=e.fetchPosLayouts,o=e.setActiveCommId,m=e.setUniformContent,p=e.posLayouts,j=e.priceMapping,f=e.posLayoutsStatus,x=Object(c.useState)(0),h=Object(n.a)(x,2),O=h[0],g=h[1];Object(c.useEffect)((function(){l()}),[l]);var v=Object(c.useMemo)((function(){return p[O]}),[O,p]);Object(c.useEffect)((function(){"idle"===f&&s(v.stockList)}),[v,f,s]);var y,C,k=function(){var e=Object(u.a)(Object(b.a)().mark((function e(n){var c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stockName){e.next=2;break}return e.abrupt("return");case 2:return c=ze(n,j),e.next=5,a(c);case 5:m(""),o(c.id),N(t.current);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e){e.scrollTo(0,e.scrollHeight)};return Object(d.jsxs)(r.a.Fragment,{children:[Object(d.jsx)(i.a,{component:"section",id:"comm-grid",sx:Wt.commGrid,children:Object(d.jsx)("div",{className:"grid-container",children:(C=v.stockList,C.map((function(e,t){var a=j[e.stockId];return Object(d.jsxs)("div",{className:"comm-grid-card",style:{backgroundColor:e.backgroundColor},onClick:function(){return k(e)},children:[Object(d.jsx)("div",{className:"name-field",children:Object(d.jsx)("span",{children:e.stockName})}),Object(d.jsx)("div",{className:"price-field",children:Object(d.jsx)(R.a,{children:a?"$"+a:" "})})]},t)})))})}),Object(d.jsx)(i.a,{component:"section",id:"template-tag-list",sx:Wt.templateTagList,children:(y=p,y.map((function(e,t){var a=O===t?"active":"";return Object(d.jsx)("div",{className:"template-tag ".concat(a),onClick:function(){return function(e){g(e)}(t)},children:e.categoryName},e.id)})))})]})})),Rt=a(253),Mt={root:{color:"#333333",backgroundColor:"background.paper"},container:{"&.pos-platform-container":{maxWidth:1800,display:"flex",flexWrap:"wrap",minHeight:620,px:0}},leftPlatform:{height:"calc(100vh - 2.5rem)",display:"flex",flex:"0 0 100%",flexDirection:"column",backgroundColor:"background.paper",boxShadow:"inset -10px 0px 15px -10px #aaaaaa",minWidth:0,"& .left-container":{flex:"0 1 95%",display:"flex",flexDirection:"column",width:"90%",margin:"0 auto",minHeight:0,minWidth:0},"@media (min-width: 960px)":{flex:"0 0 60%"}},rightPlatform:{height:"100vh",position:"relative",display:"flex",flex:"0 0 100%",flexDirection:"column",bgcolor:"secondary.main","@media (min-width: 960px)":{flex:"0 0 40%",height:"calc(100vh - 2.5rem)"}},panelContainer:{flex:"0 1 40.875%",display:"flex",minHeight:0}};t.default=Object(Rt.a)()((function(){var e=Object(c.useState)(""),t=Object(n.a)(e,2),a=t[0],r=t[1],l=Object(c.useState)(""),o=Object(n.a)(l,2),b=o[0],u=o[1],p=Object(c.useState)([]),j=Object(n.a)(p,2),f=j[0],x=j[1],h=Object(c.useState)(ye.a),O=Object(n.a)(h,2),g=O[0],v=O[1],y=Object(c.useRef)();return Object(d.jsx)(i.a,{id:"pos-platform",sx:Mt.root,children:Object(d.jsxs)(s.a,{className:"pos-platform-container",maxWidth:!1,sx:Mt.container,children:[Object(d.jsxs)(i.a,{className:"left-platform",sx:Mt.leftPlatform,children:[Object(d.jsx)(m,{}),Object(d.jsxs)("div",{className:"left-container",children:[Object(d.jsx)(xe,{setSelectedIds:x}),Object(d.jsx)(We,{listRef:y,activeCommId:b,selectedIds:f,setUniformContent:r,setActiveCommId:u,setSelectedIds:x,setKeyboardMode:v}),Object(d.jsxs)(i.a,{className:"panel-container",sx:Mt.panelContainer,children:[Object(d.jsx)(He,{listRef:y,setActiveCommId:u,setUniformContent:r}),Object(d.jsx)(Ee,{uniformContent:a,activeCommId:b,selectedIds:f,keyboardMode:g,setKeyboardMode:v,setUniformContent:r})]}),Object(d.jsx)(wt,{setUniformContent:r,setSelectedIds:x})]})]}),Object(d.jsx)(i.a,{className:"right-platform",sx:Mt.rightPlatform,children:Object(d.jsx)(zt,{listRef:y,setActiveCommId:u,setUniformContent:r})})]})})}))}}]);
//# sourceMappingURL=7.37c34f1a.chunk.js.map