(this["webpackJsonpbonvies-pos"]=this["webpackJsonpbonvies-pos"]||[]).push([[11],{239:function(e,t,a){"use strict";var n=a(4),r=a(0),o=a(60),i=a(1),c={shop:5,company:10,enterprise:15};t.a=function(e){return function(t){return Object(o.b)((function(e){return{auth:e.auth.authenticated,level:e.auth.level}}))((function(a){var o=a.auth,s=a.level,d=a.history;return Object(r.useEffect)((function(){o?e&&(!s||c[e]>c[s])&&d.push("/"):d.push("/signin")}),[o,s,d]),Object(i.jsx)(t,Object(n.a)({},a))}))}}},259:function(e,t,a){"use strict";var n=a(16),r=a(6),o=a(0),i=(a(14),a(12)),c=a(229),s=a(224),d=a(26),l=a(29),u=a(24),p=a(199),m=a(225);function g(e){return Object(p.a)("MuiTypography",e)}Object(m.a)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var b=a(1),f=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],x=Object(d.a)("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(e,t){var a=e.ownerState;return[t.root,a.variant&&t[a.variant],"inherit"!==a.align&&t["align".concat(Object(u.a)(a.align))],a.noWrap&&t.noWrap,a.gutterBottom&&t.gutterBottom,a.paragraph&&t.paragraph]}})((function(e){var t=e.theme,a=e.ownerState;return Object(r.a)({margin:0},a.variant&&t.typography[a.variant],"inherit"!==a.align&&{textAlign:a.align},a.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},a.gutterBottom&&{marginBottom:"0.35em"},a.paragraph&&{marginBottom:16})})),h={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},j={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},v=o.forwardRef((function(e,t){var a=Object(l.a)({props:e,name:"MuiTypography"}),o=function(e){return j[e]||e}(a.color),d=Object(c.a)(Object(r.a)({},a,{color:o})),p=d.align,m=void 0===p?"inherit":p,v=d.className,O=d.component,y=d.gutterBottom,k=void 0!==y&&y,w=d.noWrap,L=void 0!==w&&w,S=d.paragraph,I=void 0!==S&&S,C=d.variant,D=void 0===C?"body1":C,N=d.variantMapping,W=void 0===N?h:N,P=Object(n.a)(d,f),T=Object(r.a)({},d,{align:m,color:o,className:v,component:O,gutterBottom:k,noWrap:L,paragraph:I,variant:D,variantMapping:W}),R=O||(I?"p":W[D]||h[D])||"span",M=function(e){var t=e.align,a=e.gutterBottom,n=e.noWrap,r=e.paragraph,o=e.variant,i=e.classes,c={root:["root",o,"inherit"!==e.align&&"align".concat(Object(u.a)(t)),a&&"gutterBottom",n&&"noWrap",r&&"paragraph"]};return Object(s.a)(c,g,i)}(T);return Object(b.jsx)(x,Object(r.a)({as:R,ref:t,ownerState:T,className:Object(i.a)(M.root,v)},P))}));t.a=v},270:function(e,t,a){"use strict";var n=a(3),r=a(16),o=a(6),i=a(0),c=(a(14),a(12)),s=a(20),d=a(229),l=a(224),u=a(26),p=a(29);var m=i.createContext(),g=a(13),b=a(199),f=a(225);function x(e){return Object(b.a)("MuiGrid",e)}var h=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],j=Object(f.a)("MuiGrid",["root","container","item","zeroMinWidth"].concat(Object(g.a)([0,1,2,3,4,5,6,7,8,9,10].map((function(e){return"spacing-xs-".concat(e)}))),Object(g.a)(["column-reverse","column","row-reverse","row"].map((function(e){return"direction-xs-".concat(e)}))),Object(g.a)(["nowrap","wrap-reverse","wrap"].map((function(e){return"wrap-xs-".concat(e)}))),Object(g.a)(h.map((function(e){return"grid-xs-".concat(e)}))),Object(g.a)(h.map((function(e){return"grid-sm-".concat(e)}))),Object(g.a)(h.map((function(e){return"grid-md-".concat(e)}))),Object(g.a)(h.map((function(e){return"grid-lg-".concat(e)}))),Object(g.a)(h.map((function(e){return"grid-xl-".concat(e)}))))),v=a(1),O=["className","columns","columnSpacing","component","container","direction","item","lg","md","rowSpacing","sm","spacing","wrap","xl","xs","zeroMinWidth"];function y(e){var t=parseFloat(e);return"".concat(t).concat(String(e).replace(String(t),"")||"px")}var k=Object(u.a)("div",{name:"MuiGrid",slot:"Root",overridesResolver:function(e,t){var a=e.ownerState,n=a.container,r=a.direction,o=a.item,i=a.lg,c=a.md,s=a.sm,d=a.spacing,l=a.wrap,u=a.xl,p=a.xs,m=a.zeroMinWidth;return[t.root,n&&t.container,o&&t.item,m&&t.zeroMinWidth,n&&0!==d&&t["spacing-xs-".concat(String(d))],"row"!==r&&t["direction-xs-".concat(String(r))],"wrap"!==l&&t["wrap-xs-".concat(String(l))],!1!==p&&t["grid-xs-".concat(String(p))],!1!==s&&t["grid-sm-".concat(String(s))],!1!==c&&t["grid-md-".concat(String(c))],!1!==i&&t["grid-lg-".concat(String(i))],!1!==u&&t["grid-xl-".concat(String(u))]]}})((function(e){var t=e.ownerState;return Object(o.a)({boxSizing:"border-box"},t.container&&{display:"flex",flexWrap:"wrap",width:"100%"},t.item&&{margin:0},t.zeroMinWidth&&{minWidth:0},"nowrap"===t.wrap&&{flexWrap:"nowrap"},"reverse"===t.wrap&&{flexWrap:"wrap-reverse"})}),(function(e){var t=e.theme,a=e.ownerState,n=Object(s.d)({values:a.direction,breakpoints:t.breakpoints.values});return Object(s.b)({theme:t},n,(function(e){var t={flexDirection:e};return 0===e.indexOf("column")&&(t["& > .".concat(j.item)]={maxWidth:"none"}),t}))}),(function(e){var t=e.theme,a=e.ownerState,r=a.container,o=a.rowSpacing,i={};if(r&&0!==o){var c=Object(s.d)({values:o,breakpoints:t.breakpoints.values});i=Object(s.b)({theme:t},c,(function(e){var a=t.spacing(e);return"0px"!==a?Object(n.a)({marginTop:"-".concat(y(a))},"& > .".concat(j.item),{paddingTop:y(a)}):{}}))}return i}),(function(e){var t=e.theme,a=e.ownerState,r=a.container,o=a.columnSpacing,i={};if(r&&0!==o){var c=Object(s.d)({values:o,breakpoints:t.breakpoints.values});i=Object(s.b)({theme:t},c,(function(e){var a=t.spacing(e);return"0px"!==a?Object(n.a)({width:"calc(100% + ".concat(y(a),")"),marginLeft:"-".concat(y(a))},"& > .".concat(j.item),{paddingLeft:y(a)}):{}}))}return i}),(function(e){var t=e.theme,a=e.ownerState;return t.breakpoints.keys.reduce((function(e,n){return function(e,t,a,n){var r=n[a];if(r){var i={};if(!0===r)i={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if("auto"===r)i={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{var c=Object(s.d)({values:n.columns,breakpoints:t.breakpoints.values}),d="object"===typeof c?c[a]:c,l="".concat(Math.round(r/d*1e8)/1e6,"%"),u={};if(n.container&&n.item&&0!==n.columnSpacing){var p=t.spacing(n.columnSpacing);if("0px"!==p){var m="calc(".concat(l," + ").concat(y(p),")");u={flexBasis:m,maxWidth:m}}}i=Object(o.a)({flexBasis:l,flexGrow:0,maxWidth:l},u)}0===t.breakpoints.values[a]?Object.assign(e,i):e[t.breakpoints.up(a)]=i}}(e,t,n,a),e}),{})})),w=i.forwardRef((function(e,t){var a,n=Object(p.a)({props:e,name:"MuiGrid"}),s=Object(d.a)(n),u=s.className,g=s.columns,b=s.columnSpacing,f=s.component,h=void 0===f?"div":f,j=s.container,y=void 0!==j&&j,w=s.direction,L=void 0===w?"row":w,S=s.item,I=void 0!==S&&S,C=s.lg,D=void 0!==C&&C,N=s.md,W=void 0!==N&&N,P=s.rowSpacing,T=s.sm,R=void 0!==T&&T,M=s.spacing,B=void 0===M?0:M,z=s.wrap,E=void 0===z?"wrap":z,A=s.xl,H=void 0!==A&&A,G=s.xs,F=void 0!==G&&G,J=s.zeroMinWidth,Y=void 0!==J&&J,q=Object(r.a)(s,O),X=P||B,K=b||B,Q=i.useContext(m),U=g||Q||12,V=Object(o.a)({},s,{columns:U,container:y,direction:L,item:I,lg:D,md:W,sm:R,rowSpacing:X,columnSpacing:K,wrap:E,xl:H,xs:F,zeroMinWidth:Y}),Z=function(e){var t=e.classes,a=e.container,n=e.direction,r=e.item,o=e.lg,i=e.md,c=e.sm,s=e.spacing,d=e.wrap,u=e.xl,p=e.xs,m={root:["root",a&&"container",r&&"item",e.zeroMinWidth&&"zeroMinWidth",a&&0!==s&&"spacing-xs-".concat(String(s)),"row"!==n&&"direction-xs-".concat(String(n)),"wrap"!==d&&"wrap-xs-".concat(String(d)),!1!==p&&"grid-xs-".concat(String(p)),!1!==c&&"grid-sm-".concat(String(c)),!1!==i&&"grid-md-".concat(String(i)),!1!==o&&"grid-lg-".concat(String(o)),!1!==u&&"grid-xl-".concat(String(u))]};return Object(l.a)(m,x,t)}(V);return a=Object(v.jsx)(k,Object(o.a)({ownerState:V,className:Object(c.a)(Z.root,u),as:h,ref:t},q)),12!==U?Object(v.jsx)(m.Provider,{value:U,children:a}):a}));t.a=w},348:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a(0),o=a(233),i=a(270),c=a(3),s=a(4),d=a(60),l=a(259),u=a(137),p=a(107),m=a(62),g=a(99),b=a(1),f=Object(d.b)((function(e){return{posLayouts:e.posLayouts.content,posLayoutsStatus:e.posLayouts.loading,posLayoutDrafts:e.posLayoutDrafts,priceMapping:e.priceMapping.content}}),{editPosLayoutDrafts:p.g,editPosLayoutDraftItem:p.f,clearPosLayoutDraftItem:p.b,editPreviousPalette:u.b,updatePriceMapping:g.c,fetchPriceMapping:g.b,fetchPosLayouts:m.b})((function(e){var t=e.isDeleting,a=e.posLayouts,n=e.posLayoutsStatus,d=e.posLayoutDrafts,u=e.priceMapping,p=e.updatePriceMapping,m=e.fetchPosLayouts,g=e.fetchPriceMapping,f=e.currentLayoutIndex,x=e.recordedLayoutIndex,h=e.currentLayoutItemIndex,j=e.setCurrentLayoutIndex,v=e.setRecordedLayoutIndex,O=e.setCurrentLayoutItemIndex,y=e.editPosLayoutDrafts,k=e.editPosLayoutDraftItem,w=e.clearPosLayoutDraftItem,L=e.editPreviousPalette;Object(r.useEffect)((function(){m()}),[m]),Object(r.useEffect)((function(){"idle"===n&&y(a)}),[y,j,a,n]);var S=Object(r.useMemo)((function(){return d[f]||{}}),[f,d]);Object(r.useEffect)((function(){t||S.stockList&&x!==f&&(g(S.stockList),v(f))}),[S,t,x,v,f,g]);var I=function(e){return e.preventDefault(),e.stopPropagation(),!1};return Object(b.jsxs)(o.a,{component:"section",id:"grid-input",sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1,backgroundColor:"#e0e0e0","& .grid-field":{backgroundColor:"#cccccc",width:"83%",height:"90%",padding:0}},children:[Object(b.jsx)("div",{className:"grid-field container-fluid",children:Object(b.jsx)(i.a,{container:!0,sx:{height:"100%",borderBottom:"1px solid #999999",borderRight:"1px solid #999999",margin:0,"& .grid-item":{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",borderTop:"1px solid #999999",borderLeft:"1px solid #999999",paddingTop:"0.5em",height:"20%","&.selected":{boxShadow:"0px 0px 6px -3px #363636",border:"1px solid #33333377",borderTopWidth:"2px",borderLeftWidth:"2px",zIndex:2},"& h4":{fontSize:"1rem",fontWeight:"bold",textAlign:"center",marginBottom:0,color:"#666666",letterSpacing:"0.025em",lineHeight:1.5,textShadow:function(e){return"0px 1px 2px ".concat(e.palette.background.paper)},overflow:"overlay"}},"& .item-clear":{color:"#d6d6d666",position:"absolute",right:"1%",top:"1%",width:"1.5em",lineHeight:"1.5em",fontSize:"0.8em",verticalAlign:"middle",textAlign:"center",cursor:"pointer","&:hover":{color:"#50505066"}},"& .item-color":{position:"absolute",paddingRight:"5%",right:0,bottom:0,fontSize:"0.9rem","& input":{border:"none",borderRadius:"0.3em",padding:0,width:"2.5em",height:"1.3em",userSelect:"all"}}},children:Object.keys(S).length>0&&S.stockList.map((function(e,t){var a=t===h?"selected":"";return Object(b.jsxs)(i.a,{item:!0,xs:4,style:{backgroundColor:e.backgroundColor},className:"grid-item ".concat(a),onDragEnter:I,onDragOver:I,onDrop:function(a){return function(e,t,a,n){I(e);var r=e.dataTransfer.getData("text/id")||n.stockId,o=e.dataTransfer.getData("text/price"),i=Number(o)||("0"===o?0:n.price),d=Object(s.a)(Object(s.a)({},n),{},{stockId:r,price:i,stockName:e.dataTransfer.getData("text/name")||n.stockName,backgroundColor:e.dataTransfer.getData("text/backgroundColor")||n.backgroundColor});r&&p(Object(c.a)({},r,i)),k({id:t,index:a,item:d})}(a,S.id,t,e)},onClick:function(){return function(e){O(e)}(t)},"data-item-index":t,children:[Object(b.jsx)("div",{"data-item-index":t,className:"item-clear",onClick:function(){return function(e,t){w({id:e,index:t})}(S.id,t)},children:"\u2715"}),Object(b.jsx)(l.a,{variant:"h4","data-item-index":t,children:e.stockName}),Object(b.jsx)(l.a,{variant:"subtitle1","data-item-index":t,children:u[e.stockId]||"-"}),Object(b.jsxs)("div",{className:"item-color","data-item-index":t,children:[Object(b.jsx)("label",{"data-item-index":t,children:"\u5e95\u8272:\xa0"}),Object(b.jsx)("input",{type:"color","data-item-index":t,value:e.backgroundColor,onChange:function(a){return function(e,t,a,n){var r=Object(s.a)(Object(s.a)({},n),{},{backgroundColor:e.target.value});k({id:t,index:a,item:r})}(a,S.id,t,e)},onBlur:function(e){return function(e){L(e.target.value)}(e)}})]})]},t)}))})}),Object(b.jsx)("div",{className:"toggle-field"})]})})),x=a(7),h=a.n(x),j=a(10),v=a(54),O=a(104),y=a(128),k=a(11),w=Object(d.b)((function(e){return{auth:e.auth,comms:e.comms,commClasses:e.commClasses,posLayouts:e.posLayouts.content,posLayoutDrafts:e.posLayoutDrafts,palette:e.palette}}),{postPosLayouts:m.c,fetchComms:O.b,fetchCommClasses:y.b,editPosLayoutDrafts:p.g,editPosLayoutDraft:p.e,editPosLayoutDraftItem:p.f,updatePriceMapping:g.c})((function(e){var t=e.auth,a=e.comms,i=e.commClasses,d=e.posLayouts,u=e.currentLayoutIndex,p=e.setCurrentLayoutIndex,m=e.currentLayoutItemIndex,g=e.posLayoutDrafts,f=e.palette,x=e.postPosLayouts,O=e.editPosLayoutDrafts,y=e.editPosLayoutDraft,w=e.editPosLayoutDraftItem,L=e.updatePriceMapping,S=e.fetchComms,I=e.fetchCommClasses,C=Object(r.useState)(""),D=Object(n.a)(C,2),N=D[0],W=D[1],P=Object(r.useState)(""),T=Object(n.a)(P,2),R=T[0],M=T[1],B=Object(r.useState)(""),z=Object(n.a)(B,2),E=z[0],A=z[1],H=Object(r.useState)(""),G=Object(n.a)(H,2),F=G[0],J=G[1],Y=Object(r.useState)([]),q=Object(n.a)(Y,2),X=q[0],K=q[1],Q=Object(r.useState)([]),U=Object(n.a)(Q,2),V=U[0],Z=U[1],$=Object(r.useState)(""),_=Object(n.a)($,2),ee=_[0],te=_[1],ae=Object(r.useState)(""),ne=Object(n.a)(ae,2),re=ne[0],oe=ne[1],ie=function(){var e=Object(j.a)(h.a.mark((function e(a){var n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.get("",{headers:{Authorization:"Bearer "+t.authenticated},params:Object(s.a)({limit:"zero",catRank:1},a)});case 3:return n=e.sent,r=n.data,e.abrupt("return",r.list);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){I({catRank:1})}),[I]),Object(r.useEffect)((function(){S({limit:15})}),[S]);var ce=Object(r.useMemo)((function(){return g[u]}),[g,u]),se=Object(r.useMemo)((function(){return g[u]?g[u].stockList[m]:{}}),[g,u,m]);Object(r.useEffect)((function(){ce&&(te(ce.categoryName),oe(se.stockName||""))}),[ce,se]);var de=function(){var e=Object(j.a)(h.a.mark((function e(t){var a,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,n=a?{categoryId:a,name:N,limit:15}:{name:N,limit:15},M(a),A(""),J(""),S(n),e.next=8,ie({catRank:2,parent:a});case 8:r=e.sent,Z([]),K(r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(j.a)(h.a.mark((function e(t){var a,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,n=a?{categoryId:a,name:N,limit:15}:{categoryId:R,name:N,limit:15},A(a),J(""),S(n),e.next=7,ie({catRank:3,parent:a});case 7:r=e.sent,Z(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(e){e.dataTransfer.setData("text/id",e.target.dataset.commId||""),e.dataTransfer.setData("text/name",e.target.dataset.commName||""),e.dataTransfer.setData("text/price",e.target.dataset.commPrice||""),e.dataTransfer.setData("text/backgroundColor",e.target.dataset.commColor||"")},pe=function(e){var t=e.currentTarget,a=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY),n=a&&a.dataset.itemIndex;if(n){var r=ce.stockList[n],o=t.dataset.commId||r.stockId,i=t.dataset.commPrice,d=Number(i)||("0"===i?0:r.price),l=Object(s.a)(Object(s.a)({},r),{},{stockId:o,price:d,stockName:t.dataset.commName||r.stockName,backgroundColor:t.dataset.commColor||r.backgroundColor});o&&L(Object(c.a)({},o,d)),w({id:ce.id,index:n,item:l})}},me=function(e){return e.map((function(e){return Object(b.jsx)("option",{value:e.categoryId,children:(t=e.categoryDescription,t.replaceAll(/[[\]]/g,""))},e.categoryId);var t}))},ge=a&&a.map((function(e){return Object(b.jsxs)("div",{title:e.description,"data-comm-id":e.stockId,"data-comm-name":e.description,"data-comm-price":e.price?e.price.price:0,draggable:"true",onDragStart:ue,onTouchEnd:pe,children:[Object(b.jsx)("div",{className:"comm-name-sec",children:Object(b.jsx)(l.a,{noWrap:!0,variant:"body1",title:e.description,children:e.description})}),Object(b.jsx)("div",{className:"comm-price-sec",children:Object(b.jsx)(l.a,{noWrap:!0,variant:"body2",title:e.price?e.price.price:0,children:e.price?e.price.price:0})})]},e.stockId)})),be=Object.keys(f).map((function(e,t){return Object(b.jsx)("span",{"data-comm-color":f[e],draggable:"true",onDragStart:ue,onTouchEnd:pe,style:{backgroundColor:f[e]}},t)})).reverse();return Object(b.jsxs)(o.a,{component:"section",id:"comm-list",sx:{position:"relative",display:"flex",flexDirection:"column",flex:"0 0 100%",paddingLeft:"1em",paddingRight:"1em",minHeight:"600px",minWidth:0,"& h5":{pt:"1.5rem",pb:"0.5rem",fontWeight:"bold"},"& .comm-classes":{paddingBottom:"0.75em"},"& .comm-classes select":{width:"100%",color:"#666666",borderColor:"#cccccc"}},children:[Object(b.jsx)(l.a,{variant:"h5",children:"\u5546\u54c1\u641c\u5c0b"}),Object(b.jsxs)(o.a,{component:"form",className:"comm-search",sx:{padding:"0 0 0.75em",'& input[type="text"]':{width:"80%",border:"1px solid #c4c4c4",borderRight:"none",lineHeight:1.75,borderTopLeftRadius:"0.3em",borderBottomLeftRadius:"0.3em"},'& input[type="submit"]':{width:"20%",lineHeight:1.75,border:"1px solid #c4c4c4",borderLeft:"none",letterSpacing:"0.2em",color:"background.default",bgcolor:"primary.light",borderTopRightRadius:"0.3em",borderBottomRightRadius:"0.3em"}},children:[Object(b.jsx)("input",{type:"text",placeholder:"\u8acb\u8f38\u5165\u5546\u54c1\u540d\u7a31",value:N,onChange:function(e){return W(e.target.value)}}),Object(b.jsx)("input",{type:"submit",value:"\u641c\u5c0b",onClick:function(e){e.preventDefault(),S(N?{name:N,categoryId:F||E||R,limit:15}:{categoryId:F||E||R,limit:15})}})]}),Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:de,children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u5927\u985e\u5225"}),me(i)]})}),X.length>0&&Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:le,children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u6b21\u985e\u5225"}),me(X)]})}),V.length>0&&Object(b.jsx)(o.a,{className:"comm-classes",children:Object(b.jsxs)("select",{onChange:function(e){var t=e.target.value,a=t?{categoryId:t,name:N,limit:15}:{categoryId:E||R,name:N,limit:15};J(t),S(a)},children:[Object(b.jsx)("option",{value:"",children:"\u5168\u90e8\u5c0f\u985e\u5225"}),me(V)]})}),Object(b.jsx)(o.a,{className:"comm-list",sx:{overflowY:"auto",maxHeight:"400px",marginBottom:"2em","& > div":{display:"flex",alignItems:"center",userSelect:"none",cursor:"grab",backgroundColor:"#ececec",borderBottom:"1px dashed #666666",padding:"0.375rem 1rem"},"& .comm-name-sec":{flex:"1 1 auto",minWidth:0,paddingRight:"1rem"},"& .comm-name-sec p":{letterSpacing:"0.03rem"},"& .comm-price-sec p":{fontWeight:"bold"}},children:ge}),Object(b.jsxs)(o.a,{className:"control-wrapper",sx:{flexGrow:1,"& .plat-name-wrapper":{userSelect:"none",paddingTop:"0.75em"},"& .plat-name":{border:"1px solid #dddddd",borderRadius:"0.2em",lineHeight:"1em",width:"7.5em"},"& .name-submit":{lineHeight:1.25,border:"1px solid #aaaaaa"}},children:[Object(b.jsxs)("div",{className:"plat-name-wrapper",children:[Object(b.jsx)("label",{children:"\u9762\u677f\u540d\u7a31:\xa0"}),Object(b.jsx)("input",{className:"plat-name",value:ee,onChange:function(e){te(e.target.value)},type:"text"}),Object(b.jsx)("input",{className:"name-submit",onClick:function(){var e=Object(s.a)(Object(s.a)({},ce),{},{categoryName:ee});y({id:ce.id,layout:e})},type:"button",value:"\u4fee\u6539"})]}),Object(b.jsxs)("div",{className:"plat-name-wrapper",children:[Object(b.jsx)("label",{children:"\u5546\u54c1\u540d\u7a31:\xa0"}),Object(b.jsx)("input",{className:"plat-name",value:re,onChange:function(e){oe(e.target.value)},type:"text"}),Object(b.jsx)("input",{className:"name-submit",onClick:function(){if(se.stockId&&re){var e=Object(s.a)(Object(s.a)({},se),{},{stockName:re});w({id:ce.id,index:m,item:e})}},type:"button",disabled:!re,value:"\u4fee\u6539"})]}),Object(b.jsx)(o.a,{className:"comm-color",sx:{textAlign:"left",userSelect:"none",paddingTop:"2em","& span":{display:"inline-block",width:"2.25em",height:"1.5em"}},children:be})]}),Object(b.jsx)(o.a,{id:"layout-save",sx:{textAlign:"center"},children:Object(b.jsxs)(o.a,{className:"btn-wrapper",sx:{padding:"1.5em 1.5em","& input":{backgroundColor:"#777777",borderRadius:"0.3em",padding:"0.125em 1.25em",color:"background.default",fontWeight:"bold",margin:"0.5em 0.25em",border:"none","&:last-child":{bgcolor:"primary.main"}}},children:[Object(b.jsx)("input",{type:"button",value:"\u5168\u90e8\u9084\u539f",onClick:function(){O(d),p(0)}}),Object(b.jsx)("input",{type:"button",value:"\u5168\u90e8\u5132\u5b58",onClick:function(){x(g,(function(){v.b.fire({icon:"success",title:"\u5132\u5b58\u4fee\u6539\u6210\u529f",target:document.querySelector(".right-col")})}),(function(e,t){v.b.fire({icon:"error",title:e||"\u767c\u751f\u932f\u8aa4...",target:document.querySelector(".right-col")})}))}})]})})]})})),L={platTagStyle:{position:"relative",backgroundColor:"#bbbbbb",display:"inline-block",userSelect:"none",cursor:"pointer",padding:"0 1em",marginRight:"0.125em",borderTopLeftRadius:"0.4em",borderTopRightRadius:"0.4em",overflow:"visible",transition:"margin 0.3s ease-out","&.dragover":{marginRight:"1.5em"},"&.dragover::after":{position:"absolute",content:'""',right:0,width:"1.6em",height:"1.5em",transform:"translate(100 %, 0)"},"&.active":{color:"#666666",backgroundColor:"background.default"},"& .new-tag-name":{maxWidth:0,padding:0,margin:0,border:"0 solid #cccccc",display:"inline-block",transition:"all 0.3s linear",lineHeight:1},"& .new-tag-submit":{maxWidth:0,padding:0,margin:0,border:"0 solid #cccccc",display:"inline-block",transition:"all 0.3s linear",lineHeight:1.25,verticalAlign:"top"},"& .add-icon":{display:"inline-block",color:"#dddddd",backgroundColor:"#9d9d9d",verticalAlign:"text-bottom",fontWeight:"bold",textAlign:"center",userSelect:"none",fontSize:"0.8rem",borderRadius:"3em",lineHeight:1.5,width:"1.5em",transform:"rotate(45deg)",transition:"all 0.2s linear"},"& .delete-icon":{display:"none"},"&.open .new-tag-name":{maxWidth:"5em",padding:"0 0.25em",backgroundColor:"#f0f0f0"},"&.open .new-tag-submit":{maxWidth:"3em",padding:"0 0.25em",marginRight:"0.3em",border:"2px solid #b3b3b3",backgroundColor:"#e2e2e2",color:"#333333"},"&.open .add-icon":{transform:"rotate(0deg)"}},deleteWrapperStyle:{display:"inline-block",width:"5em","& .plat-tag":{backgroundColor:"#cb5c5c",color:"background.darkPaper",zIndex:101}},deletingStyle:{zIndex:101,backgroundColor:"#fff1ed","& .plat-tag":{color:"#444444",backgroundColor:"#ff8e6f"},"& .plat-tag.active":{color:"background.paper",backgroundColor:"#fb6840"},"& .plat-tag .delete-icon":{display:"inline-block",color:"background.default",backgroundColor:"#fdc3a4",verticalAlign:"text-bottom",fontWeight:"bold",textAlign:"center",userSelect:"none",fontSize:"0.8rem",borderRadius:"3em",lineHeight:1.5,width:"1.5em",transition:"all 0.2s linear",marginLeft:"0.3em",transform:"rotate(0deg)"},"& .plat-tag.add-tag":{display:"none"},"& .delete-wrapper .plat-tag":{color:"background.darkPaper",backgroundColor:"#524d4d"}}},S=Object(d.b)((function(e){return{posLayoutDrafts:e.posLayoutDrafts}}),{fetchPriceMapping:g.b,editPosLayoutDrafts:p.g,addPosLayoutDraft:p.a,deletePosLayoutDraft:p.d})((function(e){var t=e.isDeleting,a=e.setIsDeleting,i=e.posLayoutDrafts,c=e.currentLayoutIndex,s=e.setCurrentLayoutIndex,d=e.setRecordedLayoutIndex,l=e.setCurrentLayoutItemIndex,u=e.fetchPriceMapping,p=e.editPosLayoutDrafts,m=e.addPosLayoutDraft,g=e.deletePosLayoutDraft,f=Object(r.useState)(!1),x=Object(n.a)(f,2),h=x[0],j=x[1],v=Object(r.useState)(""),O=Object(n.a)(v,2),y=O[0],k=O[1],w=Object(r.useRef)();Object(r.useEffect)((function(){var e=function(e){w.current&&w.current.contains(e.target)||j(!1)};return document.body.addEventListener("click",e,{capture:!0}),function(){document.body.removeEventListener("click",e,{capture:!0})}}),[]);var S=function(e){u(i[e].stockList),d(e)},I=function(e){for(var t=!0,a="",n=e.map((function(e){return e.id}));t;)a=C(),t=n.includes(a);return a},C=function(){return"layout"+"yxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},D=function(e){e.dataTransfer.setData("text/index",e.target.dataset.tagIndex||""),e.dataTransfer.setData("text/layoutID",e.target.dataset.layoutId||"")},N=function(e){e.currentTarget.classList.add("dragover"),P(e)},W=function(e){e.currentTarget.classList.remove("dragover"),P(e)},P=function(e){return e.preventDefault(),e.stopPropagation(),!1},T=function(e){var a=e.currentTarget;if(a.classList.remove("dragover"),!t&&e.dataTransfer.getData("text/index")&&a.dataset.tagIndex){var n=Number(e.dataTransfer.getData("text/index")),r=Number(a.dataset.tagIndex),o=n<=r?r:r+1,c=i.slice(n,n+1),d=i.filter((function(e,t){return t!==n}));d.splice(o,0,c[0]),p(d),s(o)}},R=function(e){var a=e.currentTarget,n=document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY);if(!t&&a.dataset.tagIndex&&n.dataset.tagIndex){var r=Number(a.dataset.tagIndex),o=Number(n.dataset.tagIndex),c=r<=o?o:o+1,d=i.slice(r,r+1),l=i.filter((function(e,t){return t!==r}));l.splice(c,0,d[0]),p(l),s(c)}},M=i.map((function(e,a){var n=a===c?"active":"";return Object(b.jsxs)("div",{draggable:!t,className:"plat-tag ".concat(n),"data-tag-index":a,"data-layout-id":e.id,onDragStart:D,onDragEnter:N,onDragOver:P,onDragLeave:W,onDrop:T,onTouchEnd:R,onClick:function(e){return function(e,a){e.target.classList.contains("delete-icon")||(s(a),t&&S(a),l(0))}(e,a)},children:[e.categoryName,Object(b.jsx)("span",{className:"delete-icon",onClick:function(){return function(e,t){if(!(i.length<=1)){var a=c>=i.length-1;(c>t||a)&&s(c-1),c===t&&(a?S(t-1):u(i[t+1].stockList)),g(e)}}(e.id,a)},children:"\u2715"})]},e.id)}));return Object(b.jsxs)(o.a,{component:"section",id:"plat-tag-list",className:"".concat(t?"deleting":""),sx:{"& .plat-tag":L.platTagStyle,"& .delete-wrapper":L.deleteWrapperStyle,"&.deleting":L.deletingStyle},children:[Object(b.jsxs)(o.a,{className:"tag-wrapper",sx:{display:"inline-block",width:"calc(100% - 5em)",paddingTop:"0.5em"},children:[M,Object(b.jsxs)("div",{className:"plat-tag add-tag ".concat(h?"open":""),ref:w,children:[Object(b.jsx)("input",{onChange:function(e){k(e.target.value)},value:y,className:"new-tag-name",placeholder:"\u7248\u9762\u540d\u7a31",type:"text"}),Object(b.jsx)("input",{onClick:function(){if(y){var e={id:I(i),categoryName:y};s(i.length),m(e),j(!1),k("")}},className:"new-tag-submit",type:"button",value:"\u65b0\u589e"}),Object(b.jsx)("span",{className:"add-icon",onClick:function(){j(!h)},children:"\u2715"})]})]}),Object(b.jsx)("div",{className:"delete-wrapper",children:Object(b.jsx)("div",{className:"plat-tag",onClick:function(){a(!t)},children:t?"\u7d50\u675f":"\u522a\u9664"})})]})})),I=a(239),C={bgcolor:"background.paper",userSelect:"none","& > .row":{px:0},"& .left-col":{position:"relative",display:"flex",height:"calc(100vh - 2.5rem)",padding:0},"& .right-col":{position:"relative",display:"flex",flexDirection:"column",height:"100vh",padding:0},"& .mask-field":{display:"none"},"& .deleting .mask-field":{position:"absolute",display:"block",top:0,left:0,width:"100%",height:"calc(100vh - 2.5rem)",zIndex:100,bgcolor:"#ffeae0a8"},"@media (min-width: 600px)":{"& .right-col":{height:"calc(100vh - 2.5rem)"}}};t.default=Object(I.a)()((function(){var e=Object(r.useState)(!1),t=Object(n.a)(e,2),a=t[0],c=t[1],s=Object(r.useState)(0),d=Object(n.a)(s,2),l=d[0],u=d[1],p=Object(r.useState)(null),m=Object(n.a)(p,2),g=m[0],x=m[1],h=Object(r.useState)(0),j=Object(n.a)(h,2),v=j[0],O=j[1];return Object(b.jsx)(o.a,{id:"touch-platform-backstage",sx:C,children:Object(b.jsxs)(i.a,{container:!0,sx:{maxWidth:1600,margin:"0 auto",boxShadow:"0px 0px 12px -6px #cccccc",bgcolor:"background.light"},children:[Object(b.jsxs)(i.a,{item:!0,xs:12,sm:3,className:"left-col ".concat(a?"deleting":""),children:[Object(b.jsx)(w,{isDeleting:a,currentLayoutIndex:l,currentLayoutItemIndex:v,setCurrentLayoutIndex:u,setCurrentLayoutItemIndex:O}),Object(b.jsx)("div",{className:"mask-field"})]}),Object(b.jsxs)(i.a,{item:!0,xs:12,sm:9,className:"right-col ".concat(a?"deleting":""),children:[Object(b.jsx)(S,{isDeleting:a,currentLayoutIndex:l,recordedLayoutIndex:g,setIsDeleting:c,setCurrentLayoutIndex:u,setRecordedLayoutIndex:x,setCurrentLayoutItemIndex:O}),Object(b.jsx)(f,{isDeleting:a,currentLayoutIndex:l,recordedLayoutIndex:g,currentLayoutItemIndex:v,setCurrentLayoutIndex:u,setRecordedLayoutIndex:x,setCurrentLayoutItemIndex:O}),Object(b.jsx)("div",{className:"mask-field"})]})]})})}))}}]);
//# sourceMappingURL=11.0272e2b6.chunk.js.map